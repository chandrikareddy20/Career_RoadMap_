import{a as tl}from"./chunk-UEQTAGMG.js";import{a as nl}from"./chunk-CGK5RUJI.js";import{a as Gu,b as $u,c as Wu,d as Ku,e as Hu,f as Qu,k as Ju,l as Yu,m as Xu,n as Zu,o as el}from"./chunk-YRCHNDR3.js";import{f as ju}from"./chunk-LO62QPBT.js";import{$a as Vs,Ca as Fu,Ga as _t,Gb as zu,I as Vu,Ma as Xn,Na as xe,Oa as z,Pa as j,Qa as Qr,Ra as Uu,S as mt,Sa as Bu,T as gt,Ta as Os,U as Mu,Ua as Zn,V as Lu,Va as sn,Za as Je,a as B,b as Te,bb as X,c as Hr,db as qu,gb as Jr,hb as Yr,ib as Xr,qa as ae,ya as Yn}from"./chunk-3A7RIER7.js";var rl=()=>{};var ol=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ip=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],l=n[t++],d=((i&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},al={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,l=a?n[i+1]:0,d=i+2<n.length,f=d?n[i+2]:0,_=o>>2,T=(o&3)<<4|l>>4,b=(l&15)<<2|f>>6,C=f&63;d||(C=64,a||(b=64)),r.push(t[_],t[T],t[b],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ol(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ip(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;let f=i<n.length?t[n.charAt(i)]:64;++i;let T=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||l==null||f==null||T==null)throw new Ls;let b=o<<2|l>>4;if(r.push(b),f!==64){let C=l<<4&240|f>>2;if(r.push(C),T!==64){let k=f<<6&192|T;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ls=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},sp=function(n){let e=ol(n);return al.encodeByteArray(e,!0)},tr=function(n){return sp(n).replace(/\./g,"")},ei=function(n){try{return al.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var op=()=>cl().__FIREBASE_DEFAULTS__,ap=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cp=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ei(n[1]);return e&&JSON.parse(e)},ti=()=>{try{return rl()||op()||ap()||cp()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Us=n=>ti()?.emulatorHosts?.[n],ul=n=>{let e=Us(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Bs=()=>ti()?.config,qs=n=>ti()?.[`_${n}`];var Zr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function yt(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ni(n){return(await fetch(n,{credentials:"include"})).ok}function ll(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=B({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[tr(JSON.stringify(t)),tr(JSON.stringify(a)),""].join(".")}var er={};function up(){let n={prod:[],emulator:[]};for(let e of Object.keys(er))er[e]?n.emulator.push(e):n.prod.push(e);return n}function lp(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var il=!1;function ri(n,e){if(typeof window>"u"||typeof document>"u"||!yt(window.location.host)||er[n]===e||er[n]||il)return;er[n]=e;function t(b){return`__firebase__banner__${b}`}let r="__firebase__banner",o=up().prod.length>0;function a(){let b=document.getElementById(r);b&&b.remove()}function l(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function d(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){let b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{il=!0,a()},b}function _(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function T(){let b=lp(r),C=t("text"),k=document.getElementById(C)||document.createElement("span"),V=t("learnmore"),x=document.getElementById(V)||document.createElement("a"),$=t("preprendIcon"),W=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){let J=b.element;l(J),_(x,V);let Se=f();d(W,$),J.append(W,k,x,Se),document.body.appendChild(J)}o?(k.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}function le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hl(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(le())}function hp(){let n=ti()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dl(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fl(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pl(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ml(){let n=le();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function gl(){return!hp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zs(){try{return typeof indexedDB=="object"}catch{return!1}}function _l(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var dp="FirebaseError",Pe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=dp,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ye.prototype.create)}},Ye=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?fp(o,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Pe(i,l,r)}};function fp(n,e){return n.replace(pp,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var pp=/\{\$([^}]+)}/g;function yl(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ze(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(sl(o)&&sl(a)){if(!ze(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function sl(n){return n!==null&&typeof n=="object"}function on(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Il(n,e){let t=new Fs(n,e);return t.subscribe.bind(t)}var Fs=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");mp(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ms),i.error===void 0&&(i.error=Ms),i.complete===void 0&&(i.complete=Ms);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function mp(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ms(){}var eI=14400*1e3;function me(n){return n&&n._delegate?n._delegate:n}var Oe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Vt="[DEFAULT]";var js=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Zr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_p(e))try{this.getOrInitializeService({instanceIdentifier:Vt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Vt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vt){return this.instances.has(e)}getOptions(e=Vt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(o);r===l&&a.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gp(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vt){return this.component?this.component.multipleInstances?e:Vt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function gp(n){return n===Vt?void 0:n}function _p(n){return n.instantiationMode==="EAGER"}var ii=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new js(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var yp=[],U=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(U||{}),Ip={debug:U.DEBUG,verbose:U.VERBOSE,info:U.INFO,warn:U.WARN,error:U.ERROR,silent:U.SILENT},wp=U.INFO,Ep={[U.DEBUG]:"log",[U.VERBOSE]:"log",[U.INFO]:"info",[U.WARN]:"warn",[U.ERROR]:"error"},Tp=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Ep[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},It=class{constructor(e){this.name=e,this._logLevel=wp,this._logHandler=Tp,this._userLogHandler=null,yp.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in U))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ip[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,U.DEBUG,...e),this._logHandler(this,U.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,U.VERBOSE,...e),this._logHandler(this,U.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,U.INFO,...e),this._logHandler(this,U.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,U.WARN,...e),this._logHandler(this,U.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,U.ERROR,...e),this._logHandler(this,U.ERROR,...e)}};var vp=(n,e)=>e.some(t=>n instanceof t),wl,El;function Ap(){return wl||(wl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bp(){return El||(El=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Tl=new WeakMap,$s=new WeakMap,vl=new WeakMap,Gs=new WeakMap,Ks=new WeakMap;function Sp(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(je(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Tl.set(t,n)}).catch(()=>{}),Ks.set(e,n),e}function Rp(n){if($s.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});$s.set(n,e)}var Ws={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $s.get(n);if(e==="objectStoreNames")return n.objectStoreNames||vl.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return je(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Al(n){Ws=n(Ws)}function Pp(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(si(this),e,...t);return vl.set(r,e.sort?e.sort():[e]),je(r)}:bp().includes(n)?function(...e){return n.apply(si(this),e),je(Tl.get(this))}:function(...e){return je(n.apply(si(this),e))}}function Cp(n){return typeof n=="function"?Pp(n):(n instanceof IDBTransaction&&Rp(n),vp(n,Ap())?new Proxy(n,Ws):n)}function je(n){if(n instanceof IDBRequest)return Sp(n);if(Gs.has(n))return Gs.get(n);let e=Cp(n);return e!==n&&(Gs.set(n,e),Ks.set(e,n)),e}var si=n=>Ks.get(n);function Sl(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),l=je(a);return r&&a.addEventListener("upgradeneeded",d=>{r(je(a.result),d.oldVersion,d.newVersion,je(a.transaction),d)}),t&&a.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}var Np=["get","getKey","getAll","getAllKeys","count"],kp=["put","add","delete","clear"],Hs=new Map;function bl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Hs.get(e))return Hs.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=kp.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Np.includes(t)))return;let o=async function(a,...l){let d=this.transaction(a,i?"readwrite":"readonly"),f=d.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&d.done]))[0]};return Hs.set(e,o),o}Al(n=>Te(B({},n),{get:(e,t,r)=>bl(e,t)||n.get(e,t,r),has:(e,t)=>!!bl(e,t)||n.has(e,t)}));var Js=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Dp(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Dp(n){return n.getComponent()?.type==="VERSION"}var Ys="@firebase/app",Rl="0.14.6";var Xe=new It("@firebase/app"),xp="@firebase/app-compat",Op="@firebase/analytics-compat",Vp="@firebase/analytics",Mp="@firebase/app-check-compat",Lp="@firebase/app-check",Fp="@firebase/auth",Up="@firebase/auth-compat",Bp="@firebase/database",qp="@firebase/data-connect",zp="@firebase/database-compat",jp="@firebase/functions",Gp="@firebase/functions-compat",$p="@firebase/installations",Wp="@firebase/installations-compat",Kp="@firebase/messaging",Hp="@firebase/messaging-compat",Qp="@firebase/performance",Jp="@firebase/performance-compat",Yp="@firebase/remote-config",Xp="@firebase/remote-config-compat",Zp="@firebase/storage",em="@firebase/storage-compat",tm="@firebase/firestore",nm="@firebase/ai",rm="@firebase/firestore-compat",im="firebase",sm="12.6.0";var Xs="[DEFAULT]",om={[Ys]:"fire-core",[xp]:"fire-core-compat",[Vp]:"fire-analytics",[Op]:"fire-analytics-compat",[Lp]:"fire-app-check",[Mp]:"fire-app-check-compat",[Fp]:"fire-auth",[Up]:"fire-auth-compat",[Bp]:"fire-rtdb",[qp]:"fire-data-connect",[zp]:"fire-rtdb-compat",[jp]:"fire-fn",[Gp]:"fire-fn-compat",[$p]:"fire-iid",[Wp]:"fire-iid-compat",[Kp]:"fire-fcm",[Hp]:"fire-fcm-compat",[Qp]:"fire-perf",[Jp]:"fire-perf-compat",[Yp]:"fire-rc",[Xp]:"fire-rc-compat",[Zp]:"fire-gcs",[em]:"fire-gcs-compat",[tm]:"fire-fst",[rm]:"fire-fst-compat",[nm]:"fire-vertex","fire-js":"fire-js",[im]:"fire-js-all"};var nr=new Map,am=new Map,Zs=new Map;function Pl(n,e){try{n.container.addComponent(e)}catch(t){Xe.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Et(n){let e=n.name;if(Zs.has(e))return Xe.debug(`There were multiple attempts to register component ${e}.`),!1;Zs.set(e,n);for(let t of nr.values())Pl(t,n);for(let t of am.values())Pl(t,n);return!0}function ir(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ce(n){return n==null?!1:n.settings!==void 0}var cm={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wt=new Ye("app","Firebase",cm);var eo=class{constructor(e,t,r){this._isDeleted=!1,this._options=B({},e),this._config=B({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Oe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wt.create("app-deleted",{appName:this._name})}};var Tt=sm;function ro(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=B({name:Xs,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw wt.create("bad-app-name",{appName:String(i)});if(t||(t=Bs()),!t)throw wt.create("no-options");let o=nr.get(i);if(o){if(ze(t,o.options)&&ze(r,o.config))return o;throw wt.create("duplicate-app",{appName:i})}let a=new ii(i);for(let d of Zs.values())a.addComponent(d);let l=new eo(t,r,a);return nr.set(i,l),l}function an(n=Xs){let e=nr.get(n);if(!e&&n===Xs&&Bs())return ro();if(!e)throw wt.create("no-app",{appName:n});return e}function Dl(){return Array.from(nr.values())}function Fe(n,e,t){let r=om[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xe.warn(a.join(" "));return}Et(new Oe(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var um="firebase-heartbeat-database",lm=1,rr="firebase-heartbeat-store",Qs=null;function xl(){return Qs||(Qs=Sl(um,lm,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(rr)}catch(t){console.warn(t)}}}}).catch(n=>{throw wt.create("idb-open",{originalErrorMessage:n.message})})),Qs}async function hm(n){try{let t=(await xl()).transaction(rr),r=await t.objectStore(rr).get(Ol(n));return await t.done,r}catch(e){if(e instanceof Pe)Xe.warn(e.message);else{let t=wt.create("idb-get",{originalErrorMessage:e?.message});Xe.warn(t.message)}}}async function Cl(n,e){try{let r=(await xl()).transaction(rr,"readwrite");await r.objectStore(rr).put(e,Ol(n)),await r.done}catch(t){if(t instanceof Pe)Xe.warn(t.message);else{let r=wt.create("idb-set",{originalErrorMessage:t?.message});Xe.warn(r.message)}}}function Ol(n){return`${n.name}!${n.options.appId}`}var dm=1024,fm=30,to=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new no(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Nl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>fm){let i=mm(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xe.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Nl(),{heartbeatsToSend:t,unsentEntries:r}=pm(this._heartbeatsCache.heartbeats),i=tr(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Xe.warn(e),""}}};function Nl(){return new Date().toISOString().substring(0,10)}function pm(n,e=dm){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),kl(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),kl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var no=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zs()?_l().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await hm(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Cl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Cl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function kl(n){return tr(JSON.stringify({version:2,heartbeats:n})).length}function mm(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function gm(n){Et(new Oe("platform-logger",e=>new Js(e),"PRIVATE")),Et(new Oe("heartbeat",e=>new to(e),"PRIVATE")),Fe(Ys,Rl,n),Fe(Ys,Rl,"esm2020"),Fe("fire-js","")}gm("");var _m="firebase",ym="12.6.0";Fe(_m,ym,"app");var Vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ml={};var oi,Ll;(function(){var n;function e(I,p){function g(){}g.prototype=p.prototype,I.F=p.prototype,I.prototype=new g,I.prototype.constructor=I,I.D=function(w,y,v){for(var m=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)m[Ae-2]=arguments[Ae];return p.prototype[y].apply(w,m)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,p,g){g||(g=0);let w=Array(16);if(typeof p=="string")for(var y=0;y<16;++y)w[y]=p.charCodeAt(g++)|p.charCodeAt(g++)<<8|p.charCodeAt(g++)<<16|p.charCodeAt(g++)<<24;else for(y=0;y<16;++y)w[y]=p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24;p=I.g[0],g=I.g[1],y=I.g[2];let v=I.g[3],m;m=p+(v^g&(y^v))+w[0]+3614090360&4294967295,p=g+(m<<7&4294967295|m>>>25),m=v+(y^p&(g^y))+w[1]+3905402710&4294967295,v=p+(m<<12&4294967295|m>>>20),m=y+(g^v&(p^g))+w[2]+606105819&4294967295,y=v+(m<<17&4294967295|m>>>15),m=g+(p^y&(v^p))+w[3]+3250441966&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(v^g&(y^v))+w[4]+4118548399&4294967295,p=g+(m<<7&4294967295|m>>>25),m=v+(y^p&(g^y))+w[5]+1200080426&4294967295,v=p+(m<<12&4294967295|m>>>20),m=y+(g^v&(p^g))+w[6]+2821735955&4294967295,y=v+(m<<17&4294967295|m>>>15),m=g+(p^y&(v^p))+w[7]+4249261313&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(v^g&(y^v))+w[8]+1770035416&4294967295,p=g+(m<<7&4294967295|m>>>25),m=v+(y^p&(g^y))+w[9]+2336552879&4294967295,v=p+(m<<12&4294967295|m>>>20),m=y+(g^v&(p^g))+w[10]+4294925233&4294967295,y=v+(m<<17&4294967295|m>>>15),m=g+(p^y&(v^p))+w[11]+2304563134&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(v^g&(y^v))+w[12]+1804603682&4294967295,p=g+(m<<7&4294967295|m>>>25),m=v+(y^p&(g^y))+w[13]+4254626195&4294967295,v=p+(m<<12&4294967295|m>>>20),m=y+(g^v&(p^g))+w[14]+2792965006&4294967295,y=v+(m<<17&4294967295|m>>>15),m=g+(p^y&(v^p))+w[15]+1236535329&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(y^v&(g^y))+w[1]+4129170786&4294967295,p=g+(m<<5&4294967295|m>>>27),m=v+(g^y&(p^g))+w[6]+3225465664&4294967295,v=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(v^p))+w[11]+643717713&4294967295,y=v+(m<<14&4294967295|m>>>18),m=g+(v^p&(y^v))+w[0]+3921069994&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^v&(g^y))+w[5]+3593408605&4294967295,p=g+(m<<5&4294967295|m>>>27),m=v+(g^y&(p^g))+w[10]+38016083&4294967295,v=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(v^p))+w[15]+3634488961&4294967295,y=v+(m<<14&4294967295|m>>>18),m=g+(v^p&(y^v))+w[4]+3889429448&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^v&(g^y))+w[9]+568446438&4294967295,p=g+(m<<5&4294967295|m>>>27),m=v+(g^y&(p^g))+w[14]+3275163606&4294967295,v=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(v^p))+w[3]+4107603335&4294967295,y=v+(m<<14&4294967295|m>>>18),m=g+(v^p&(y^v))+w[8]+1163531501&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^v&(g^y))+w[13]+2850285829&4294967295,p=g+(m<<5&4294967295|m>>>27),m=v+(g^y&(p^g))+w[2]+4243563512&4294967295,v=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(v^p))+w[7]+1735328473&4294967295,y=v+(m<<14&4294967295|m>>>18),m=g+(v^p&(y^v))+w[12]+2368359562&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(g^y^v)+w[5]+4294588738&4294967295,p=g+(m<<4&4294967295|m>>>28),m=v+(p^g^y)+w[8]+2272392833&4294967295,v=p+(m<<11&4294967295|m>>>21),m=y+(v^p^g)+w[11]+1839030562&4294967295,y=v+(m<<16&4294967295|m>>>16),m=g+(y^v^p)+w[14]+4259657740&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^v)+w[1]+2763975236&4294967295,p=g+(m<<4&4294967295|m>>>28),m=v+(p^g^y)+w[4]+1272893353&4294967295,v=p+(m<<11&4294967295|m>>>21),m=y+(v^p^g)+w[7]+4139469664&4294967295,y=v+(m<<16&4294967295|m>>>16),m=g+(y^v^p)+w[10]+3200236656&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^v)+w[13]+681279174&4294967295,p=g+(m<<4&4294967295|m>>>28),m=v+(p^g^y)+w[0]+3936430074&4294967295,v=p+(m<<11&4294967295|m>>>21),m=y+(v^p^g)+w[3]+3572445317&4294967295,y=v+(m<<16&4294967295|m>>>16),m=g+(y^v^p)+w[6]+76029189&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^v)+w[9]+3654602809&4294967295,p=g+(m<<4&4294967295|m>>>28),m=v+(p^g^y)+w[12]+3873151461&4294967295,v=p+(m<<11&4294967295|m>>>21),m=y+(v^p^g)+w[15]+530742520&4294967295,y=v+(m<<16&4294967295|m>>>16),m=g+(y^v^p)+w[2]+3299628645&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(y^(g|~v))+w[0]+4096336452&4294967295,p=g+(m<<6&4294967295|m>>>26),m=v+(g^(p|~y))+w[7]+1126891415&4294967295,v=p+(m<<10&4294967295|m>>>22),m=y+(p^(v|~g))+w[14]+2878612391&4294967295,y=v+(m<<15&4294967295|m>>>17),m=g+(v^(y|~p))+w[5]+4237533241&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~v))+w[12]+1700485571&4294967295,p=g+(m<<6&4294967295|m>>>26),m=v+(g^(p|~y))+w[3]+2399980690&4294967295,v=p+(m<<10&4294967295|m>>>22),m=y+(p^(v|~g))+w[10]+4293915773&4294967295,y=v+(m<<15&4294967295|m>>>17),m=g+(v^(y|~p))+w[1]+2240044497&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~v))+w[8]+1873313359&4294967295,p=g+(m<<6&4294967295|m>>>26),m=v+(g^(p|~y))+w[15]+4264355552&4294967295,v=p+(m<<10&4294967295|m>>>22),m=y+(p^(v|~g))+w[6]+2734768916&4294967295,y=v+(m<<15&4294967295|m>>>17),m=g+(v^(y|~p))+w[13]+1309151649&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~v))+w[4]+4149444226&4294967295,p=g+(m<<6&4294967295|m>>>26),m=v+(g^(p|~y))+w[11]+3174756917&4294967295,v=p+(m<<10&4294967295|m>>>22),m=y+(p^(v|~g))+w[2]+718787259&4294967295,y=v+(m<<15&4294967295|m>>>17),m=g+(v^(y|~p))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+p&4294967295,I.g[1]=I.g[1]+(y+(m<<21&4294967295|m>>>11))&4294967295,I.g[2]=I.g[2]+y&4294967295,I.g[3]=I.g[3]+v&4294967295}r.prototype.v=function(I,p){p===void 0&&(p=I.length);let g=p-this.blockSize,w=this.C,y=this.h,v=0;for(;v<p;){if(y==0)for(;v<=g;)i(this,I,v),v+=this.blockSize;if(typeof I=="string"){for(;v<p;)if(w[y++]=I.charCodeAt(v++),y==this.blockSize){i(this,w),y=0;break}}else for(;v<p;)if(w[y++]=I[v++],y==this.blockSize){i(this,w),y=0;break}}this.h=y,this.o+=p},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var p=1;p<I.length-8;++p)I[p]=0;p=this.o*8;for(var g=I.length-8;g<I.length;++g)I[g]=p&255,p/=256;for(this.v(I),I=Array(16),p=0,g=0;g<4;++g)for(let w=0;w<32;w+=8)I[p++]=this.g[g]>>>w&255;return I};function o(I,p){var g=l;return Object.prototype.hasOwnProperty.call(g,I)?g[I]:g[I]=p(I)}function a(I,p){this.h=p;let g=[],w=!0;for(let y=I.length-1;y>=0;y--){let v=I[y]|0;w&&v==p||(g[y]=v,w=!1)}this.g=g}var l={};function d(I){return-128<=I&&I<128?o(I,function(p){return new a([p|0],p<0?-1:0)}):new a([I|0],I<0?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return T;if(I<0)return x(f(-I));let p=[],g=1;for(let w=0;I>=g;w++)p[w]=I/g|0,g*=4294967296;return new a(p,0)}function _(I,p){if(I.length==0)throw Error("number format error: empty string");if(p=p||10,p<2||36<p)throw Error("radix out of range: "+p);if(I.charAt(0)=="-")return x(_(I.substring(1),p));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');let g=f(Math.pow(p,8)),w=T;for(let v=0;v<I.length;v+=8){var y=Math.min(8,I.length-v);let m=parseInt(I.substring(v,v+y),p);y<8?(y=f(Math.pow(p,y)),w=w.j(y).add(f(m))):(w=w.j(g),w=w.add(f(m)))}return w}var T=d(0),b=d(1),C=d(16777216);n=a.prototype,n.m=function(){if(V(this))return-x(this).m();let I=0,p=1;for(let g=0;g<this.g.length;g++){let w=this.i(g);I+=(w>=0?w:4294967296+w)*p,p*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k(this))return"0";if(V(this))return"-"+x(this).toString(I);let p=f(Math.pow(I,6));var g=this;let w="";for(;;){let y=Se(g,p).g;g=$(g,y.j(p));let v=((g.g.length>0?g.g[0]:g.h)>>>0).toString(I);if(g=y,k(g))return v+w;for(;v.length<6;)v="0"+v;w=v+w}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function k(I){if(I.h!=0)return!1;for(let p=0;p<I.g.length;p++)if(I.g[p]!=0)return!1;return!0}function V(I){return I.h==-1}n.l=function(I){return I=$(this,I),V(I)?-1:k(I)?0:1};function x(I){let p=I.g.length,g=[];for(let w=0;w<p;w++)g[w]=~I.g[w];return new a(g,~I.h).add(b)}n.abs=function(){return V(this)?x(this):this},n.add=function(I){let p=Math.max(this.g.length,I.g.length),g=[],w=0;for(let y=0;y<=p;y++){let v=w+(this.i(y)&65535)+(I.i(y)&65535),m=(v>>>16)+(this.i(y)>>>16)+(I.i(y)>>>16);w=m>>>16,v&=65535,m&=65535,g[y]=m<<16|v}return new a(g,g[g.length-1]&-2147483648?-1:0)};function $(I,p){return I.add(x(p))}n.j=function(I){if(k(this)||k(I))return T;if(V(this))return V(I)?x(this).j(x(I)):x(x(this).j(I));if(V(I))return x(this.j(x(I)));if(this.l(C)<0&&I.l(C)<0)return f(this.m()*I.m());let p=this.g.length+I.g.length,g=[];for(var w=0;w<2*p;w++)g[w]=0;for(w=0;w<this.g.length;w++)for(let y=0;y<I.g.length;y++){let v=this.i(w)>>>16,m=this.i(w)&65535,Ae=I.i(y)>>>16,ct=I.i(y)&65535;g[2*w+2*y]+=m*ct,W(g,2*w+2*y),g[2*w+2*y+1]+=v*ct,W(g,2*w+2*y+1),g[2*w+2*y+1]+=m*Ae,W(g,2*w+2*y+1),g[2*w+2*y+2]+=v*Ae,W(g,2*w+2*y+2)}for(I=0;I<p;I++)g[I]=g[2*I+1]<<16|g[2*I];for(I=p;I<2*p;I++)g[I]=0;return new a(g,0)};function W(I,p){for(;(I[p]&65535)!=I[p];)I[p+1]+=I[p]>>>16,I[p]&=65535,p++}function J(I,p){this.g=I,this.h=p}function Se(I,p){if(k(p))throw Error("division by zero");if(k(I))return new J(T,T);if(V(I))return p=Se(x(I),p),new J(x(p.g),x(p.h));if(V(p))return p=Se(I,x(p)),new J(x(p.g),p.h);if(I.g.length>30){if(V(I)||V(p))throw Error("slowDivide_ only works with positive integers.");for(var g=b,w=p;w.l(I)<=0;)g=De(g),w=De(w);var y=Ie(g,1),v=Ie(w,1);for(w=Ie(w,2),g=Ie(g,2);!k(w);){var m=v.add(w);m.l(I)<=0&&(y=y.add(g),v=m),w=Ie(w,1),g=Ie(g,1)}return p=$(I,y.j(p)),new J(y,p)}for(y=T;I.l(p)>=0;){for(g=Math.max(1,Math.floor(I.m()/p.m())),w=Math.ceil(Math.log(g)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),v=f(g),m=v.j(p);V(m)||m.l(I)>0;)g-=w,v=f(g),m=v.j(p);k(v)&&(v=b),y=y.add(v),I=$(I,m)}return new J(y,I)}n.B=function(I){return Se(this,I).h},n.and=function(I){let p=Math.max(this.g.length,I.g.length),g=[];for(let w=0;w<p;w++)g[w]=this.i(w)&I.i(w);return new a(g,this.h&I.h)},n.or=function(I){let p=Math.max(this.g.length,I.g.length),g=[];for(let w=0;w<p;w++)g[w]=this.i(w)|I.i(w);return new a(g,this.h|I.h)},n.xor=function(I){let p=Math.max(this.g.length,I.g.length),g=[];for(let w=0;w<p;w++)g[w]=this.i(w)^I.i(w);return new a(g,this.h^I.h)};function De(I){let p=I.g.length+1,g=[];for(let w=0;w<p;w++)g[w]=I.i(w)<<1|I.i(w-1)>>>31;return new a(g,I.h)}function Ie(I,p){let g=p>>5;p%=32;let w=I.g.length-g,y=[];for(let v=0;v<w;v++)y[v]=p>0?I.i(v+g)>>>p|I.i(v+g+1)<<32-p:I.i(v+g);return new a(y,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Ll=Ml.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=_,oi=Ml.Integer=a}).apply(typeof Vl<"u"?Vl:typeof self<"u"?self:typeof window<"u"?window:{});var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ze={};var io,Im,cn,so,sr,ci,oo,ao,co;(function(){var n,e=Object.defineProperty;function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof ai=="object"&&ai];for(var c=0;c<s.length;++c){var u=s[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var u=r;s=s.split(".");for(var h=0;h<s.length-1;h++){var E=s[h];if(!(E in u))break e;u=u[E]}s=s[s.length-1],h=u[s],c=c(h),c!=h&&c!=null&&e(u,s,{configurable:!0,writable:!0,value:c})}}i("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(s){return s||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(s){return s||function(c){var u=[],h;for(h in c)Object.prototype.hasOwnProperty.call(c,h)&&u.push([h,c[h]]);return u}});var o=o||{},a=this||self;function l(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function d(s,c,u){return s.call.apply(s.bind,arguments)}function f(s,c,u){return f=d,f.apply(null,arguments)}function _(s,c){var u=Array.prototype.slice.call(arguments,1);return function(){var h=u.slice();return h.push.apply(h,arguments),s.apply(this,h)}}function T(s,c){function u(){}u.prototype=c.prototype,s.Z=c.prototype,s.prototype=new u,s.prototype.constructor=s,s.Ob=function(h,E,A){for(var P=Array(arguments.length-2),M=2;M<arguments.length;M++)P[M-2]=arguments[M];return c.prototype[E].apply(h,P)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function C(s){let c=s.length;if(c>0){let u=Array(c);for(let h=0;h<c;h++)u[h]=s[h];return u}return[]}function k(s,c){for(let h=1;h<arguments.length;h++){let E=arguments[h];var u=typeof E;if(u=u!="object"?u:E?Array.isArray(E)?"array":u:"null",u=="array"||u=="object"&&typeof E.length=="number"){u=s.length||0;let A=E.length||0;s.length=u+A;for(let P=0;P<A;P++)s[u+P]=E[P]}else s.push(E)}}class V{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function x(s){a.setTimeout(()=>{throw s},0)}function $(){var s=I;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class W{constructor(){this.h=this.g=null}add(c,u){let h=J.get();h.set(c,u),this.h?this.h.next=h:this.g=h,this.h=h}}var J=new V(()=>new Se,s=>s.reset());class Se{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let De,Ie=!1,I=new W,p=()=>{let s=Promise.resolve(void 0);De=()=>{s.then(g)}};function g(){for(var s;s=$();){try{s.h.call(s.g)}catch(u){x(u)}var c=J;c.j(s),c.h<100&&(c.h++,s.next=c.g,c.g=s)}Ie=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function y(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}y.prototype.h=function(){this.defaultPrevented=!0};var v=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let u=()=>{};a.addEventListener("test",u,c),a.removeEventListener("test",u,c)}catch{}return s})();function m(s){return/^[\s\xa0]*$/.test(s)}function Ae(s,c){y.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s&&this.init(s,c)}T(Ae,y),Ae.prototype.init=function(s,c){let u=this.type=s.type,h=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget,c||(u=="mouseover"?c=s.fromElement:u=="mouseout"&&(c=s.toElement)),this.relatedTarget=c,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=s.pointerType,this.state=s.state,this.i=s,s.defaultPrevented&&Ae.Z.h.call(this)},Ae.prototype.h=function(){Ae.Z.h.call(this);let s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var ct="closure_listenable_"+(Math.random()*1e6|0),Rf=0;function Pf(s,c,u,h,E){this.listener=s,this.proxy=null,this.src=c,this.type=u,this.capture=!!h,this.ha=E,this.key=++Rf,this.da=this.fa=!1}function Dr(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function xr(s,c,u){for(let h in s)c.call(u,s[h],h,s)}function Cf(s,c){for(let u in s)c.call(void 0,s[u],u,s)}function xc(s){let c={};for(let u in s)c[u]=s[u];return c}let Oc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Vc(s,c){let u,h;for(let E=1;E<arguments.length;E++){h=arguments[E];for(u in h)s[u]=h[u];for(let A=0;A<Oc.length;A++)u=Oc[A],Object.prototype.hasOwnProperty.call(h,u)&&(s[u]=h[u])}}function Or(s){this.src=s,this.g={},this.h=0}Or.prototype.add=function(s,c,u,h,E){let A=s.toString();s=this.g[A],s||(s=this.g[A]=[],this.h++);let P=hs(s,c,h,E);return P>-1?(c=s[P],u||(c.fa=!1)):(c=new Pf(c,this.src,A,!!h,E),c.fa=u,s.push(c)),c};function ls(s,c){let u=c.type;if(u in s.g){var h=s.g[u],E=Array.prototype.indexOf.call(h,c,void 0),A;(A=E>=0)&&Array.prototype.splice.call(h,E,1),A&&(Dr(c),s.g[u].length==0&&(delete s.g[u],s.h--))}}function hs(s,c,u,h){for(let E=0;E<s.length;++E){let A=s[E];if(!A.da&&A.listener==c&&A.capture==!!u&&A.ha==h)return E}return-1}var ds="closure_lm_"+(Math.random()*1e6|0),fs={};function Mc(s,c,u,h,E){if(h&&h.once)return Fc(s,c,u,h,E);if(Array.isArray(c)){for(let A=0;A<c.length;A++)Mc(s,c[A],u,h,E);return null}return u=_s(u),s&&s[ct]?s.J(c,u,l(h)?!!h.capture:!!h,E):Lc(s,c,u,!1,h,E)}function Lc(s,c,u,h,E,A){if(!c)throw Error("Invalid event type");let P=l(E)?!!E.capture:!!E,M=ms(s);if(M||(s[ds]=M=new Or(s)),u=M.add(c,u,h,P,A),u.proxy)return u;if(h=Nf(),u.proxy=h,h.src=s,h.listener=u,s.addEventListener)v||(E=P),E===void 0&&(E=!1),s.addEventListener(c.toString(),h,E);else if(s.attachEvent)s.attachEvent(Bc(c.toString()),h);else if(s.addListener&&s.removeListener)s.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Nf(){function s(u){return c.call(s.src,s.listener,u)}let c=kf;return s}function Fc(s,c,u,h,E){if(Array.isArray(c)){for(let A=0;A<c.length;A++)Fc(s,c[A],u,h,E);return null}return u=_s(u),s&&s[ct]?s.K(c,u,l(h)?!!h.capture:!!h,E):Lc(s,c,u,!0,h,E)}function Uc(s,c,u,h,E){if(Array.isArray(c))for(var A=0;A<c.length;A++)Uc(s,c[A],u,h,E);else h=l(h)?!!h.capture:!!h,u=_s(u),s&&s[ct]?(s=s.i,A=String(c).toString(),A in s.g&&(c=s.g[A],u=hs(c,u,h,E),u>-1&&(Dr(c[u]),Array.prototype.splice.call(c,u,1),c.length==0&&(delete s.g[A],s.h--)))):s&&(s=ms(s))&&(c=s.g[c.toString()],s=-1,c&&(s=hs(c,u,h,E)),(u=s>-1?c[s]:null)&&ps(u))}function ps(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[ct])ls(c.i,s);else{var u=s.type,h=s.proxy;c.removeEventListener?c.removeEventListener(u,h,s.capture):c.detachEvent?c.detachEvent(Bc(u),h):c.addListener&&c.removeListener&&c.removeListener(h),(u=ms(c))?(ls(u,s),u.h==0&&(u.src=null,c[ds]=null)):Dr(s)}}}function Bc(s){return s in fs?fs[s]:fs[s]="on"+s}function kf(s,c){if(s.da)s=!0;else{c=new Ae(c,this);let u=s.listener,h=s.ha||s.src;s.fa&&ps(s),s=u.call(h,c)}return s}function ms(s){return s=s[ds],s instanceof Or?s:null}var gs="__closure_events_fn_"+(Math.random()*1e9>>>0);function _s(s){return typeof s=="function"?s:(s[gs]||(s[gs]=function(c){return s.handleEvent(c)}),s[gs])}function pe(){w.call(this),this.i=new Or(this),this.M=this,this.G=null}T(pe,w),pe.prototype[ct]=!0,pe.prototype.removeEventListener=function(s,c,u,h){Uc(this,s,c,u,h)};function we(s,c){var u,h=s.G;if(h)for(u=[];h;h=h.G)u.push(h);if(s=s.M,h=c.type||c,typeof c=="string")c=new y(c,s);else if(c instanceof y)c.target=c.target||s;else{var E=c;c=new y(h,s),Vc(c,E)}E=!0;let A,P;if(u)for(P=u.length-1;P>=0;P--)A=c.g=u[P],E=Vr(A,h,!0,c)&&E;if(A=c.g=s,E=Vr(A,h,!0,c)&&E,E=Vr(A,h,!1,c)&&E,u)for(P=0;P<u.length;P++)A=c.g=u[P],E=Vr(A,h,!1,c)&&E}pe.prototype.N=function(){if(pe.Z.N.call(this),this.i){var s=this.i;for(let c in s.g){let u=s.g[c];for(let h=0;h<u.length;h++)Dr(u[h]);delete s.g[c],s.h--}}this.G=null},pe.prototype.J=function(s,c,u,h){return this.i.add(String(s),c,!1,u,h)},pe.prototype.K=function(s,c,u,h){return this.i.add(String(s),c,!0,u,h)};function Vr(s,c,u,h){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();let E=!0;for(let A=0;A<c.length;++A){let P=c[A];if(P&&!P.da&&P.capture==u){let M=P.listener,oe=P.ha||P.src;P.fa&&ls(s.i,P),E=M.call(oe,h)!==!1&&E}}return E&&!h.defaultPrevented}function Df(s,c){if(typeof s!="function")if(s&&typeof s.handleEvent=="function")s=f(s.handleEvent,s);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(s,c||0)}function qc(s){s.g=Df(()=>{s.g=null,s.i&&(s.i=!1,qc(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class xf extends w{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:qc(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vn(s){w.call(this),this.h=s,this.g={}}T(Vn,w);var zc=[];function jc(s){xr(s.g,function(c,u){this.g.hasOwnProperty(u)&&ps(c)},s),s.g={}}Vn.prototype.N=function(){Vn.Z.N.call(this),jc(this)},Vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ys=a.JSON.stringify,Of=a.JSON.parse,Vf=class{stringify(s){return a.JSON.stringify(s,void 0)}parse(s){return a.JSON.parse(s,void 0)}};function Gc(){}function $c(){}var Mn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Is(){y.call(this,"d")}T(Is,y);function ws(){y.call(this,"c")}T(ws,y);var Nt={},Wc=null;function Mr(){return Wc=Wc||new pe}Nt.Ia="serverreachability";function Kc(s){y.call(this,Nt.Ia,s)}T(Kc,y);function Ln(s){let c=Mr();we(c,new Kc(c))}Nt.STAT_EVENT="statevent";function Hc(s,c){y.call(this,Nt.STAT_EVENT,s),this.stat=c}T(Hc,y);function Ee(s){let c=Mr();we(c,new Hc(c,s))}Nt.Ja="timingevent";function Qc(s,c){y.call(this,Nt.Ja,s),this.size=c}T(Qc,y);function Fn(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){s()},c)}function Un(){this.g=!0}Un.prototype.ua=function(){this.g=!1};function Mf(s,c,u,h,E,A){s.info(function(){if(s.g)if(A){var P="",M=A.split("&");for(let K=0;K<M.length;K++){var oe=M[K].split("=");if(oe.length>1){let ue=oe[0];oe=oe[1];let qe=ue.split("_");P=qe.length>=2&&qe[1]=="type"?P+(ue+"="+oe+"&"):P+(ue+"=redacted&")}}}else P=null;else P=A;return"XMLHTTP REQ ("+h+") [attempt "+E+"]: "+c+`
`+u+`
`+P})}function Lf(s,c,u,h,E,A,P){s.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+E+"]: "+c+`
`+u+`
`+A+" "+P})}function tn(s,c,u,h){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Uf(s,u)+(h?" "+h:"")})}function Ff(s,c){s.info(function(){return"TIMEOUT: "+c})}Un.prototype.info=function(){};function Uf(s,c){if(!s.g)return c;if(!c)return null;try{let A=JSON.parse(c);if(A){for(s=0;s<A.length;s++)if(Array.isArray(A[s])){var u=A[s];if(!(u.length<2)){var h=u[1];if(Array.isArray(h)&&!(h.length<1)){var E=h[0];if(E!="noop"&&E!="stop"&&E!="close")for(let P=1;P<h.length;P++)h[P]=""}}}}return ys(A)}catch{return c}}var Lr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Jc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Yc;function Es(){}T(Es,Gc),Es.prototype.g=function(){return new XMLHttpRequest},Yc=new Es;function Bn(s){return encodeURIComponent(String(s))}function Bf(s){var c=1;s=s.split(":");let u=[];for(;c>0&&s.length;)u.push(s.shift()),c--;return s.length&&u.push(s.join(":")),u}function ut(s,c,u,h){this.j=s,this.i=c,this.l=u,this.S=h||1,this.V=new Vn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Xc}function Xc(){this.i=null,this.g="",this.h=!1}var Zc={},Ts={};function vs(s,c,u){s.M=1,s.A=Ur(Be(c)),s.u=u,s.R=!0,eu(s,null)}function eu(s,c){s.F=Date.now(),Fr(s),s.B=Be(s.A);var u=s.B,h=s.S;Array.isArray(h)||(h=[String(h)]),fu(u.i,"t",h),s.C=0,u=s.j.L,s.h=new Xc,s.g=ku(s.j,u?c:null,!s.u),s.P>0&&(s.O=new xf(f(s.Y,s,s.g),s.P)),c=s.V,u=s.g,h=s.ba;var E="readystatechange";Array.isArray(E)||(E&&(zc[0]=E.toString()),E=zc);for(let A=0;A<E.length;A++){let P=Mc(u,E[A],h||c.handleEvent,!1,c.h||c);if(!P)break;c.g[P.key]=P}c=s.J?xc(s.J):{},s.u?(s.v||(s.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.B,s.v,s.u,c)):(s.v="GET",s.g.ea(s.B,s.v,null,c)),Ln(),Mf(s.i,s.v,s.B,s.l,s.S,s.u)}ut.prototype.ba=function(s){s=s.target;let c=this.O;c&&dt(s)==3?c.j():this.Y(s)},ut.prototype.Y=function(s){try{if(s==this.g)e:{let M=dt(this.g),oe=this.g.ya(),K=this.g.ca();if(!(M<3)&&(M!=3||this.g&&(this.h.h||this.g.la()||wu(this.g)))){this.K||M!=4||oe==7||(oe==8||K<=0?Ln(3):Ln(2)),As(this);var c=this.g.ca();this.X=c;var u=qf(this);if(this.o=c==200,Lf(this.i,this.v,this.B,this.l,this.S,M,c),this.o){if(this.U&&!this.L){t:{if(this.g){var h,E=this.g;if((h=E.g?E.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(h)){var A=h;break t}}A=null}if(s=A)tn(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bs(this,s);else{this.o=!1,this.m=3,Ee(12),kt(this),qn(this);break e}}if(this.R){s=!0;let ue;for(;!this.K&&this.C<u.length;)if(ue=zf(this,u),ue==Ts){M==4&&(this.m=4,Ee(14),s=!1),tn(this.i,this.l,null,"[Incomplete Response]");break}else if(ue==Zc){this.m=4,Ee(15),tn(this.i,this.l,u,"[Invalid Chunk]"),s=!1;break}else tn(this.i,this.l,ue,null),bs(this,ue);if(tu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),M!=4||u.length!=0||this.h.h||(this.m=1,Ee(16),s=!1),this.o=this.o&&s,!s)tn(this.i,this.l,u,"[Invalid Chunked Response]"),kt(this),qn(this);else if(u.length>0&&!this.W){this.W=!0;var P=this.j;P.g==this&&P.aa&&!P.P&&(P.j.info("Great, no buffering proxy detected. Bytes received: "+u.length),Ds(P),P.P=!0,Ee(11))}}else tn(this.i,this.l,u,null),bs(this,u);M==4&&kt(this),this.o&&!this.K&&(M==4?Ru(this.j,this):(this.o=!1,Fr(this)))}else np(this.g),c==400&&u.indexOf("Unknown SID")>0?(this.m=3,Ee(12)):(this.m=0,Ee(13)),kt(this),qn(this)}}}catch{}finally{}};function qf(s){if(!tu(s))return s.g.la();let c=wu(s.g);if(c==="")return"";let u="",h=c.length,E=dt(s.g)==4;if(!s.h.i){if(typeof TextDecoder>"u")return kt(s),qn(s),"";s.h.i=new a.TextDecoder}for(let A=0;A<h;A++)s.h.h=!0,u+=s.h.i.decode(c[A],{stream:!(E&&A==h-1)});return c.length=0,s.h.g+=u,s.C=0,s.h.g}function tu(s){return s.g?s.v=="GET"&&s.M!=2&&s.j.Aa:!1}function zf(s,c){var u=s.C,h=c.indexOf(`
`,u);return h==-1?Ts:(u=Number(c.substring(u,h)),isNaN(u)?Zc:(h+=1,h+u>c.length?Ts:(c=c.slice(h,h+u),s.C=h+u,c)))}ut.prototype.cancel=function(){this.K=!0,kt(this)};function Fr(s){s.T=Date.now()+s.H,nu(s,s.H)}function nu(s,c){if(s.D!=null)throw Error("WatchDog timer not null");s.D=Fn(f(s.aa,s),c)}function As(s){s.D&&(a.clearTimeout(s.D),s.D=null)}ut.prototype.aa=function(){this.D=null;let s=Date.now();s-this.T>=0?(Ff(this.i,this.B),this.M!=2&&(Ln(),Ee(17)),kt(this),this.m=2,qn(this)):nu(this,this.T-s)};function qn(s){s.j.I==0||s.K||Ru(s.j,s)}function kt(s){As(s);var c=s.O;c&&typeof c.dispose=="function"&&c.dispose(),s.O=null,jc(s.V),s.g&&(c=s.g,s.g=null,c.abort(),c.dispose())}function bs(s,c){try{var u=s.j;if(u.I!=0&&(u.g==s||Ss(u.h,s))){if(!s.L&&Ss(u.h,s)&&u.I==3){try{var h=u.Ba.g.parse(c)}catch{h=null}if(Array.isArray(h)&&h.length==3){var E=h;if(E[0]==0){e:if(!u.v){if(u.g)if(u.g.F+3e3<s.F)$r(u),jr(u);else break e;ks(u),Ee(18)}}else u.xa=E[1],0<u.xa-u.K&&E[2]<37500&&u.F&&u.A==0&&!u.C&&(u.C=Fn(f(u.Va,u),6e3));su(u.h)<=1&&u.ta&&(u.ta=void 0)}else xt(u,11)}else if((s.L||u.g==s)&&$r(u),!m(c))for(E=u.Ba.g.parse(c),c=0;c<E.length;c++){let K=E[c],ue=K[0];if(!(ue<=u.K))if(u.K=ue,K=K[1],u.I==2)if(K[0]=="c"){u.M=K[1],u.ba=K[2];let qe=K[3];qe!=null&&(u.ka=qe,u.j.info("VER="+u.ka));let Ot=K[4];Ot!=null&&(u.za=Ot,u.j.info("SVER="+u.za));let ft=K[5];ft!=null&&typeof ft=="number"&&ft>0&&(h=1.5*ft,u.O=h,u.j.info("backChannelRequestTimeoutMs_="+h)),h=u;let pt=s.g;if(pt){let Kr=pt.g?pt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Kr){var A=h.h;A.g||Kr.indexOf("spdy")==-1&&Kr.indexOf("quic")==-1&&Kr.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(Rs(A,A.h),A.h=null))}if(h.G){let xs=pt.g?pt.g.getResponseHeader("X-HTTP-Session-Id"):null;xs&&(h.wa=xs,Q(h.J,h.G,xs))}}u.I=3,u.l&&u.l.ra(),u.aa&&(u.T=Date.now()-s.F,u.j.info("Handshake RTT: "+u.T+"ms")),h=u;var P=s;if(h.na=Nu(h,h.L?h.ba:null,h.W),P.L){ou(h.h,P);var M=P,oe=h.O;oe&&(M.H=oe),M.D&&(As(M),Fr(M)),h.g=P}else bu(h);u.i.length>0&&Gr(u)}else K[0]!="stop"&&K[0]!="close"||xt(u,7);else u.I==3&&(K[0]=="stop"||K[0]=="close"?K[0]=="stop"?xt(u,7):Ns(u):K[0]!="noop"&&u.l&&u.l.qa(K),u.A=0)}}Ln(4)}catch{}}var jf=class{constructor(s,c){this.g=s,this.map=c}};function ru(s){this.l=s||10,a.PerformanceNavigationTiming?(s=a.performance.getEntriesByType("navigation"),s=s.length>0&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function iu(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function su(s){return s.h?1:s.g?s.g.size:0}function Ss(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Rs(s,c){s.g?s.g.add(c):s.h=c}function ou(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}ru.prototype.cancel=function(){if(this.i=au(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function au(s){if(s.h!=null)return s.i.concat(s.h.G);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let u of s.g.values())c=c.concat(u.G);return c}return C(s.i)}var cu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gf(s,c){if(s){s=s.split("&");for(let u=0;u<s.length;u++){let h=s[u].indexOf("="),E,A=null;h>=0?(E=s[u].substring(0,h),A=s[u].substring(h+1)):E=s[u],c(E,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function lt(s){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;s instanceof lt?(this.l=s.l,zn(this,s.j),this.o=s.o,this.g=s.g,jn(this,s.u),this.h=s.h,Ps(this,pu(s.i)),this.m=s.m):s&&(c=String(s).match(cu))?(this.l=!1,zn(this,c[1]||"",!0),this.o=Gn(c[2]||""),this.g=Gn(c[3]||"",!0),jn(this,c[4]),this.h=Gn(c[5]||"",!0),Ps(this,c[6]||"",!0),this.m=Gn(c[7]||"")):(this.l=!1,this.i=new Wn(null,this.l))}lt.prototype.toString=function(){let s=[];var c=this.j;c&&s.push($n(c,uu,!0),":");var u=this.g;return(u||c=="file")&&(s.push("//"),(c=this.o)&&s.push($n(c,uu,!0),"@"),s.push(Bn(u).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.u,u!=null&&s.push(":",String(u))),(u=this.h)&&(this.g&&u.charAt(0)!="/"&&s.push("/"),s.push($n(u,u.charAt(0)=="/"?Kf:Wf,!0))),(u=this.i.toString())&&s.push("?",u),(u=this.m)&&s.push("#",$n(u,Qf)),s.join("")},lt.prototype.resolve=function(s){let c=Be(this),u=!!s.j;u?zn(c,s.j):u=!!s.o,u?c.o=s.o:u=!!s.g,u?c.g=s.g:u=s.u!=null;var h=s.h;if(u)jn(c,s.u);else if(u=!!s.h){if(h.charAt(0)!="/")if(this.g&&!this.h)h="/"+h;else{var E=c.h.lastIndexOf("/");E!=-1&&(h=c.h.slice(0,E+1)+h)}if(E=h,E==".."||E==".")h="";else if(E.indexOf("./")!=-1||E.indexOf("/.")!=-1){h=E.lastIndexOf("/",0)==0,E=E.split("/");let A=[];for(let P=0;P<E.length;){let M=E[P++];M=="."?h&&P==E.length&&A.push(""):M==".."?((A.length>1||A.length==1&&A[0]!="")&&A.pop(),h&&P==E.length&&A.push("")):(A.push(M),h=!0)}h=A.join("/")}else h=E}return u?c.h=h:u=s.i.toString()!=="",u?Ps(c,pu(s.i)):u=!!s.m,u&&(c.m=s.m),c};function Be(s){return new lt(s)}function zn(s,c,u){s.j=u?Gn(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function jn(s,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);s.u=c}else s.u=null}function Ps(s,c,u){c instanceof Wn?(s.i=c,Jf(s.i,s.l)):(u||(c=$n(c,Hf)),s.i=new Wn(c,s.l))}function Q(s,c,u){s.i.set(c,u)}function Ur(s){return Q(s,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),s}function Gn(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function $n(s,c,u){return typeof s=="string"?(s=encodeURI(s).replace(c,$f),u&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function $f(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var uu=/[#\/\?@]/g,Wf=/[#\?:]/g,Kf=/[#\?]/g,Hf=/[#\?@]/g,Qf=/#/g;function Wn(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Dt(s){s.g||(s.g=new Map,s.h=0,s.i&&Gf(s.i,function(c,u){s.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=Wn.prototype,n.add=function(s,c){Dt(this),this.i=null,s=nn(this,s);let u=this.g.get(s);return u||this.g.set(s,u=[]),u.push(c),this.h+=1,this};function lu(s,c){Dt(s),c=nn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function hu(s,c){return Dt(s),c=nn(s,c),s.g.has(c)}n.forEach=function(s,c){Dt(this),this.g.forEach(function(u,h){u.forEach(function(E){s.call(c,E,h,this)},this)},this)};function du(s,c){Dt(s);let u=[];if(typeof c=="string")hu(s,c)&&(u=u.concat(s.g.get(nn(s,c))));else for(s=Array.from(s.g.values()),c=0;c<s.length;c++)u=u.concat(s[c]);return u}n.set=function(s,c){return Dt(this),this.i=null,s=nn(this,s),hu(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=du(this,s),s.length>0?String(s[0]):c):c};function fu(s,c,u){lu(s,c),u.length>0&&(s.i=null,s.g.set(nn(s,c),C(u)),s.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(let h=0;h<c.length;h++){var u=c[h];let E=Bn(u);u=du(this,u);for(let A=0;A<u.length;A++){let P=E;u[A]!==""&&(P+="="+Bn(u[A])),s.push(P)}}return this.i=s.join("&")};function pu(s){let c=new Wn;return c.i=s.i,s.g&&(c.g=new Map(s.g),c.h=s.h),c}function nn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Jf(s,c){c&&!s.j&&(Dt(s),s.i=null,s.g.forEach(function(u,h){let E=h.toLowerCase();h!=E&&(lu(this,h),fu(this,E,u))},s)),s.j=c}function Yf(s,c){let u=new Un;if(a.Image){let h=new Image;h.onload=_(ht,u,"TestLoadImage: loaded",!0,c,h),h.onerror=_(ht,u,"TestLoadImage: error",!1,c,h),h.onabort=_(ht,u,"TestLoadImage: abort",!1,c,h),h.ontimeout=_(ht,u,"TestLoadImage: timeout",!1,c,h),a.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=s}else c(!1)}function Xf(s,c){let u=new Un,h=new AbortController,E=setTimeout(()=>{h.abort(),ht(u,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:h.signal}).then(A=>{clearTimeout(E),A.ok?ht(u,"TestPingServer: ok",!0,c):ht(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(E),ht(u,"TestPingServer: error",!1,c)})}function ht(s,c,u,h,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),h(u)}catch{}}function Zf(){this.g=new Vf}function Br(s){this.i=s.Sb||null,this.h=s.ab||!1}T(Br,Gc),Br.prototype.g=function(){return new qr(this.i,this.h)};function qr(s,c){pe.call(this),this.H=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}T(qr,pe),n=qr.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=s,this.D=c,this.readyState=1,Hn(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};s&&(c.body=s),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Kn(this)),this.readyState=0},n.Pa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Hn(this)),this.g&&(this.readyState=3,Hn(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;mu(this)}else s.text().then(this.Oa.bind(this),this.ga.bind(this))};function mu(s){s.j.read().then(s.Ma.bind(s)).catch(s.ga.bind(s))}n.Ma=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Kn(this):Hn(this),this.readyState==3&&mu(this)}},n.Oa=function(s){this.g&&(this.response=this.responseText=s,Kn(this))},n.Na=function(s){this.g&&(this.response=s,Kn(this))},n.ga=function(){this.g&&Kn(this)};function Kn(s){s.readyState=4,s.l=null,s.j=null,s.B=null,Hn(s)}n.setRequestHeader=function(s,c){this.A.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,s.push(u[0]+": "+u[1]),u=c.next();return s.join(`\r
`)};function Hn(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(qr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function gu(s){let c="";return xr(s,function(u,h){c+=h,c+=":",c+=u,c+=`\r
`}),c}function Cs(s,c,u){e:{for(h in u){var h=!1;break e}h=!0}h||(u=gu(u),typeof s=="string"?u!=null&&Bn(u):Q(s,c,u))}function Y(s){pe.call(this),this.headers=new Map,this.L=s||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}T(Y,pe);var ep=/^https?$/i,tp=["POST","PUT"];n=Y.prototype,n.Fa=function(s){this.H=s},n.ea=function(s,c,u,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yc.g(),this.g.onreadystatechange=b(f(this.Ca,this));try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(A){_u(this,A);return}if(s=u||"",u=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var E in h)u.set(E,h[E]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(let A of h.keys())u.set(A,h.get(A));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(u.keys()).find(A=>A.toLowerCase()=="content-type"),E=a.FormData&&s instanceof a.FormData,!(Array.prototype.indexOf.call(tp,c,void 0)>=0)||h||E||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,P]of u)this.g.setRequestHeader(A,P);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(s),this.v=!1}catch(A){_u(this,A)}};function _u(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.o=5,yu(s),zr(s)}function yu(s){s.A||(s.A=!0,we(s,"complete"),we(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=s||7,we(this,"complete"),we(this,"abort"),zr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zr(this,!0)),Y.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Iu(this):this.Xa())},n.Xa=function(){Iu(this)};function Iu(s){if(s.h&&typeof o<"u"){if(s.v&&dt(s)==4)setTimeout(s.Ca.bind(s),0);else if(we(s,"readystatechange"),dt(s)==4){s.h=!1;try{let A=s.ca();e:switch(A){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var h;if(h=A===0){let P=String(s.D).match(cu)[1]||null;!P&&a.self&&a.self.location&&(P=a.self.location.protocol.slice(0,-1)),h=!ep.test(P?P.toLowerCase():"")}u=h}if(u)we(s,"complete"),we(s,"success");else{s.o=6;try{var E=dt(s)>2?s.g.statusText:""}catch{E=""}s.l=E+" ["+s.ca()+"]",yu(s)}}finally{zr(s)}}}}function zr(s,c){if(s.g){s.m&&(clearTimeout(s.m),s.m=null);let u=s.g;s.g=null,c||we(s,"ready");try{u.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function dt(s){return s.g?s.g.readyState:0}n.ca=function(){try{return dt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Of(c)}};function wu(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.F){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function np(s){let c={};s=(s.g&&dt(s)>=2&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<s.length;h++){if(m(s[h]))continue;var u=Bf(s[h]);let E=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let A=c[E]||[];c[E]=A,A.push(u)}Cf(c,function(h){return h.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qn(s,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[s]||c}function Eu(s){this.za=0,this.i=[],this.j=new Un,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qn("failFast",!1,s),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qn("baseRetryDelayMs",5e3,s),this.Za=Qn("retryDelaySeedMs",1e4,s),this.Ta=Qn("forwardChannelMaxRetries",2,s),this.va=Qn("forwardChannelRequestTimeoutMs",2e4,s),this.ma=s&&s.xmlHttpFactory||void 0,this.Ua=s&&s.Rb||void 0,this.Aa=s&&s.useFetchStreams||!1,this.O=void 0,this.L=s&&s.supportsCrossDomainXhr||!1,this.M="",this.h=new ru(s&&s.concurrentRequestLimit),this.Ba=new Zf,this.S=s&&s.fastHandshake||!1,this.R=s&&s.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=s&&s.Pb||!1,s&&s.ua&&this.j.ua(),s&&s.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&s&&s.detectBufferingProxy||!1,this.ia=void 0,s&&s.longPollingTimeout&&s.longPollingTimeout>0&&(this.ia=s.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Eu.prototype,n.ka=8,n.I=1,n.connect=function(s,c,u,h){Ee(0),this.W=s,this.H=c||{},u&&h!==void 0&&(this.H.OSID=u,this.H.OAID=h),this.F=this.X,this.J=Nu(this,null,this.W),Gr(this)};function Ns(s){if(Tu(s),s.I==3){var c=s.V++,u=Be(s.J);if(Q(u,"SID",s.M),Q(u,"RID",c),Q(u,"TYPE","terminate"),Jn(s,u),c=new ut(s,s.j,c),c.M=2,c.A=Ur(Be(u)),u=!1,a.navigator&&a.navigator.sendBeacon)try{u=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!u&&a.Image&&(new Image().src=c.A,u=!0),u||(c.g=ku(c.j,null),c.g.ea(c.A)),c.F=Date.now(),Fr(c)}Cu(s)}function jr(s){s.g&&(Ds(s),s.g.cancel(),s.g=null)}function Tu(s){jr(s),s.v&&(a.clearTimeout(s.v),s.v=null),$r(s),s.h.cancel(),s.m&&(typeof s.m=="number"&&a.clearTimeout(s.m),s.m=null)}function Gr(s){if(!iu(s.h)&&!s.m){s.m=!0;var c=s.Ea;De||p(),Ie||(De(),Ie=!0),I.add(c,s),s.D=0}}function rp(s,c){return su(s.h)>=s.h.j-(s.m?1:0)?!1:s.m?(s.i=c.G.concat(s.i),!0):s.I==1||s.I==2||s.D>=(s.Sa?0:s.Ta)?!1:(s.m=Fn(f(s.Ea,s,c),Pu(s,s.D)),s.D++,!0)}n.Ea=function(s){if(this.m)if(this.m=null,this.I==1){if(!s){this.V=Math.floor(Math.random()*1e5),s=this.V++;let E=new ut(this,this.j,s),A=this.o;if(this.U&&(A?(A=xc(A),Vc(A,this.U)):A=this.U),this.u!==null||this.R||(E.J=A,A=null),this.S)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var h=this.i[u];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break t}h=void 0}if(h===void 0)break;if(c+=h,c>4096){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Au(this,E,c),u=Be(this.J),Q(u,"RID",s),Q(u,"CVER",22),this.G&&Q(u,"X-HTTP-Session-Id",this.G),Jn(this,u),A&&(this.R?c="headers="+Bn(gu(A))+"&"+c:this.u&&Cs(u,this.u,A)),Rs(this.h,E),this.Ra&&Q(u,"TYPE","init"),this.S?(Q(u,"$req",c),Q(u,"SID","null"),E.U=!0,vs(E,u,null)):vs(E,u,c),this.I=2}}else this.I==3&&(s?vu(this,s):this.i.length==0||iu(this.h)||vu(this))};function vu(s,c){var u;c?u=c.l:u=s.V++;let h=Be(s.J);Q(h,"SID",s.M),Q(h,"RID",u),Q(h,"AID",s.K),Jn(s,h),s.u&&s.o&&Cs(h,s.u,s.o),u=new ut(s,s.j,u,s.D+1),s.u===null&&(u.J=s.o),c&&(s.i=c.G.concat(s.i)),c=Au(s,u,1e3),u.H=Math.round(s.va*.5)+Math.round(s.va*.5*Math.random()),Rs(s.h,u),vs(u,h,c)}function Jn(s,c){s.H&&xr(s.H,function(u,h){Q(c,h,u)}),s.l&&xr({},function(u,h){Q(c,h,u)})}function Au(s,c,u){u=Math.min(s.i.length,u);let h=s.l?f(s.l.Ka,s.l,s):null;e:{var E=s.i;let M=-1;for(;;){let oe=["count="+u];M==-1?u>0?(M=E[0].g,oe.push("ofs="+M)):M=0:oe.push("ofs="+M);let K=!0;for(let ue=0;ue<u;ue++){var A=E[ue].g;let qe=E[ue].map;if(A-=M,A<0)M=Math.max(0,E[ue].g-100),K=!1;else try{A="req"+A+"_"||"";try{var P=qe instanceof Map?qe:Object.entries(qe);for(let[Ot,ft]of P){let pt=ft;l(ft)&&(pt=ys(ft)),oe.push(A+Ot+"="+encodeURIComponent(pt))}}catch(Ot){throw oe.push(A+"type="+encodeURIComponent("_badmap")),Ot}}catch{h&&h(qe)}}if(K){P=oe.join("&");break e}}P=void 0}return s=s.i.splice(0,u),c.G=s,P}function bu(s){if(!s.g&&!s.v){s.Y=1;var c=s.Da;De||p(),Ie||(De(),Ie=!0),I.add(c,s),s.A=0}}function ks(s){return s.g||s.v||s.A>=3?!1:(s.Y++,s.v=Fn(f(s.Da,s),Pu(s,s.A)),s.A++,!0)}n.Da=function(){if(this.v=null,Su(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var s=4*this.T;this.j.info("BP detection timer enabled: "+s),this.B=Fn(f(this.Wa,this),s)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ee(10),jr(this),Su(this))};function Ds(s){s.B!=null&&(a.clearTimeout(s.B),s.B=null)}function Su(s){s.g=new ut(s,s.j,"rpc",s.Y),s.u===null&&(s.g.J=s.o),s.g.P=0;var c=Be(s.na);Q(c,"RID","rpc"),Q(c,"SID",s.M),Q(c,"AID",s.K),Q(c,"CI",s.F?"0":"1"),!s.F&&s.ia&&Q(c,"TO",s.ia),Q(c,"TYPE","xmlhttp"),Jn(s,c),s.u&&s.o&&Cs(c,s.u,s.o),s.O&&(s.g.H=s.O);var u=s.g;s=s.ba,u.M=1,u.A=Ur(Be(c)),u.u=null,u.R=!0,eu(u,s)}n.Va=function(){this.C!=null&&(this.C=null,jr(this),ks(this),Ee(19))};function $r(s){s.C!=null&&(a.clearTimeout(s.C),s.C=null)}function Ru(s,c){var u=null;if(s.g==c){$r(s),Ds(s),s.g=null;var h=2}else if(Ss(s.h,c))u=c.G,ou(s.h,c),h=1;else return;if(s.I!=0){if(c.o)if(h==1){u=c.u?c.u.length:0,c=Date.now()-c.F;var E=s.D;h=Mr(),we(h,new Qc(h,u)),Gr(s)}else bu(s);else if(E=c.m,E==3||E==0&&c.X>0||!(h==1&&rp(s,c)||h==2&&ks(s)))switch(u&&u.length>0&&(c=s.h,c.i=c.i.concat(u)),E){case 1:xt(s,5);break;case 4:xt(s,10);break;case 3:xt(s,6);break;default:xt(s,2)}}}function Pu(s,c){let u=s.Qa+Math.floor(Math.random()*s.Za);return s.isActive()||(u*=2),u*c}function xt(s,c){if(s.j.info("Error code "+c),c==2){var u=f(s.bb,s),h=s.Ua;let E=!h;h=new lt(h||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zn(h,"https"),Ur(h),E?Yf(h.toString(),u):Xf(h.toString(),u)}else Ee(2);s.I=0,s.l&&s.l.pa(c),Cu(s),Tu(s)}n.bb=function(s){s?(this.j.info("Successfully pinged google.com"),Ee(2)):(this.j.info("Failed to ping google.com"),Ee(1))};function Cu(s){if(s.I=0,s.ja=[],s.l){let c=au(s.h);(c.length!=0||s.i.length!=0)&&(k(s.ja,c),k(s.ja,s.i),s.h.i.length=0,C(s.i),s.i.length=0),s.l.oa()}}function Nu(s,c,u){var h=u instanceof lt?Be(u):new lt(u);if(h.g!="")c&&(h.g=c+"."+h.g),jn(h,h.u);else{var E=a.location;h=E.protocol,c=c?c+"."+E.hostname:E.hostname,E=+E.port;let A=new lt(null);h&&zn(A,h),c&&(A.g=c),E&&jn(A,E),u&&(A.h=u),h=A}return u=s.G,c=s.wa,u&&c&&Q(h,u,c),Q(h,"VER",s.ka),Jn(s,h),h}function ku(s,c,u){if(c&&!s.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Aa&&!s.ma?new Y(new Br({ab:u})):new Y(s.ma),c.Fa(s.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Du(){}n=Du.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Wr(){}Wr.prototype.g=function(s,c){return new Re(s,c)};function Re(s,c){pe.call(this),this.g=new Eu(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(s?s["X-WebChannel-Client-Profile"]=c.sa:s={"X-WebChannel-Client-Profile":c.sa}),this.g.U=s,(s=c&&c.Qb)&&!m(s)&&(this.g.u=s),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!m(c)&&(this.g.G=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new rn(this)}T(Re,pe),Re.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Re.prototype.close=function(){Ns(this.g)},Re.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var u={};u.__data__=s,s=u}else this.v&&(u={},u.__data__=ys(s),s=u);c.i.push(new jf(c.Ya++,s)),c.I==3&&Gr(c)},Re.prototype.N=function(){this.g.l=null,delete this.j,Ns(this.g),delete this.g,Re.Z.N.call(this)};function xu(s){Is.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let u in c){s=u;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}T(xu,Is);function Ou(){ws.call(this),this.status=1}T(Ou,ws);function rn(s){this.g=s}T(rn,Du),rn.prototype.ra=function(){we(this.g,"a")},rn.prototype.qa=function(s){we(this.g,new xu(s))},rn.prototype.pa=function(s){we(this.g,new Ou)},rn.prototype.oa=function(){we(this.g,"b")},Wr.prototype.createWebChannel=Wr.prototype.g,Re.prototype.send=Re.prototype.o,Re.prototype.open=Re.prototype.m,Re.prototype.close=Re.prototype.close,co=Ze.createWebChannelTransport=function(){return new Wr},ao=Ze.getStatEventTarget=function(){return Mr()},oo=Ze.Event=Nt,ci=Ze.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Lr.NO_ERROR=0,Lr.TIMEOUT=8,Lr.HTTP_ERROR=6,sr=Ze.ErrorCode=Lr,Jc.COMPLETE="complete",so=Ze.EventType=Jc,$c.EventType=Mn,Mn.OPEN="a",Mn.CLOSE="b",Mn.ERROR="c",Mn.MESSAGE="d",pe.prototype.listen=pe.prototype.J,cn=Ze.WebChannel=$c,Im=Ze.FetchXmlHttpFactory=Br,Y.prototype.listenOnce=Y.prototype.K,Y.prototype.getLastError=Y.prototype.Ha,Y.prototype.getLastErrorCode=Y.prototype.ya,Y.prototype.getStatus=Y.prototype.ca,Y.prototype.getResponseJson=Y.prototype.La,Y.prototype.getResponseText=Y.prototype.la,Y.prototype.send=Y.prototype.ea,Y.prototype.setWithCredentials=Y.prototype.Fa,io=Ze.XhrIo=Y}).apply(typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{});var Fl="@firebase/firestore",Ul="4.9.2";var he=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};he.UNAUTHENTICATED=new he(null),he.GOOGLE_CREDENTIALS=new he("google-credentials-uid"),he.FIRST_PARTY=new he("first-party-uid"),he.MOCK_USER=new he("mock-user");var kn="12.3.0";var qt=new It("@firebase/firestore");function un(){return qt.logLevel}function N(n,...e){if(qt.logLevel<=U.DEBUG){let t=e.map(Ba);qt.debug(`Firestore (${kn}): ${n}`,...t)}}function zt(n,...e){if(qt.logLevel<=U.ERROR){let t=e.map(Ba);qt.error(`Firestore (${kn}): ${n}`,...t)}}function Mi(n,...e){if(qt.logLevel<=U.WARN){let t=e.map(Ba);qt.warn(`Firestore (${kn}): ${n}`,...t)}}function Ba(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function L(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Ih(n,r,t)}function Ih(n,e,t){let r=`FIRESTORE (${kn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw zt(r),new Error(r)}function ee(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Ih(e,i,r)}function H(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Pe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var mi=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},po=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(he.UNAUTHENTICATED))}shutdown(){}},mo=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},go=class{constructor(e){this.t=e,this.currentUser=he.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i,i=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve(),o=new et;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new et,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let d=o;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},l=d=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){let d=this.t.getImmediate({optional:!0});d?l(d):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new et)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new mi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new he(e)}},_o=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=he.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},yo=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new _o(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(he.FIRST_PARTY))}shutdown(){}invalidateToken(){}},gi=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Io=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ce(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);let r=o=>{o.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new gi(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gi(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function wm(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var dr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=wm(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function G(n,e){return n<e?-1:n>e?1:0}function wo(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),o=e.charAt(r);if(i!==o)return uo(i)===uo(o)?G(i,o):uo(i)?1:-1}return G(n.length,e.length)}var Em=55296,Tm=57343;function uo(n){let e=n.charCodeAt(0);return e>=Em&&e<=Tm}function gn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Bl="__name__",_i=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&L(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&L(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return G(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):wo(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oi.fromString(e.substring(4,e.length-2))}},te=class n extends _i{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new D(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},vm=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ne=class n extends _i{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return vm.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Bl}static keyField(){return new n([Bl])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new D(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let l=e[i];if(l==="\\"){if(i+1===e.length)throw new D(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new D(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(o(),i++)}if(o(),a)throw new D(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(te.fromString(e))}static fromName(e){return new n(te.fromString(e).popFirst(5))}static empty(){return new n(te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return te.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new te(e.slice()))}};function wh(n,e,t){if(!t)throw new D(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Am(n,e,t,r){if(e===!0&&r===!0)throw new D(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ql(n){if(!F.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function zl(n){if(F.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Eh(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function qa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L(12329,{type:typeof n})}function _n(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=qa(n);throw new D(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function se(n,e){let t={typeString:n};return e&&(t.value=e),t}function Ir(n,e){if(!Eh(n))throw new D(S.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new D(S.INVALID_ARGUMENT,t);return!0}var jl=-62135596800,Gl=1e6,ce=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Gl);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jl)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Gl}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ir(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-jl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:se("string",ce._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};var Z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ce(0,0))}static max(){return new n(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var fr=-1,Eo=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Eo.UNKNOWN_ID=-1;function bm(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Z.fromTimestamp(r===1e9?new ce(t+1,0):new ce(t,r));return new jt(i,F.empty(),e)}function Sm(n){return new jt(n.readTime,n.key,fr)}var jt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Z.min(),F.empty(),fr)}static max(){return new n(Z.max(),F.empty(),fr)}};function Rm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}var Pm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",To=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function za(n){if(n.code!==S.FAILED_PRECONDITION||n.message!==Pm)throw n;N("LocalStore","Unexpectedly lost primary lease")}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++o,a&&o===i&&t()},d=>r(d))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),l=0;for(let d=0;d<o;d++){let f=d;t(e[f]).next(_=>{a[f]=_,++l,l===o&&r(a)},_=>i(_))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Cm(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wr(n){return n.name==="IndexedDbTransactionError"}var Th=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),ja=-1;function Ga(n){return n==null}function pr(n){return n===0&&1/n==-1/0}function Nm(n){return typeof n=="number"&&Number.isInteger(n)&&!pr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var vh="";function km(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=$l(e)),e=Dm(n.get(t),e);return $l(e)}function Dm(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case vh:t+="";break;default:t+=o}}return t}function $l(n){return n+vh+""}var xm="remoteDocuments",Ah="owner";var bh="mutationQueues";var Sh="mutations";var Rh="documentMutations",Om="remoteDocumentsV14";var Ph="remoteDocumentGlobal";var Ch="targets";var Nh="targetDocuments";var kh="targetGlobal",Dh="collectionParents";var xh="clientMetadata";var Oh="bundles";var Vh="namedQueries";var Vm="indexConfiguration";var Mm="indexState";var Lm="indexEntries";var Mh="documentOverlays";var Fm="globals";var Um=[bh,Sh,Rh,xm,Ch,Ah,kh,Nh,xh,Ph,Dh,Oh,Vh],LI=[...Um,Mh],Bm=[bh,Sh,Rh,Om,Ch,Ah,kh,Nh,xh,Ph,Dh,Oh,Vh,Mh],qm=Bm,zm=[...qm,Vm,Mm,Lm];var FI=[...zm,Fm];function Wl(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Lh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ke=class n{constructor(e,t){this.comparator=e,this.root=t||Ge.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ge.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ge.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hn(this.root,e,this.comparator,!1)}getReverseIterator(){return new hn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hn(this.root,e,this.comparator,!0)}},hn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ge=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw L(43730,{key:this.key,value:this.value});if(this.right.isRed())throw L(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw L(27949);return e+(this.isRed()?0:1)}};Ge.EMPTY=null,Ge.RED=!0,Ge.BLACK=!1;Ge.EMPTY=new class{constructor(){this.size=0}get key(){throw L(57766)}get value(){throw L(16141)}get color(){throw L(16727)}get left(){throw L(29726)}get right(){throw L(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ge(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ye=class n{constructor(e){this.comparator=e,this.data=new ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yi(this.data.getIterator())}getIteratorFrom(e){return new yi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},yi=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Le=class n{constructor(e){this.fields=e,e.sort(Ne.comparator)}static empty(){return new n([])}unionWith(e){let t=new ye(Ne.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var vo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var nt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new vo("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};nt.EMPTY_BYTE_STRING=new nt("");var jm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function At(n){if(ee(!!n,39018),typeof n=="string"){let e=0,t=jm.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gt(n){return typeof n=="string"?nt.fromBase64String(n):nt.fromUint8Array(n)}var Fh="server_timestamp",Uh="__type__",Bh="__previous_value__",qh="__local_write_time__";function $a(n){return(n?.mapValue?.fields||{})[Uh]?.stringValue===Fh}function Wa(n){let e=n.mapValue.fields[Bh];return $a(e)?Wa(e):e}function Ii(n){let e=At(n.mapValue.fields[qh].timestampValue);return new ce(e.seconds,e.nanos)}var Ao=class{constructor(e,t,r,i,o,a,l,d,f,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=_}},wi="(default)",bo=class n{constructor(e,t){this.projectId=e,this.database=t||wi}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===wi}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ka="__type__",zh="__max__",ui={mapValue:{fields:{__type__:{stringValue:zh}}}},Ha="__vector__",mr="value";function $t(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$a(n)?4:Gh(n)?9007199254740991:jh(n)?10:11:L(28295,{value:n})}function $e(n,e){if(n===e)return!0;let t=$t(n);if(t!==$t(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ii(n).isEqual(Ii(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=At(i.timestampValue),l=At(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return Gt(i.bytesValue).isEqual(Gt(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return ie(i.geoPointValue.latitude)===ie(o.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return ie(i.integerValue)===ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ie(i.doubleValue),l=ie(o.doubleValue);return a===l?pr(a)===pr(l):isNaN(a)&&isNaN(l)}return!1})(n,e);case 9:return gn(n.arrayValue.values||[],e.arrayValue.values||[],$e);case 10:case 11:return(function(i,o){let a=i.mapValue.fields||{},l=o.mapValue.fields||{};if(Wl(a)!==Wl(l))return!1;for(let d in a)if(a.hasOwnProperty(d)&&(l[d]===void 0||!$e(a[d],l[d])))return!1;return!0})(n,e);default:return L(52216,{left:n})}}function gr(n,e){return(n.values||[]).find(t=>$e(t,e))!==void 0}function yn(n,e){if(n===e)return 0;let t=$t(n),r=$t(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(o,a){let l=ie(o.integerValue||o.doubleValue),d=ie(a.integerValue||a.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1})(n,e);case 3:return Kl(n.timestampValue,e.timestampValue);case 4:return Kl(Ii(n),Ii(e));case 5:return wo(n.stringValue,e.stringValue);case 6:return(function(o,a){let l=Gt(o),d=Gt(a);return l.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,a){let l=o.split("/"),d=a.split("/");for(let f=0;f<l.length&&f<d.length;f++){let _=G(l[f],d[f]);if(_!==0)return _}return G(l.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,a){let l=G(ie(o.latitude),ie(a.latitude));return l!==0?l:G(ie(o.longitude),ie(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Hl(n.arrayValue,e.arrayValue);case 10:return(function(o,a){let l=o.fields||{},d=a.fields||{},f=l[mr]?.arrayValue,_=d[mr]?.arrayValue,T=G(f?.values?.length||0,_?.values?.length||0);return T!==0?T:Hl(f,_)})(n.mapValue,e.mapValue);case 11:return(function(o,a){if(o===ui.mapValue&&a===ui.mapValue)return 0;if(o===ui.mapValue)return 1;if(a===ui.mapValue)return-1;let l=o.fields||{},d=Object.keys(l),f=a.fields||{},_=Object.keys(f);d.sort(),_.sort();for(let T=0;T<d.length&&T<_.length;++T){let b=wo(d[T],_[T]);if(b!==0)return b;let C=yn(l[d[T]],f[_[T]]);if(C!==0)return C}return G(d.length,_.length)})(n.mapValue,e.mapValue);default:throw L(23264,{he:t})}}function Kl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);let t=At(n),r=At(e),i=G(t.seconds,r.seconds);return i!==0?i:G(t.nanos,r.nanos)}function Hl(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=yn(t[i],r[i]);if(o)return o}return G(t.length,r.length)}function In(n){return So(n)}function So(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=At(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Gt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=So(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${So(t.fields[a])}`;return i+"}"})(n.mapValue):L(61005,{value:n})}function di(n){switch($t(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Wa(n);return e?16+di(e):16;case 5:return 2*n.stringValue.length;case 6:return Gt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+di(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Jt(r.fields,(o,a)=>{i+=o.length+di(a)}),i})(n.mapValue);default:throw L(13486,{value:n})}}function Ro(n){return!!n&&"integerValue"in n}function Qa(n){return!!n&&"arrayValue"in n}function fi(n){return!!n&&"mapValue"in n}function jh(n){return(n?.mapValue?.fields||{})[Ka]?.stringValue===Ha}function ar(n){if(n.geoPointValue)return{geoPointValue:B({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:B({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Jt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ar(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ar(n.arrayValue.values[t]);return e}return B({},n)}function Gh(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===zh}var BI={mapValue:{fields:{[Ka]:{stringValue:Ha},[mr]:{arrayValue:{}}}}};var Me=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!fi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ar(t)}setAll(e){let t=Ne.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){let d=this.getFieldsMap(t);this.applyChanges(d,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=ar(a):i.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());fi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $e(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];fi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Jt(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ar(this.value))}};function $h(n){let e=[];return Jt(n.fields,(t,r)=>{let i=new Ne([t]);if(fi(r)){let o=$h(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Le(e)}var wn=class n{constructor(e,t,r,i,o,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new n(e,0,Z.min(),Z.min(),Z.min(),Me.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Z.min(),Z.min(),Me.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Z.min(),Z.min(),Me.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Me.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Me.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var En=class{constructor(e,t){this.position=e,this.inclusive=t}};function Ql(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=yn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Jl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$e(n.position[t],e.position[t]))return!1;return!0}var Tn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Gm(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ei=class{},de=class n extends Ei{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Co(e,t,r):t==="array-contains"?new Do(e,r):t==="in"?new xo(e,r):t==="not-in"?new Oo(e,r):t==="array-contains-any"?new Vo(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new No(e,r):new ko(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(yn(t,this.value)):t!==null&&$t(this.value)===$t(t)&&this.matchesComparison(yn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},bt=class n extends Ei{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return Wh(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Wh(n){return n.op==="and"}function Kh(n){return $m(n)&&Wh(n)}function $m(n){for(let e of n.filters)if(e instanceof bt)return!1;return!0}function Po(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+In(n.value);if(Kh(n))return n.filters.map(e=>Po(e)).join(",");{let e=n.filters.map(t=>Po(t)).join(",");return`${n.op}(${e})`}}function Hh(n,e){return n instanceof de?(function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&$e(r.value,i.value)})(n,e):n instanceof bt?(function(r,i){return i instanceof bt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,l)=>o&&Hh(a,i.filters[l]),!0):!1})(n,e):void L(19439)}function Qh(n){return n instanceof de?(function(t){return`${t.field.canonicalString()} ${t.op} ${In(t.value)}`})(n):n instanceof bt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Qh).join(" ,")+"}"})(n):"Filter"}var Co=class extends de{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},No=class extends de{constructor(e,t){super(e,"in",t),this.keys=Jh("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ko=class extends de{constructor(e,t){super(e,"not-in",t),this.keys=Jh("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Jh(n,e){return(e.arrayValue?.values||[]).map(t=>F.fromName(t.referenceValue))}var Do=class extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Qa(t)&&gr(t.arrayValue,this.value)}},xo=class extends de{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&gr(this.value.arrayValue,t)}},Oo=class extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(gr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!gr(this.value.arrayValue,t)}},Vo=class extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Qa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gr(this.value.arrayValue,r))}};var Mo=class{constructor(e,t=null,r=[],i=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}};function Yl(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Mo(n,e,t,r,i,o,a)}function Ja(n){let e=H(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Po(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),Ga(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>In(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>In(r)).join(",")),e.Te=t}return e.Te}function Ya(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Gm(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Hh(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Jl(n.startAt,e.startAt)&&Jl(n.endAt,e.endAt)}var vn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function Wm(n,e,t,r,i,o,a,l){return new vn(n,e,t,r,i,o,a,l)}function Km(n){return new vn(n)}function Xl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Hm(n){return n.collectionGroup!==null}function cr(n){let e=H(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ye(Ne.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Tn(o,r))}),t.has(Ne.keyField().canonicalString())||e.Ie.push(new Tn(Ne.keyField(),r))}return e.Ie}function Lt(n){let e=H(n);return e.Ee||(e.Ee=Qm(e,cr(n))),e.Ee}function Qm(n,e){if(n.limitType==="F")return Yl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Tn(i.field,o)});let t=n.endAt?new En(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new En(n.startAt.position,n.startAt.inclusive):null;return Yl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Lo(n,e,t){return new vn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yh(n,e){return Ya(Lt(n),Lt(e))&&n.limitType===e.limitType}function Xh(n){return`${Ja(Lt(n))}|lt:${n.limitType}`}function or(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Qh(i)).join(", ")}]`),Ga(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>In(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>In(i)).join(",")),`Target(${r})`})(Lt(n))}; limitType=${n.limitType})`}function Xa(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):F.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of cr(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,l,d){let f=Ql(a,l,d);return a.inclusive?f<=0:f<0})(r.startAt,cr(r),i)||r.endAt&&!(function(a,l,d){let f=Ql(a,l,d);return a.inclusive?f>=0:f>0})(r.endAt,cr(r),i))})(n,e)}function Jm(n){return(e,t)=>{let r=!1;for(let i of cr(n)){let o=Ym(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Ym(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(o,a,l){let d=a.data.field(o),f=l.data.field(o);return d!==null&&f!==null?yn(d,f):L(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return L(19790,{direction:n.dir})}}var rt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jt(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Lh(this.inner)}size(){return this.innerSize}};var Xm=new ke(F.comparator);function Ti(){return Xm}var Zh=new ke(F.comparator);function li(...n){let e=Zh;for(let t of n)e=e.insert(t.key,t);return e}function ed(n){let e=Zh;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mt(){return ur()}function td(){return ur()}function ur(){return new rt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Zm=new ke(F.comparator),eg=new ye(F.comparator);function _e(...n){let e=eg;for(let t of n)e=e.add(t);return e}var tg=new ye(G);function ng(){return tg}function Za(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pr(e)?"-0":e}}function nd(n){return{integerValue:""+n}}function rg(n,e){return Nm(e)?nd(e):Za(n,e)}var An=class{constructor(){this._=void 0}};function ig(n,e,t){return n instanceof Wt?(function(i,o){let a={fields:{[Uh]:{stringValue:Fh},[qh]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&$a(o)&&(o=Wa(o)),o&&(a.fields[Bh]=o),{mapValue:a}})(t,e):n instanceof Kt?id(n,e):n instanceof Ht?sd(n,e):(function(i,o){let a=rd(i,o),l=Zl(a)+Zl(i.Ae);return Ro(a)&&Ro(i.Ae)?nd(l):Za(i.serializer,l)})(n,e)}function sg(n,e,t){return n instanceof Kt?id(n,e):n instanceof Ht?sd(n,e):t}function rd(n,e){return n instanceof bn?(function(r){return Ro(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var Wt=class extends An{},Kt=class extends An{constructor(e){super(),this.elements=e}};function id(n,e){let t=od(e);for(let r of n.elements)t.some(i=>$e(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ht=class extends An{constructor(e){super(),this.elements=e}};function sd(n,e){let t=od(e);for(let r of n.elements)t=t.filter(i=>!$e(i,r));return{arrayValue:{values:t}}}var bn=class extends An{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Zl(n){return ie(n.integerValue||n.doubleValue)}function od(n){return Qa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Fo=class{constructor(e,t){this.field=e,this.transform=t}};function og(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Kt&&i instanceof Kt||r instanceof Ht&&i instanceof Ht?gn(r.elements,i.elements,$e):r instanceof bn&&i instanceof bn?$e(r.Ae,i.Ae):r instanceof Wt&&i instanceof Wt})(n.transform,e.transform)}var Uo=class{constructor(e,t){this.version=e,this.transformResults=t}},tt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function pi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Sn=class{};function ad(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new vi(n.key,tt.none()):new Qt(n.key,n.data,tt.none());{let t=n.data,r=Me.empty(),i=new ye(Ne.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new We(n.key,r,new Le(i.toArray()),tt.none())}}function ag(n,e,t){n instanceof Qt?(function(i,o,a){let l=i.value.clone(),d=th(i.fieldTransforms,o,a.transformResults);l.setAll(d),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):n instanceof We?(function(i,o,a){if(!pi(i.precondition,o))return void o.convertToUnknownDocument(a.version);let l=th(i.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(cd(i)),d.setAll(l),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()})(n,e,t):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function lr(n,e,t,r){return n instanceof Qt?(function(o,a,l,d){if(!pi(o.precondition,a))return l;let f=o.value.clone(),_=nh(o.fieldTransforms,d,a);return f.setAll(_),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null})(n,e,t,r):n instanceof We?(function(o,a,l,d){if(!pi(o.precondition,a))return l;let f=nh(o.fieldTransforms,d,a),_=a.data;return _.setAll(cd(o)),_.setAll(f),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(T=>T.field))})(n,e,t,r):(function(o,a,l){return pi(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l})(n,e,t)}function cg(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=rd(r.transform,i||null);o!=null&&(t===null&&(t=Me.empty()),t.set(r.field,o))}return t||null}function eh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&gn(r,i,(o,a)=>og(o,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Qt=class extends Sn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},We=class extends Sn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function cd(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function th(n,e,t){let r=new Map;ee(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,l=e.data.field(o.field);r.set(o.field,sg(a,l,t[i]))}return r}function nh(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,ig(o,a,e))}return r}var vi=class extends Sn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Bo=class extends Sn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var qo=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&ag(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=lr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=lr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=td();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,l=this.applyToLocalView(a,o.mutatedFields);l=t.has(i.key)?null:l;let d=ad(a,l);d!==null&&r.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(Z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),_e())}isEqual(e){return this.batchId===e.batchId&&gn(this.mutations,e.mutations,(t,r)=>eh(t,r))&&gn(this.baseMutations,e.baseMutations,(t,r)=>eh(t,r))}},zo=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Zm})(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var jo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ne,q;function ug(n){switch(n){case S.OK:return L(64938);case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return L(15467,{code:n})}}function lg(n){if(n===void 0)return zt("GRPC error has no .code"),S.UNKNOWN;switch(n){case ne.OK:return S.OK;case ne.CANCELLED:return S.CANCELLED;case ne.UNKNOWN:return S.UNKNOWN;case ne.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case ne.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case ne.INTERNAL:return S.INTERNAL;case ne.UNAVAILABLE:return S.UNAVAILABLE;case ne.UNAUTHENTICATED:return S.UNAUTHENTICATED;case ne.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case ne.NOT_FOUND:return S.NOT_FOUND;case ne.ALREADY_EXISTS:return S.ALREADY_EXISTS;case ne.PERMISSION_DENIED:return S.PERMISSION_DENIED;case ne.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case ne.ABORTED:return S.ABORTED;case ne.OUT_OF_RANGE:return S.OUT_OF_RANGE;case ne.UNIMPLEMENTED:return S.UNIMPLEMENTED;case ne.DATA_LOSS:return S.DATA_LOSS;default:return L(39323,{code:n})}}(q=ne||(ne={}))[q.OK=0]="OK",q[q.CANCELLED=1]="CANCELLED",q[q.UNKNOWN=2]="UNKNOWN",q[q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",q[q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",q[q.NOT_FOUND=5]="NOT_FOUND",q[q.ALREADY_EXISTS=6]="ALREADY_EXISTS",q[q.PERMISSION_DENIED=7]="PERMISSION_DENIED",q[q.UNAUTHENTICATED=16]="UNAUTHENTICATED",q[q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",q[q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",q[q.ABORTED=10]="ABORTED",q[q.OUT_OF_RANGE=11]="OUT_OF_RANGE",q[q.UNIMPLEMENTED=12]="UNIMPLEMENTED",q[q.INTERNAL=13]="INTERNAL",q[q.UNAVAILABLE=14]="UNAVAILABLE",q[q.DATA_LOSS=15]="DATA_LOSS";var qI=new oi([4294967295,4294967295],0);var Go=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function $o(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hg(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dg(n,e){return $o(n,e.toTimestamp())}function fn(n){return ee(!!n,49232),Z.fromTimestamp((function(t){let r=At(t);return new ce(r.seconds,r.nanos)})(n))}function ud(n,e){return Wo(n,e).canonicalString()}function Wo(n,e){let t=(function(i){return new te(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function fg(n){let e=te.fromString(n);return ee(Eg(e),10190,{key:e.toString()}),e}function Ko(n,e){return ud(n.databaseId,e.path)}function pg(n){let e=fg(n);return e.length===4?te.emptyPath():gg(e)}function mg(n){return new te(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function gg(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function rh(n,e,t){return{name:Ko(n,e),fields:t.value.mapValue.fields}}function _g(n,e){let t;if(e instanceof Qt)t={update:rh(n,e.key,e.value)};else if(e instanceof vi)t={delete:Ko(n,e.key)};else if(e instanceof We)t={update:rh(n,e.key,e.data),updateMask:wg(e.fieldMask)};else{if(!(e instanceof Bo))return L(16599,{Vt:e.type});t={verify:Ko(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,a){let l=a.transform;if(l instanceof Wt)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Kt)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ht)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof bn)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw L(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:dg(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:L(27497)})(n,e.precondition)),t}function yg(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map(t=>(function(i,o){let a=i.updateTime?fn(i.updateTime):fn(o);return a.isEqual(Z.min())&&(a=fn(o)),new Uo(a,i.transformResults||[])})(t,e))):[]}function Ig(n){let e=pg(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ee(r===1,65062);let _=t.from[0];_.allDescendants?i=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=(function(T){let b=ld(T);return b instanceof bt&&Kh(b)?b.getFilters():[b]})(t.where));let a=[];t.orderBy&&(a=(function(T){return T.map(b=>(function(k){return new Tn(ln(k.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(b))})(t.orderBy));let l=null;t.limit&&(l=(function(T){let b;return b=typeof T=="object"?T.value:T,Ga(b)?null:b})(t.limit));let d=null;t.startAt&&(d=(function(T){let b=!!T.before,C=T.values||[];return new En(C,b)})(t.startAt));let f=null;return t.endAt&&(f=(function(T){let b=!T.before,C=T.values||[];return new En(C,b)})(t.endAt)),Wm(e,i,a,o,l,"F",d,f)}function ld(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ln(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ln(t.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=ln(t.unaryFilter.field);return de.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=ln(t.unaryFilter.field);return de.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return L(61313);default:return L(60726)}})(n):n.fieldFilter!==void 0?(function(t){return de.create(ln(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return L(58110);default:return L(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return bt.create(t.compositeFilter.filters.map(r=>ld(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L(1026)}})(t.compositeFilter.op))})(n):L(30097,{filter:n})}function ln(n){return Ne.fromServerFormat(n.fieldPath)}function wg(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Eg(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ho=class{constructor(e){this.yt=e}};function Tg(n){let e=Ig({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Lo(e,e.limit,"L"):e}var Ai=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),pr(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=At(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Gt(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Gh(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):jh(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):L(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=mr,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ie(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),F.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};Ai.Kt=new Ai;var Qo=class{constructor(){this.Cn=new Jo}addToCollectionParentIndex(e,t){return this.Cn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(jt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(jt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},Jo=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ye(te.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ye(te.comparator)).toArray()}};var zI=new Uint8Array(0);var ih={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hd=41943040,Ve=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ve.DEFAULT_COLLECTION_PERCENTILE=10,Ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ve.DEFAULT=new Ve(hd,Ve.DEFAULT_COLLECTION_PERCENTILE,Ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ve.DISABLED=new Ve(-1,0,0);var _r=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var sh="LruGarbageCollector",vg=1048576;function oh([n,e],[t,r]){let i=G(n,t);return i===0?G(e,r):i}var Yo=class{constructor(e){this.Ir=e,this.buffer=new ye(oh),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();oh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Xo=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){N(sh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){wr(t)?N(sh,"Ignoring IndexedDB error during garbage collection: ",t):await za(t)}await this.Vr(3e5)})}},Zo=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(Th.ce);let r=new Yo(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(ih)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ih):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,a,l,d,f,_=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,a=Date.now(),this.nthSequenceNumber(e,i))).next(T=>(r=T,l=Date.now(),this.removeTargets(e,r,t))).next(T=>(o=T,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(T=>(f=Date.now(),un()<=U.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${o} targets in `+(d-l)+`ms
	Removed ${T} documents in `+(f-d)+`ms
Total Duration: ${f-_}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:T})))}};function Ag(n,e){return new Zo(n,e)}var ea=class{constructor(){this.changes=new rt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ta=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var na=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&lr(r.mutation,i,Le.empty(),ce.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,_e()).next(()=>r))}getLocalViewOfDocuments(e,t,r=_e()){let i=Mt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=li();return o.forEach((l,d)=>{a=a.insert(l,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Mt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,_e()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let o=Ti(),a=ur(),l=(function(){return ur()})();return t.forEach((d,f)=>{let _=r.get(f.key);i.has(f.key)&&(_===void 0||_.mutation instanceof We)?o=o.insert(f.key,f):_!==void 0?(a.set(f.key,_.mutation.getFieldMask()),lr(_.mutation,f,_.mutation.getFieldMask(),ce.now())):a.set(f.key,Le.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((f,_)=>a.set(f,_)),t.forEach((f,_)=>l.set(f,new ta(_,a.get(f)??null))),l))}recalculateAndSaveOverlays(e,t){let r=ur(),i=new ke((a,l)=>a-l),o=_e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let l of a)l.keys().forEach(d=>{let f=t.get(d);if(f===null)return;let _=r.get(d)||Le.empty();_=l.applyToLocalView(f,_),r.set(d,_);let T=(i.get(l.batchId)||_e()).add(d);i=i.insert(l.batchId,T)})}).next(()=>{let a=[],l=i.getReverseIterator();for(;l.hasNext();){let d=l.getNext(),f=d.key,_=d.value,T=td();_.forEach(b=>{if(!o.has(b)){let C=ad(t.get(b),r.get(b));C!==null&&T.set(b,C),o=o.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,T))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(Mt()),l=fr,d=o;return a.next(f=>R.forEach(f,(_,T)=>(l<T.largestBatchId&&(l=T.largestBatchId),o.get(_)?R.resolve():this.remoteDocumentCache.getEntry(e,_).next(b=>{d=d.insert(_,b)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,d,f,_e())).next(_=>({batchId:l,changes:ed(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=li();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=li();return this.indexManager.getCollectionParents(e,o).next(l=>R.forEach(l,d=>{let f=(function(T,b){return new vn(b,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(_=>{_.forEach((T,b)=>{a=a.insert(T,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((d,f)=>{let _=f.getKey();a.get(_)===null&&(a=a.insert(_,wn.newInvalidDocument(_)))});let l=li();return a.forEach((d,f)=>{let _=o.get(d);_!==void 0&&lr(_.mutation,f,Le.empty(),ce.now()),Xa(t,f)&&(l=l.insert(d,f))}),l})}};var ra=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return R.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:fn(i.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:Tg(i.bundledQuery),readTime:fn(i.readTime)}})(t)),R.resolve()}};var ia=class{constructor(){this.overlays=new ke(F.comparator),this.qr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Mt();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=Mt(),o=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){let d=l.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>r&&i.set(d.getKey(),d)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ke((f,_)=>f-_),a=this.overlays.getIterator();for(;a.hasNext();){let f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let _=o.get(f.largestBatchId);_===null&&(_=Mt(),o=o.insert(f.largestBatchId,_)),_.set(f.getKey(),f)}}let l=Mt(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,_)=>l.set(f,_)),!(l.size()>=i)););return R.resolve(l)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new jo(t,r));let o=this.qr.get(t);o===void 0&&(o=_e(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}};var sa=class{constructor(){this.sessionToken=nt.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var yr=class{constructor(){this.Qr=new ye(re.$r),this.Ur=new ye(re.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new re(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new re(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new F(new te([])),r=new re(t,e),i=new re(t,e+1),o=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new F(new te([])),r=new re(t,e),i=new re(t,e+1),o=_e();return this.Ur.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new re(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},re=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||F.comparator(e.key,t.key)}};var oa=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ye(re.$r)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new qo(o,t,r,i);this.mutationQueue.push(a);for(let l of i)this.Zr=this.Zr.add(new re(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?ja:this.tr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new re(t,0),i=new re(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],a=>{let l=this.Xr(a.Yr);o.push(l)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ye(G);return t.forEach(i=>{let o=new re(i,0),a=new re(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],l=>{r=r.add(l.Yr)})}),R.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;F.isDocumentKey(o)||(o=o.child(""));let a=new re(new F(o),0),l=new ye(G);return this.Zr.forEachWhile(d=>{let f=d.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(d.Yr)),!0)},a),R.resolve(this.ti(l))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return R.forEach(t.mutations,i=>{let o=new re(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new re(t,0),i=this.Zr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var aa=class{constructor(e){this.ri=e,this.docs=(function(){return new ke(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():wn.newInvalidDocument(t))}getEntries(e,t){let r=Ti();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():wn.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ti(),a=t.path,l=new F(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){let{key:f,value:{document:_}}=d.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||Rm(Sm(_),r)<=0||(i.has(_.key)||Xa(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){L(9500)}ii(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ca(this)}getSize(e){return R.resolve(this.size)}},ca=class extends ea{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var ua=class{constructor(e){this.persistence=e,this.si=new rt(t=>Ja(t),Ya),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.oi=0,this._i=new yr,this.targetCount=0,this.ai=_r.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),R.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new _r(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Pr(t),R.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this._i.containsKey(t))}};var bi=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new Th(0),this.li=!1,this.li=!0,this.hi=new sa,this.referenceDelegate=e(this),this.Pi=new ua(this),this.indexManager=new Qo,this.remoteDocumentCache=(function(i){return new aa(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new Ho(t),this.Ii=new ra(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ia,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new oa(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);let i=new la(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,t){return R.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},la=class extends To{constructor(e){super(),this.currentSequenceNumber=e}},ha=class n{constructor(e){this.persistence=e,this.Ri=new yr,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw L(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.fi,r=>{let i=F.fromPath(r);return this.gi(e,i).next(o=>{o||t.removeEntry(i,Z.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return R.or([()=>R.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},Si=class n{constructor(e,t){this.persistence=e,this.pi=new rt(r=>km(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Ag(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return R.forEach(this.pi,(r,i)=>this.br(e,r,i).next(o=>o?R.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,t).next(l=>{l||(r++,o.removeEntry(a,Z.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=di(e.data.value)),t}br(e,t,r){return R.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return R.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var da=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=_e(),i=_e();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var fa=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var pa=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return gl()?8:Cm(le())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ys(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new fa;return this.Ss(e,t,a).next(l=>{if(o.result=l,this.Vs)return this.bs(e,t,a,l.size)})}).next(()=>o.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(un()<=U.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",or(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),R.resolve()):(un()<=U.DEBUG&&N("QueryEngine","Query:",or(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(un()<=U.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",or(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Lt(t))):R.resolve())}ys(e,t){if(Xl(t))return R.resolve(null);let r=Lt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Lo(t,null,"F"),r=Lt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=_e(...o);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(d=>{let f=this.Ds(t,l);return this.Cs(t,f,a,d.readTime)?this.ys(e,Lo(t,null,"F")):this.vs(e,f,t,d)}))})))}ws(e,t,r,i){return Xl(t)||i.isEqual(Z.min())?R.resolve(null):this.ps.getDocuments(e,r).next(o=>{let a=this.Ds(t,o);return this.Cs(t,a,r,i)?R.resolve(null):(un()<=U.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),or(t)),this.vs(e,a,t,bm(i,fr)).next(l=>l))})}Ds(e,t){let r=new ye(Jm(e));return t.forEach((i,o)=>{Xa(e,o)&&(r=r.add(o))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return un()<=U.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",or(t)),this.ps.getDocumentsMatchingQuery(e,t,jt.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var bg="LocalStore";var ma=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new ke(G),this.xs=new rt(o=>Ja(o),Ya),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new na(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function Sg(n,e,t,r){return new ma(n,e,t,r)}async function dd(n,e){let t=H(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],l=[],d=_e();for(let f of i){a.push(f.batchId);for(let _ of f.mutations)d=d.add(_.key)}for(let f of o){l.push(f.batchId);for(let _ of f.mutations)d=d.add(_.key)}return t.localDocuments.getDocuments(r,d).next(f=>({Ls:f,removedBatchIds:a,addedBatchIds:l}))})})}function Rg(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,d,f,_){let T=f.batch,b=T.keys(),C=R.resolve();return b.forEach(k=>{C=C.next(()=>_.getEntry(d,k)).next(V=>{let x=f.docVersions.get(k);ee(x!==null,48541),V.version.compareTo(x)<0&&(T.applyToRemoteDocument(V,f),V.isValidDocument()&&(V.setReadTime(f.commitVersion),_.addEntry(V)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(d,T))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let d=_e();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(d=d.add(l.batch.mutations[f].key));return d})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Pg(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function Cg(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ja),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var Ri=class{constructor(){this.activeTargetIds=ng()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ga=class{constructor(){this.Mo=new Ri,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ri,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _a=class{Oo(e){}shutdown(){}};var ah="ConnectivityMonitor",Pi=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){N(ah,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){N(ah,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var hi=null;function ya(){return hi===null?hi=(function(){return 268435456+Math.round(2147483648*Math.random())})():hi++,"0x"+hi.toString(16)}var lo="RestConnection",Ng={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Ia=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===wi?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){let a=ya(),l=this.zo(e,t.toUriEncodedString());N(lo,`Sending RPC '${e}' ${a}:`,l,r);let d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,i,o);let{host:f}=new URL(l),_=yt(f);return this.Jo(e,l,d,r,_).then(T=>(N(lo,`Received RPC '${e}' ${a}: `,T),T),T=>{throw Mi(lo,`RPC '${e}' ${a} failed with error: `,T,"url: ",l,"request:",r),T})}Ho(e,t,r,i,o,a){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+kn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}zo(e,t){let r=Ng[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var wa=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var ge="WebChannelConnection",Ea=class extends Ia{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){let a=ya();return new Promise((l,d)=>{let f=new io;f.setWithCredentials(!0),f.listenOnce(so.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case sr.NO_ERROR:let T=f.getResponseJson();N(ge,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(T)),l(T);break;case sr.TIMEOUT:N(ge,`RPC '${e}' ${a} timed out`),d(new D(S.DEADLINE_EXCEEDED,"Request time out"));break;case sr.HTTP_ERROR:let b=f.getStatus();if(N(ge,`RPC '${e}' ${a} failed with status:`,b,"response text:",f.getResponseText()),b>0){let C=f.getResponseJson();Array.isArray(C)&&(C=C[0]);let k=C?.error;if(k&&k.status&&k.message){let V=(function($){let W=$.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(W)>=0?W:S.UNKNOWN})(k.status);d(new D(V,k.message))}else d(new D(S.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new D(S.UNAVAILABLE,"Connection failed."));break;default:L(9055,{l_:e,streamId:a,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{N(ge,`RPC '${e}' ${a} completed.`)}});let _=JSON.stringify(i);N(ge,`RPC '${e}' ${a} sending request:`,i),f.send(t,"POST",_,r,15)})}T_(e,t,r){let i=ya(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=co(),l=ao(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;let _=o.join("");N(ge,`Creating RPC '${e}' stream ${i}: ${_}`,d);let T=a.createWebChannel(_,d);this.I_(T);let b=!1,C=!1,k=new wa({Yo:x=>{C?N(ge,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(b||(N(ge,`Opening RPC '${e}' stream ${i} transport.`),T.open(),b=!0),N(ge,`RPC '${e}' stream ${i} sending:`,x),T.send(x))},Zo:()=>T.close()}),V=(x,$,W)=>{x.listen($,J=>{try{W(J)}catch(Se){setTimeout(()=>{throw Se},0)}})};return V(T,cn.EventType.OPEN,()=>{C||(N(ge,`RPC '${e}' stream ${i} transport opened.`),k.o_())}),V(T,cn.EventType.CLOSE,()=>{C||(C=!0,N(ge,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(T))}),V(T,cn.EventType.ERROR,x=>{C||(C=!0,Mi(ge,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),k.a_(new D(S.UNAVAILABLE,"The operation could not be completed")))}),V(T,cn.EventType.MESSAGE,x=>{if(!C){let $=x.data[0];ee(!!$,16349);let W=$,J=W?.error||W[0]?.error;if(J){N(ge,`RPC '${e}' stream ${i} received error:`,J);let Se=J.status,De=(function(p){let g=ne[p];if(g!==void 0)return lg(g)})(Se),Ie=J.message;De===void 0&&(De=S.INTERNAL,Ie="Unknown error status: "+Se+" with message "+J.message),C=!0,k.a_(new D(De,Ie)),T.close()}else N(ge,`RPC '${e}' stream ${i} received:`,$),k.u_($)}}),V(l,oo.STAT_EVENT,x=>{x.stat===ci.PROXY?N(ge,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===ci.NOPROXY&&N(ge,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function ho(){return typeof document<"u"?document:null}function Li(n){return new Go(n,!0)}var Ci=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var ch="PersistentStream",Ta=class{constructor(e,t,r,i,o,a,l,d){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ci(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(zt(t.toString()),zt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new D(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return N(ch,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(N(ch,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var va=class extends Ta{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=yg(e.writeResults,e.commitTime),r=fn(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=mg(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>_g(this.serializer,r))};this.q_(t)}};var Aa=class{},ba=class extends Aa{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,Wo(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(S.UNKNOWN,o.toString())})}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,Wo(t,r),i,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new D(S.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},Sa=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(zt(t),this.aa=!1):N("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Er="RemoteStore",Ra=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{vr(this)&&(N(Er,"Restarting streams for network reachability change."),await(async function(d){let f=H(d);f.Ea.add(4),await Tr(f),f.Ra.set("Unknown"),f.Ea.delete(4),await Fi(f)})(this))})}),this.Ra=new Sa(r,i)}};async function Fi(n){if(vr(n))for(let e of n.da)await e(!0)}async function Tr(n){for(let e of n.da)await e(!1)}function vr(n){return H(n).Ea.size===0}async function fd(n,e,t){if(!wr(e))throw e;n.Ea.add(1),await Tr(n),n.Ra.set("Offline"),t||(t=()=>Pg(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N(Er,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Fi(n)})}function pd(n,e){return e().catch(t=>fd(n,t,e))}async function Ui(n){let e=H(n),t=St(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ja;for(;kg(e);)try{let i=await Cg(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Dg(e,i)}catch(i){await fd(e,i)}md(e)&&gd(e)}function kg(n){return vr(n)&&n.Ta.length<10}function Dg(n,e){n.Ta.push(e);let t=St(n);t.O_()&&t.X_&&t.ea(e.mutations)}function md(n){return vr(n)&&!St(n).x_()&&n.Ta.length>0}function gd(n){St(n).start()}async function xg(n){St(n).ra()}async function Og(n){let e=St(n);for(let t of n.Ta)e.ea(t.mutations)}async function Vg(n,e,t){let r=n.Ta.shift(),i=zo.from(r,e,t);await pd(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Ui(n)}async function Mg(n,e){e&&St(n).X_&&await(async function(r,i){if((function(a){return ug(a)&&a!==S.ABORTED})(i.code)){let o=r.Ta.shift();St(r).B_(),await pd(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Ui(r)}})(n,e),md(n)&&gd(n)}async function uh(n,e){let t=H(n);t.asyncQueue.verifyOperationInProgress(),N(Er,"RemoteStore received new credentials");let r=vr(t);t.Ea.add(3),await Tr(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Fi(t)}async function Lg(n,e){let t=H(n);e?(t.Ea.delete(2),await Fi(t)):e||(t.Ea.add(2),await Tr(t),t.Ra.set("Unknown"))}function St(n){return n.fa||(n.fa=(function(t,r,i){let o=H(t);return o.sa(),new va(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:xg.bind(null,n),r_:Mg.bind(null,n),ta:Og.bind(null,n),na:Vg.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Ui(n)):(await n.fa.stop(),n.Ta.length>0&&(N(Er,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var Pa=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,l=new n(e,t,a,i,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function _d(n,e){if(zt("AsyncQueue",`${e}: ${n}`),wr(n))return new D(S.UNAVAILABLE,`${e}: ${n}`);throw n}var Ca=class{constructor(){this.queries=lh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=H(t),o=i.queries;i.queries=lh(),o.forEach((a,l)=>{for(let d of l.Sa)d.onError(r)})})(this,new D(S.ABORTED,"Firestore shutting down"))}};function lh(){return new rt(n=>Xh(n),Yh)}function Fg(n){n.Ca.forEach(e=>{e.next()})}var hh,dh;(dh=hh||(hh={})).Ma="default",dh.Cache="cache";var Ug="SyncEngine";var Na=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new rt(l=>Xh(l),Yh),this.Iu=new Map,this.Eu=new Set,this.du=new ke(F.comparator),this.Au=new Map,this.Ru=new yr,this.Vu={},this.mu=new Map,this.fu=_r.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function Bg(n,e,t){let r=Gg(n);try{let i=await(function(a,l){let d=H(a),f=ce.now(),_=l.reduce((C,k)=>C.add(k.key),_e()),T,b;return d.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=Ti(),V=_e();return d.Ns.getEntries(C,_).next(x=>{k=x,k.forEach(($,W)=>{W.isValidDocument()||(V=V.add($))})}).next(()=>d.localDocuments.getOverlayedDocuments(C,k)).next(x=>{T=x;let $=[];for(let W of l){let J=cg(W,T.get(W.key).overlayedDocument);J!=null&&$.push(new We(W.key,J,$h(J.value.mapValue),tt.exists(!0)))}return d.mutationQueue.addMutationBatch(C,f,$,l)}).next(x=>{b=x;let $=x.applyToLocalDocumentSet(T,V);return d.documentOverlayCache.saveOverlays(C,x.batchId,$)})}).then(()=>({batchId:b.batchId,changes:ed(T)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,l,d){let f=a.Vu[a.currentUser.toKey()];f||(f=new ke(G)),f=f.insert(l,d),a.Vu[a.currentUser.toKey()]=f})(r,i.batchId,t),await Bi(r,i.changes),await Ui(r.remoteStore)}catch(i){let o=_d(i,"Failed to persist write");t.reject(o)}}function fh(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((o,a)=>{let l=a.view.va(e);l.snapshot&&i.push(l.snapshot)}),(function(a,l){let d=H(a);d.onlineState=l;let f=!1;d.queries.forEach((_,T)=>{for(let b of T.Sa)b.va(l)&&(f=!0)}),f&&Fg(d)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qg(n,e){let t=H(n),r=e.batch.batchId;try{let i=await Rg(t.localStore,e);Id(t,r,null),yd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Bi(t,i)}catch(i){await za(i)}}async function zg(n,e,t){let r=H(n);try{let i=await(function(a,l){let d=H(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let _;return d.mutationQueue.lookupMutationBatch(f,l).next(T=>(ee(T!==null,37113),_=T.keys(),d.mutationQueue.removeMutationBatch(f,T))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,_,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,_)).next(()=>d.localDocuments.getDocuments(f,_))})})(r.localStore,e);Id(r,e,t),yd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Bi(r,i)}catch(i){await za(i)}}function yd(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function Id(n,e,t){let r=H(n),i=r.Vu[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}async function Bi(n,e,t){let r=H(n),i=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((l,d)=>{a.push(r.pu(d,e,t).then(f=>{if((f||t)&&r.isPrimaryClient){let _=f?!f.fromCache:t?.targetChanges.get(d.targetId)?.current;r.sharedClientState.updateQueryState(d.targetId,_?"current":"not-current")}if(f){i.push(f);let _=da.As(d.targetId,f);o.push(_)}}))}),await Promise.all(a),r.Pu.H_(i),await(async function(d,f){let _=H(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>R.forEach(f,b=>R.forEach(b.Es,C=>_.persistence.referenceDelegate.addReference(T,b.targetId,C)).next(()=>R.forEach(b.ds,C=>_.persistence.referenceDelegate.removeReference(T,b.targetId,C)))))}catch(T){if(!wr(T))throw T;N(bg,"Failed to update sequence numbers: "+T)}for(let T of f){let b=T.targetId;if(!T.fromCache){let C=_.Ms.get(b),k=C.snapshotVersion,V=C.withLastLimboFreeSnapshotVersion(k);_.Ms=_.Ms.insert(b,V)}}})(r.localStore,o))}async function jg(n,e){let t=H(n);if(!t.currentUser.isEqual(e)){N(Ug,"User change. New user:",e.toKey());let r=await dd(t.localStore,e);t.currentUser=e,(function(o,a){o.mu.forEach(l=>{l.forEach(d=>{d.reject(new D(S.CANCELLED,a))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bi(t,r.Ls)}}function Gg(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zg.bind(null,e),e}var wd=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Li(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return Sg(this.persistence,new pa,t.initialUser,this.serializer)}Cu(t){return new bi(ha.mi,this.serializer)}Du(t){return new ga}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),ka=class extends wd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ee(this.persistence.referenceDelegate instanceof Si,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Xo(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Ve.withCacheSize(this.cacheSizeBytes):Ve.DEFAULT;return new bi(r=>Si.mi(r,t),this.serializer)}};var $g=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>fh(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=jg.bind(null,this.syncEngine),await Lg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Ca})()}createDatastore(t){let r=Li(t.databaseInfo.databaseId),i=(function(a){return new Ea(a)})(t.databaseInfo);return(function(a,l,d,f){return new ba(a,l,d,f)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,a,l,d){return new Ra(i,o,a,l,d)})(this.localStore,this.datastore,t.asyncQueue,r=>fh(this.syncEngine,r,0),(function(){return Pi.v()?new Pi:new _a})())}createSyncEngine(t,r){return(function(o,a,l,d,f,_,T){let b=new Na(o,a,l,d,f,_);return T&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=H(r);N(Er,"RemoteStore shutting down."),i.Ea.add(5),await Tr(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Rt="FirestoreClient",Da=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=he.UNAUTHENTICATED,this.clientId=dr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{N(Rt,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(N(Rt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=_d(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function fo(n,e){n.asyncQueue.verifyOperationInProgress(),N(Rt,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await dd(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ph(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Wg(n);N(Rt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>uh(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>uh(e.remoteStore,i)),n._onlineComponents=e}async function Wg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N(Rt,"Using user provided OfflineComponentProvider");try{await fo(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===S.FAILED_PRECONDITION||i.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Mi("Error using user provided cache. Falling back to memory cache: "+t),await fo(n,new wd)}}else N(Rt,"Using default OfflineComponentProvider"),await fo(n,new ka(void 0));return n._offlineComponents}async function Kg(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N(Rt,"Using user provided OnlineComponentProvider"),await ph(n,n._uninitializedComponentsProvider._online)):(N(Rt,"Using default OnlineComponentProvider"),await ph(n,new $g))),n._onlineComponents}function Hg(n){return Kg(n).then(e=>e.syncEngine)}function Ed(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var mh=new Map;var Td="firestore.googleapis.com",gh=!0,Ni=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new D(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Td,this.ssl=gh}else this.host=e.host,this.ssl=e.ssl??gh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vg)throw new D(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Am("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ed(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Rn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ni({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ni(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new po;switch(r.type){case"firstParty":return new yo(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=mh.get(t);r&&(N("ComponentProvider","Removing Datastore"),mh.delete(t),r.terminate())})(this),Promise.resolve()}};function Qg(n,e,t,r={}){n=_n(n,Rn);let i=yt(e),o=n._getSettings(),a=Te(B({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;i&&(ni(`https://${l}`),ri("Firestore",!0)),o.host!==Td&&o.host!==l&&Mi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Te(B({},o),{host:l,ssl:i,emulatorOptions:r});if(!ze(d,a)&&(n._setSettings(d),r.mockUserToken)){let f,_;if(typeof r.mockUserToken=="string")f=r.mockUserToken,_=he.MOCK_USER;else{f=ll(r.mockUserToken,n._app?.options.projectId);let T=r.mockUserToken.sub||r.mockUserToken.user_id;if(!T)throw new D(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new he(T)}n._authCredentials=new mo(new mi(f,_))}}var xa=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ve=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ir(t,n._jsonSchema))return new n(e,r||null,new F(te.fromString(t.referencePath)))}};ve._jsonSchemaVersion="firestore/documentReference/1.0",ve._jsonSchema={type:se("string",ve._jsonSchemaVersion),referencePath:se("string")};var vt=class n extends xa{constructor(e,t,r){super(e,t,Km(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ve(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Ke(n,e,...t){if(n=me(n),wh("collection","path",e),n instanceof Rn){let r=te.fromString(e,...t);return zl(r),new vt(n,null,r)}{if(!(n instanceof ve||n instanceof vt))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(te.fromString(e,...t));return zl(r),new vt(n.firestore,null,r)}}function Dn(n,e,...t){if(n=me(n),arguments.length===1&&(e=dr.newId()),wh("doc","path",e),n instanceof Rn){let r=te.fromString(e,...t);return ql(r),new ve(n,null,new F(r))}{if(!(n instanceof ve||n instanceof vt))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(te.fromString(e,...t));return ql(r),new ve(n.firestore,n instanceof vt?n.converter:null,new F(r))}}var _h="AsyncQueue",ki=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ci(this,"async_queue_retry"),this._c=()=>{let r=ho();r&&N(_h,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=ho();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=ho();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new et;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!wr(e))throw e;N(_h,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,zt("INTERNAL UNHANDLED ERROR: ",yh(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=Pa.createAndSchedule(this,e,t,r,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&L(47125,{Pc:yh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function yh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Pn=class extends Rn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ki,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ki(e),this._firestoreClient=void 0,await e}}};function vd(n,e){let t=typeof n=="object"?n:an(),r=typeof n=="string"?n:e||wi,i=ir(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=ul("firestore");o&&Qg(i,...o)}return i}function Jg(n){if(n._terminated)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Yg(n),n._firestoreClient}function Yg(n){let e=n._freezeSettings(),t=(function(i,o,a,l){return new Ao(i,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Ed(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Da(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}var Ft=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(nt.fromBase64String(e))}catch(t){throw new D(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ir(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Ft._jsonSchemaVersion="firestore/bytes/1.0",Ft._jsonSchema={type:se("string",Ft._jsonSchemaVersion),bytes:se("string")};var Cn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Nn=class{constructor(e){this._methodName=e}};var Ut=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Ir(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Ut._jsonSchemaVersion="firestore/geoPoint/1.0",Ut._jsonSchema={type:se("string",Ut._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};var Bt=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ir(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new D(S.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Bt._jsonSchemaVersion="firestore/vectorValue/1.0",Bt._jsonSchema={type:se("string",Bt._jsonSchemaVersion),vectorValues:se("object")};var Xg=/^__.*__$/,Oa=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new We(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qt(e,this.data,t,this.fieldTransforms)}},Di=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new We(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Ad(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L(40011,{Ac:n})}}var Va=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(B(B({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Oi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ad(this.Ac)&&Xg.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},Ma=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Li(e)}Cc(e,t,r,i=!1){return new Va({Ac:e,methodName:t,Dc:r,path:Ne.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ec(n){let e=n._freezeSettings(),t=Li(n._databaseId);return new Ma(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bd(n,e,t,r,i,o={}){let a=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);tc("Data must be an object, but it was:",a,r);let l=Sd(r,a),d,f;if(o.merge)d=new Le(a.fieldMask),f=a.fieldTransforms;else if(o.mergeFields){let _=[];for(let T of o.mergeFields){let b=Fa(e,T,t);if(!a.contains(b))throw new D(S.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);Pd(_,b)||_.push(b)}d=new Le(_),f=a.fieldTransforms.filter(T=>d.covers(T.field))}else d=null,f=a.fieldTransforms;return new Oa(new Me(l),d,f)}var xi=class n extends Nn{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var La=class n extends Nn{_toFieldTransform(e){return new Fo(e.path,new Wt)}isEqual(e){return e instanceof n}};function Zg(n,e,t,r){let i=n.Cc(1,e,t);tc("Data must be an object, but it was:",i,r);let o=[],a=Me.empty();Jt(r,(d,f)=>{let _=nc(e,d,t);f=me(f);let T=i.yc(_);if(f instanceof xi)o.push(_);else{let b=qi(f,T);b!=null&&(o.push(_),a.set(_,b))}});let l=new Le(o);return new Di(a,l,i.fieldTransforms)}function e_(n,e,t,r,i,o){let a=n.Cc(1,e,t),l=[Fa(e,r,t)],d=[i];if(o.length%2!=0)throw new D(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)l.push(Fa(e,o[b])),d.push(o[b+1]);let f=[],_=Me.empty();for(let b=l.length-1;b>=0;--b)if(!Pd(f,l[b])){let C=l[b],k=d[b];k=me(k);let V=a.yc(C);if(k instanceof xi)f.push(C);else{let x=qi(k,V);x!=null&&(f.push(C),_.set(C,x))}}let T=new Le(f);return new Di(_,T,a.fieldTransforms)}function qi(n,e){if(Rd(n=me(n)))return tc("Unsupported field value:",e,n),Sd(n,e);if(n instanceof Nn)return(function(r,i){if(!Ad(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let o=[],a=0;for(let l of r){let d=qi(l,i.wc(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return rg(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ce.fromDate(r);return{timestampValue:$o(i.serializer,o)}}if(r instanceof ce){let o=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$o(i.serializer,o)}}if(r instanceof Ut)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ft)return{bytesValue:hg(i.serializer,r._byteString)};if(r instanceof ve){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ud(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Bt)return(function(a,l){return{mapValue:{fields:{[Ka]:{stringValue:Ha},[mr]:{arrayValue:{values:a.toArray().map(f=>{if(typeof f!="number")throw l.Sc("VectorValues must only contain numeric values.");return Za(l.serializer,f)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${qa(r)}`)})(n,e)}function Sd(n,e){let t={};return Lh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jt(n,(r,i)=>{let o=qi(i,e.mc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Rd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ce||n instanceof Ut||n instanceof Ft||n instanceof ve||n instanceof Nn||n instanceof Bt)}function tc(n,e,t){if(!Rd(t)||!Eh(t)){let r=qa(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Fa(n,e,t){if((e=me(e))instanceof Cn)return e._internalPath;if(typeof e=="string")return nc(n,e);throw Oi("Field path arguments must be of type string or ",n,!1,void 0,t)}var t_=new RegExp("[~\\*/\\[\\]]");function nc(n,e,t){if(e.search(t_)>=0)throw Oi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Cn(...e.split("."))._internalPath}catch{throw Oi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Oi(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${r}`),a&&(d+=` in document ${i}`),d+=")"),new D(S.INVALID_ARGUMENT,l+n+d)}function Pd(n,e){return n.some(t=>t.isEqual(e))}var Vi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ua(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Cd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ua=class extends Vi{data(){return super.data()}};function Cd(n,e){return typeof e=="string"?nc(n,e):e instanceof Cn?e._internalPath:e._delegate._internalPath}function Nd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var dn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},pn=class n extends Vi{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new mn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Cd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(S.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};pn._jsonSchemaVersion="firestore/documentSnapshot/1.0",pn._jsonSchema={type:se("string",pn._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};var mn=class extends pn{data(e={}){return super.data(e)}},hr=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new dn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new mn(this._firestore,this._userDataWriter,r.key,r,new dn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{let d=new mn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new dn(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let d=new mn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new dn(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),f=-1,_=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),_=a.indexOf(l.doc.key)),{type:n_(l.type),doc:d,oldIndex:f,newIndex:_}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(S.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=dr.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function n_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L(61501,{type:n})}}hr._jsonSchemaVersion="firestore/querySnapshot/1.0",hr._jsonSchema={type:se("string",hr._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};function zi(n,e,t){n=_n(n,ve);let r=_n(n.firestore,Pn),i=Nd(n.converter,e,t);return rc(r,[bd(ec(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,tt.none())])}function kd(n,e,t,...r){n=_n(n,ve);let i=_n(n.firestore,Pn),o=ec(i),a;return a=typeof(e=me(e))=="string"||e instanceof Cn?e_(o,"updateDoc",n._key,e,t,r):Zg(o,"updateDoc",n._key,e),rc(i,[a.toMutation(n._key,tt.exists(!0))])}function it(n,e){let t=_n(n.firestore,Pn),r=Dn(n),i=Nd(n.converter,e);return rc(t,[bd(ec(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,tt.exists(!1))]).then(()=>r)}function rc(n,e){return(function(r,i){let o=new et;return r.asyncQueue.enqueueAndForget(async()=>Bg(await Hg(r),i,o)),o.promise})(Jg(n),e)}function be(){return new La("serverTimestamp")}(function(e,t=!0){(function(i){kn=i})(Tt),Et(new Oe("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),l=new Pn(new go(r.getProvider("auth-internal")),new Io(a,r.getProvider("app-check-internal")),(function(f,_){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new D(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bo(f.options.projectId,_)})(a,i),a);return o=B({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Fe(Fl,Ul,e),Fe(Fl,Ul,"esm2020")})();function Wd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Kd=Wd,Hd=new Ye("auth","Firebase",Wd());var Hi=new It("@firebase/auth");function r_(n,...e){Hi.logLevel<=U.WARN&&Hi.warn(`Auth (${Tt}): ${n}`,...e)}function Gi(n,...e){Hi.logLevel<=U.ERROR&&Hi.error(`Auth (${Tt}): ${n}`,...e)}function Qe(n,...e){throw Ec(n,...e)}function Ue(n,...e){return Ec(n,...e)}function wc(n,e,t){let r=Te(B({},Kd()),{[e]:t});return new Ye("auth","Firebase",r).create(e,{appName:n.name})}function Yt(n){return wc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function i_(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Qe(n,"argument-error"),wc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ec(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Hd.create(n,...e)}function O(n,e,...t){if(!n)throw Ec(e,...t)}function st(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Gi(e),new Error(e)}function at(n,e){n||st(e)}function oc(){return typeof self<"u"&&self.location?.href||""}function s_(){return Dd()==="http:"||Dd()==="https:"}function Dd(){return typeof self<"u"&&self.location?.protocol||null}function o_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s_()||fl()||"connection"in navigator)?navigator.onLine:!0}function a_(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Xt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,at(t>e,"Short delay should be less than long delay!"),this.isMobile=hl()||pl()}get(){return o_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Tc(n,e){at(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Qi=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;st("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;st("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;st("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var c_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var u_=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],l_=new Xt(3e4,6e4);function vc(n,e){return n.tenantId&&!e.tenantId?Te(B({},e),{tenantId:n.tenantId}):e}async function On(n,e,t,r,i={}){return Qd(n,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});let l=on(B({key:n.config.apiKey},a)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);let f=B({method:e,headers:d},o);return dl()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&yt(n.emulatorConfig.host)&&(f.credentials="include"),Qi.fetch()(await Jd(n,n.config.apiHost,t,l),f)})}async function Qd(n,e,t){n._canInitEmulator=!1;let r=B(B({},c_),e);try{let i=new ac(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=await o.json();if("needConfirmation"in a)throw ji(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let l=o.ok?a.errorMessage:a.error.message,[d,f]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw ji(n,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw ji(n,"email-already-in-use",a);if(d==="USER_DISABLED")throw ji(n,"user-disabled",a);let _=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw wc(n,_,f);Qe(n,_)}}catch(i){if(i instanceof Pe)throw i;Qe(n,"network-request-failed",{message:String(i)})}}async function h_(n,e,t,r,i={}){let o=await On(n,e,t,r,i);return"mfaPendingCredential"in o&&Qe(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function Jd(n,e,t,r){let i=`${e}${t}?${r}`,o=n,a=o.config.emulator?Tc(n.config,i):`${n.config.apiScheme}://${i}`;return u_.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}var ac=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ue(this.auth,"network-request-failed")),l_.get())})}};function ji(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ue(n,e,r);return i.customData._tokenResponse=t,i}async function d_(n,e){return On(n,"POST","/v1/accounts:delete",e)}async function Ji(n,e){return On(n,"POST","/v1/accounts:lookup",e)}function Ar(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Yd(n,e=!1){let t=me(n),r=await t.getIdToken(e),i=Ac(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Ar(ic(i.auth_time)),issuedAtTime:Ar(ic(i.iat)),expirationTime:Ar(ic(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function ic(n){return Number(n)*1e3}function Ac(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Gi("JWT malformed, contained fewer than 3 sections"),null;try{let i=ei(t);return i?JSON.parse(i):(Gi("Failed to decode base64 JWT payload"),null)}catch(i){return Gi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function xd(n){let e=Ac(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Sr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Pe&&f_(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function f_({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var cc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Rr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ar(this.lastLoginAt),this.creationTime=Ar(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Yi(n){let e=n.auth,t=await n.getIdToken(),r=await Sr(n,Ji(e,{idToken:t}));O(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let o=i.providerUserInfo?.length?Zd(i.providerUserInfo):[],a=p_(n.providerData,o),l=n.isAnonymous,d=!(n.email&&i.passwordHash)&&!a?.length,f=l?d:!1,_={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Rr(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(n,_)}async function Xd(n){let e=me(n);await Yi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p_(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Zd(n){return n.map(r=>{var i=r,{providerId:e}=i,t=Hr(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function m_(n,e){let t=await Qd(n,{},async()=>{let r=on({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=await Jd(n,i,"/v1/token",`key=${o}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";let d={method:"POST",headers:l,body:r};return n.emulatorConfig&&yt(n.emulatorConfig.host)&&(d.credentials="include"),Qi.fetch()(a,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function g_(n,e){return On(n,"POST","/v2/accounts:revokeToken",vc(n,e))}var br=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){O(e.length!==0,"internal-error");let t=xd(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(O(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:o}=await m_(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(O(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return st("not implemented")}};function Pt(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ct=class n{constructor(o){var a=o,{uid:e,auth:t,stsTokenManager:r}=a,i=Hr(a,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Rr(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Sr(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Yd(this,e)}reload(){return Xd(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>B({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Te(B({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Yi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ce(this.auth.app))return Promise.reject(Yt(this.auth));let e=await this.getIdToken();return await Sr(this,d_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Te(B({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>B({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,a=t.photoURL??void 0,l=t.tenantId??void 0,d=t._redirectEventId??void 0,f=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:T,emailVerified:b,isAnonymous:C,providerData:k,stsTokenManager:V}=t;O(T&&V,e,"internal-error");let x=br.fromJSON(this.name,V);O(typeof T=="string",e,"internal-error"),Pt(r,e.name),Pt(i,e.name),O(typeof b=="boolean",e,"internal-error"),O(typeof C=="boolean",e,"internal-error"),Pt(o,e.name),Pt(a,e.name),Pt(l,e.name),Pt(d,e.name),Pt(f,e.name),Pt(_,e.name);let $=new n({uid:T,auth:e,email:i,emailVerified:b,displayName:r,isAnonymous:C,photoURL:a,phoneNumber:o,tenantId:l,stsTokenManager:x,createdAt:f,lastLoginAt:_});return k&&Array.isArray(k)&&($.providerData=k.map(W=>B({},W))),d&&($._redirectEventId=d),$}static async _fromIdTokenResponse(e,t,r=!1){let i=new br;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Yi(o),o}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];O(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Zd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,l=new br;l.updateFromIdToken(r);let d=new n({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:a}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Rr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(d,f),d}};var Od=new Map;function ot(n){at(n instanceof Function,"Expected a class definition");let e=Od.get(n);return e?(at(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Od.set(n,e),e)}var __=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),uc=__;function $i(n,e,t){return`firebase:${n}:${e}:${t}`}var Xi=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=$i(this.userKey,i.apiKey,o),this.fullPersistenceKey=$i("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Ji(this.auth,{idToken:e}).catch(()=>{});return t?Ct._fromGetAccountInfoResponse(this.auth,t,e):null}return Ct._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(ot(uc),e,r);let i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f),o=i[0]||ot(uc),a=$i(r,e.config.apiKey,e.name),l=null;for(let f of t)try{let _=await f._get(a);if(_){let T;if(typeof _=="string"){let b=await Ji(e,{idToken:_}).catch(()=>{});if(!b)break;T=await Ct._fromGetAccountInfoResponse(e,b,_)}else T=Ct._fromJSON(e,_);f!==o&&(l=T),o=f;break}}catch{}let d=i.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new n(o,e,r):(o=d[0],l&&await o._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(a)}catch{}})),new n(o,e,r))}};function Vd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ef(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(of(e))return"Blackberry";if(af(e))return"Webos";if(tf(e))return"Safari";if((e.includes("chrome/")||nf(e))&&!e.includes("edge/"))return"Chrome";if(sf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function ef(n=le()){return/firefox\//i.test(n)}function tf(n=le()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nf(n=le()){return/crios\//i.test(n)}function rf(n=le()){return/iemobile/i.test(n)}function sf(n=le()){return/android/i.test(n)}function of(n=le()){return/blackberry/i.test(n)}function af(n=le()){return/webos/i.test(n)}function bc(n=le()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function y_(n=le()){return bc(n)&&!!window.navigator?.standalone}function I_(){return ml()&&document.documentMode===10}function cf(n=le()){return bc(n)||sf(n)||af(n)||of(n)||/windows phone/i.test(n)||rf(n)}function uf(n,e=[]){let t;switch(n){case"Browser":t=Vd(le());break;case"Worker":t=`${Vd(le())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tt}/${r}`}var lc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,l)=>{try{let d=e(o);a(d)}catch(d){l(d)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function w_(n,e={}){return On(n,"GET","/v2/passwordPolicy",vc(n,e))}var E_=6,hc=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??E_,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var dc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zi(this),this.idTokenSubscription=new Zi(this),this.beforeStateQueue=new lc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Hd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ot(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Ji(this,{idToken:e}),r=await Ct._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ce(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,a=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&l?.user&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=a_()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ce(this.app))return Promise.reject(Yt(this));let t=e?me(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ce(this.app)?Promise.reject(Yt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ce(this.app)?Promise.reject(Yt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ot(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await w_(this),t=new hc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ye("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await g_(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&ot(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await Xi.create(this,[ot(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let d=e.addObserver(t,r,i);return()=>{a=!0,d()}}else{let d=e.addObserver(t);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ce(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&r_(`Error while retrieving App Check token: ${e.error}`),e?.token}};function as(n){return me(n)}var Zi=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Il(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Sc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function T_(n){Sc=n}function v_(n){return Sc.loadJS(n)}function A_(){return Sc.gapiScript}function lf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function hf(n,e){let t=ir(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(ze(o,e??{}))return i;Qe(i,"already-initialized")}return t.initialize({options:e})}function b_(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ot);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function df(n,e,t){let r=as(n);O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=ff(e),{host:a,port:l}=S_(e),d=l===null?"":`:${l}`,f={url:`${o}//${a}${d}/`},_=Object.freeze({host:a,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){O(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),O(ze(f,r.config.emulator)&&ze(_,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=f,r.emulatorConfig=_,r.settings.appVerificationDisabledForTesting=!0,yt(a)?(ni(`${o}//${a}${d}`),ri("Auth",!0)):i||R_()}function ff(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function S_(n){let e=ff(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Md(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Md(a)}}}function Md(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function R_(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Pr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return st("not implemented")}_getIdTokenResponse(e){return st("not implemented")}_linkToIdToken(e,t){return st("not implemented")}_getReauthenticationResolver(e){return st("not implemented")}};async function xn(n,e){return h_(n,"POST","/v1/accounts:signInWithIdp",vc(n,e))}var P_="http://localhost",es=class n extends Pr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Qe("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let l=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=l,o=Hr(l,["providerId","signInMethod"]);if(!r||!i)return null;let a=new n(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return xn(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,xn(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,xn(e,t)}buildRequest(){let e={requestUri:P_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=on(t)}return e}};var Cr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ts=class extends Cr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Rc=(()=>{class n extends ts{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return es._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Nr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let o=await Ct._fromIdTokenResponse(e,r,i),a=Ld(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Ld(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Ld(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var fc=class n extends Pe{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function pf(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?fc._fromErrorAndOperation(n,o,e,r):o})}async function C_(n,e,t=!1){let r=await Sr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Nr._forOperation(n,"link",r)}async function N_(n,e,t=!1){let{auth:r}=n;if(Ce(r.app))return Promise.reject(Yt(r));let i="reauthenticate";try{let o=await Sr(n,pf(r,i,e,n),t);O(o.idToken,r,"internal-error");let a=Ac(o.idToken);O(a,r,"internal-error");let{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),Nr._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Qe(r,"user-mismatch"),o}}async function k_(n,e,t=!1){if(Ce(n.app))return Promise.reject(Yt(n));let r="signIn",i=await pf(n,r,e),o=await Nr._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}function mf(n,e,t,r){return me(n).onIdTokenChanged(e,t,r)}function gf(n,e,t){return me(n).beforeAuthStateChanged(e,t)}var ns="__sak";var rs=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ns,"1"),this.storage.removeItem(ns),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var D_=1e3,x_=10,O_=(()=>{class n extends rs{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let l=this.storage.getItem(i);!r&&this.localCache[i]===l||this.notifyListeners(i,l)},a=this.storage.getItem(i);I_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,x_):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},D_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),_f=O_;var V_=(()=>{class n extends rs{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Pc=V_;function M_(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var L_=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:o,data:a}=r.data,l=this.handlersMap[o];if(!l?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let d=Array.from(l).map(async _=>_(r.origin,a)),f=await M_(d);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:f})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Cc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var pc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((l,d)=>{let f=Cc("",20);i.port1.start();let _=setTimeout(()=>{d(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(T){let b=T;if(b.data.eventId===f)switch(b.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(b.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}};function He(){return window}function F_(n){He().location.href=n}function yf(){return typeof He().WorkerGlobalScope<"u"&&typeof He().importScripts=="function"}async function U_(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function B_(){return navigator?.serviceWorker?.controller||null}function q_(){return yf()?self:null}var If="firebaseLocalStorageDb",z_=1,is="firebaseLocalStorage",wf="fbase_key",Zt=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function cs(n,e){return n.transaction([is],e?"readwrite":"readonly").objectStore(is)}function j_(){let n=indexedDB.deleteDatabase(If);return new Zt(n).toPromise()}function mc(){let n=indexedDB.open(If,z_);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(is,{keyPath:wf})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(is)?e(r):(r.close(),await j_(),e(await mc()))})})}async function Fd(n,e,t){let r=cs(n,!0).put({[wf]:e,value:t});return new Zt(r).toPromise()}async function G_(n,e){let t=cs(n,!1).get(e),r=await new Zt(t).toPromise();return r===void 0?null:r.value}function Ud(n,e){let t=cs(n,!0).delete(e);return new Zt(t).toPromise()}var $_=800,W_=3,K_=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mc(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>W_)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=L_._getInstance(q_()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await U_(),!this.activeServiceWorker)return;this.sender=new pc(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||B_()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await mc();return await Fd(t,ns,"1"),await Ud(t,ns),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Fd(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>G_(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ud(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let a=cs(o,!1).getAll();return new Zt(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Ef=K_;var ZI=lf("rcb"),ew=new Xt(3e4,6e4);function Tf(n,e){return e?ot(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var kr=class extends Pr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return xn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return xn(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function H_(n){return k_(n.auth,new kr(n),n.bypassAuthState)}function Q_(n){let{auth:e,user:t}=n;return O(t,e,"internal-error"),N_(t,new kr(n),n.bypassAuthState)}async function J_(n){let{auth:e,user:t}=n;return O(t,e,"internal-error"),C_(t,new kr(n),n.bypassAuthState)}var ss=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:l}=e;if(a){this.reject(a);return}let d={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return H_;case"linkViaPopup":case"linkViaRedirect":return J_;case"reauthViaPopup":case"reauthViaRedirect":return Q_;default:Qe(this.auth,"internal-error")}}resolve(e){at(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){at(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Y_=new Xt(2e3,1e4);async function Nc(n,e,t){if(Ce(n.app))return Promise.reject(Ue(n,"operation-not-supported-in-this-environment"));let r=as(n);i_(n,e,Cr);let i=Tf(r,t);return new X_(r,"signInViaPopup",e,i).executeNotNull()}var X_=(()=>{class n extends ss{constructor(t,r,i,o,a){super(t,r,o,a),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return O(t,this.auth,"internal-error"),t}async onExecution(){at(this.filter.length===1,"Popup operations only handle one event");let t=Cc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ue(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ue(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ue(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Y_.get())};t()}}n.currentPopupAction=null;return n})(),Z_="pendingRedirect",Wi=new Map,gc=class extends ss{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Wi.get(this.auth._key());if(!e){try{let r=await ey(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wi.set(this.auth._key(),e)}return this.bypassAuthState||Wi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function ey(n,e){let t=ry(e),r=ny(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function ty(n,e){Wi.set(n._key(),e)}function ny(n){return ot(n._redirectPersistence)}function ry(n){return $i(Z_,n.config.apiKey,n.name)}async function iy(n,e,t=!1){if(Ce(n.app))return Promise.reject(Yt(n));let r=as(n),i=Tf(r,e),a=await new gc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}var sy=600*1e3,_c=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oy(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!vf(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ue(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sy&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bd(e))}saveEventToCache(e){this.cachedEventUids.add(Bd(e)),this.lastProcessedEventTime=Date.now()}};function Bd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function vf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function oy(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vf(n);default:return!1}}async function ay(n,e={}){return On(n,"GET","/v1/projects",e)}var cy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uy=/^https?/;async function ly(n){if(n.config.emulator)return;let{authorizedDomains:e}=await ay(n);for(let t of e)try{if(hy(t))return}catch{}Qe(n,"unauthorized-domain")}function hy(n){let e=oc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!uy.test(t))return!1;if(cy.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var dy=new Xt(3e4,6e4);function qd(){let n=He().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function fy(n){return new Promise((e,t)=>{function r(){qd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qd(),t(Ue(n,"network-request-failed"))},timeout:dy.get()})}if(He().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(He().gapi?.load)r();else{let i=lf("iframefcb");return He()[i]=()=>{gapi.load?r():t(Ue(n,"network-request-failed"))},v_(`${A_()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Ki=null,e})}var Ki=null;function py(n){return Ki=Ki||fy(n),Ki}var my=new Xt(5e3,15e3),gy="__/auth/iframe",_y="emulator/auth/iframe",yy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Iy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wy(n){let e=n.config;O(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Tc(e,_y):`https://${n.config.authDomain}/${gy}`,r={apiKey:e.apiKey,appName:n.name,v:Tt},i=Iy.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${on(r).slice(1)}`}async function Ey(n){let e=await py(n),t=He().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:wy(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yy,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});let a=Ue(n,"network-request-failed"),l=He().setTimeout(()=>{o(a)},my.get());function d(){He().clearTimeout(l),i(r)}r.ping(d).then(d,()=>{o(a)})}))}var Ty={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vy=500,Ay=600,by="_blank",Sy="http://localhost",os=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Ry(n,e,t,r=vy,i=Ay){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),l="",d=Te(B({},Ty),{width:r.toString(),height:i.toString(),top:o,left:a}),f=le().toLowerCase();t&&(l=nf(f)?by:t),ef(f)&&(e=e||Sy,d.scrollbars="yes");let _=Object.entries(d).reduce((b,[C,k])=>`${b}${C}=${k},`,"");if(y_(f)&&l!=="_self")return Py(e||"",l),new os(null);let T=window.open(e||"",l,_);O(T,n,"popup-blocked");try{T.focus()}catch{}return new os(T)}function Py(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var Cy="__/auth/handler",Ny="emulator/auth/handler",ky=encodeURIComponent("fac");async function zd(n,e,t,r,i,o){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Tt,eventId:i};if(e instanceof Cr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",yl(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[_,T]of Object.entries(o||{}))a[_]=T}if(e instanceof ts){let _=e.getScopes().filter(T=>T!=="");_.length>0&&(a.scopes=_.join(","))}n.tenantId&&(a.tid=n.tenantId);let l=a;for(let _ of Object.keys(l))l[_]===void 0&&delete l[_];let d=await n._getAppCheckToken(),f=d?`#${ky}=${encodeURIComponent(d)}`:"";return`${Dy(n)}?${on(l).slice(1)}${f}`}function Dy({config:n}){return n.emulator?Tc(n,Ny):`https://${n.authDomain}/${Cy}`}var sc="webStorageSupport",yc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pc,this._completeRedirectFn=iy,this._overrideRedirectResult=ty}async _openPopup(e,t,r,i){at(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await zd(e,t,r,oc(),i);return Ry(e,o,Cc())}async _openRedirect(e,t,r,i){await this._originValidation(e);let o=await zd(e,t,r,oc(),i);return F_(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(at(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await Ey(e),r=new _c(e);return t.register("authEvent",i=>(O(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(sc,{type:sc},i=>{let o=i?.[0]?.[sc];o!==void 0&&t(!!o),Qe(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ly(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cf()||tf()||bc()}},Af=yc;var jd="@firebase/auth",Gd="1.11.1";var Ic=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function xy(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Oy(n){Et(new Oe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let d={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uf(n)},f=new dc(r,i,o,d);return b_(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Et(new Oe("auth-internal",e=>{let t=as(e.getProvider("auth").getImmediate());return(r=>new Ic(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fe(jd,Gd,xy(n)),Fe(jd,Gd,"esm2020")}var Vy=300,My=qs("authIdTokenMaxAge")||Vy,$d=null,Ly=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>My)return;let i=t?.token;$d!==i&&($d=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function kc(n=an()){let e=ir(n,"auth");if(e.isInitialized())return e.getImmediate();let t=hf(n,{popupRedirectResolver:Af,persistence:[Ef,_f,Pc]}),r=qs("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=Ly(o.toString());gf(t,a,()=>a(t.currentUser)),mf(t,l=>a(l))}}let i=Us("auth");return i&&df(t,`http://${i}`),t}function Fy(){return document.getElementsByTagName("head")?.[0]??document}T_({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Ue("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",Fy().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Oy("Browser");var bf={apiKey:"AIzaSyB6w2XQOpuwol6ZvJiQxob0QE0s3kUQwA0",authDomain:"roadmap-b6949.firebaseapp.com",projectId:"roadmap-b6949",storageBucket:"roadmap-b6949.firebasestorage.app",messagingSenderId:"751503678528",appId:"1:751503678528:web:a6eeddd87d74659e0813a5",measurementId:"G-W3EKPGV2PF"};var en=null;try{Dl().length?en=an():en=ro(bf)}catch{en=null}var fe=en?vd(en):null,Dc=en?kc(en):null;async function Uy(n){if(!fe)throw new Error("Firestore not initialized (check firebaseConfig in src/environments/firebase.ts)");let e=n||null;if(!e)try{let r=localStorage.getItem("currentUser");if(r){let i=JSON.parse(r);e=encodeURIComponent(i.email||i.uid||"unknown")}}catch{e="unknown"}e||(e="unknown");let t={roadmaps:0,completionEvents:0,quizAttempts:0,badges:0};try{let r=localStorage.getItem("savedRoadmaps")||"[]",i=JSON.parse(r);for(let o of i){let a={owner:e,title:o.name||o.title||"Untitled Roadmap",skillsRequired:o.skills||[],steps:o.roadmapLevels||[],certifications:o.certifications||[],projectIdeas:o.projectIdeas||[],createdAt:be(),updatedAt:be()};try{await it(Ke(fe,"roadmaps"),a),t.roadmaps++}catch{try{let d=Dn(Ke(fe,"roadmaps"));await zi(d,a),t.roadmaps++}catch(d){console.warn("Failed to write roadmap",d)}}}}catch(r){console.warn("No savedRoadmaps to migrate",r)}try{let r=localStorage.getItem("completionEvents")||"[]",i=JSON.parse(r);for(let o of i)try{await it(Ke(fe,`users/${e}/activity`),{type:"completion",payload:o,createdAt:be()}),t.completionEvents++}catch(a){console.warn("Failed to write completion event",a)}}catch(r){console.warn("No completionEvents to migrate",r)}try{let r=localStorage.getItem("quizAttempts")||"[]",i=JSON.parse(r);for(let o of i)try{await it(Ke(fe,`users/${e}/activity`),{type:"quizAttempt",payload:o,createdAt:be()}),t.quizAttempts++}catch(a){console.warn("Failed to write quiz attempt",a)}}catch(r){console.warn("No quizAttempts to migrate",r)}try{let r=localStorage.getItem("badges")||"[]",i=JSON.parse(r);for(let o of i)try{await it(Ke(fe,`users/${e}/badges`),Te(B({},o),{createdAt:be()})),t.badges++}catch(a){console.warn("Failed to write badge",a)}}catch(r){console.warn("No badges to migrate",r)}return console.info("Migration complete",t),t}try{window.runLocalStorageMigration=Uy}catch{}var us=class n{async createOrUpdateUser(e,t){if(fe)try{let r=Dn(fe,"users",e);await zi(r,{uid:e,email:t.email,displayName:t.displayName||null,firstTime:t.firstTime??!1,skills:[],goals:null,createdAt:be(),lastLogin:be()},{merge:!0})}catch(r){console.warn("Firestore createOrUpdateUser failed",r)}}async updateLastLogin(e){if(fe)try{let t=Dn(fe,"users",e);await kd(t,{lastLogin:be(),firstTime:!1})}catch{}}async createRoadmap(e,t){if(!fe)return null;try{let r=Ke(fe,"roadmaps");return(await it(r,{owner:e,title:t.title,skillsRequired:t.skillsRequired||[],steps:t.steps||[],createdAt:be(),updatedAt:be()})).id}catch(r){return console.warn("createRoadmap failed",r),null}}async recordActivity(e,t){if(fe)try{let r=Ke(fe,`users/${e}/activity`);await it(r,Te(B({},t),{createdAt:be()}))}catch(r){console.warn("recordActivity failed",r)}}async submitFeedback(e,t){if(fe)try{let r=Ke(fe,"feedback");await it(r,{uid:e||null,text:t,createdAt:be()})}catch(r){console.warn("submitFeedback failed",r)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Vu({token:n,factory:n.\u0275fac,providedIn:"root"})};function zy(n,e){n&1&&(z(0,"small"),X(1,"Full name is required."),j())}function jy(n,e){n&1&&(z(0,"small"),X(1,"Full name must be at least 2 characters."),j())}function Gy(n,e){if(n&1&&(z(0,"div",33),_t(1,zy,2,0,"small",15)(2,jy,2,0,"small",15),j()),n&2){sn();let t=Je(4);ae(),xe("ngIf",t.errors==null?null:t.errors.required),ae(),xe("ngIf",t.errors==null?null:t.errors.minlength)}}function $y(n,e){if(n&1){let t=Os();Uu(0),z(1,"label",30),X(2,"Full Name"),j(),z(3,"input",31,3),Xr("ngModelChange",function(i){mt(t);let o=sn();return Yr(o.fullName,i)||(o.fullName=i),gt(i)}),j(),_t(5,Gy,3,2,"div",32),Bu()}if(n&2){let t=Je(4),r=sn();ae(3),Jr("ngModel",r.fullName),Xn("aria-invalid",t.invalid&&(t.dirty||t.touched))("aria-describedby",t.invalid&&(t.dirty||t.touched)?"fullName-error":null),ae(2),xe("ngIf",t.invalid&&(t.dirty||t.touched))}}function Wy(n,e){n&1&&(z(0,"small"),X(1,"Email is required."),j())}function Ky(n,e){n&1&&(z(0,"small"),X(1,"Please enter a valid email address."),j())}function Hy(n,e){if(n&1&&(z(0,"div",34),_t(1,Wy,2,0,"small",15)(2,Ky,2,0,"small",15),j()),n&2){sn();let t=Je(32);ae(),xe("ngIf",t.errors==null?null:t.errors.required),ae(),xe("ngIf",t.errors==null?null:t.errors.email)}}function Qy(n,e){n&1&&(z(0,"small"),X(1,"Password is required."),j())}function Jy(n,e){n&1&&(z(0,"small"),X(1,"Password must be at least 6 characters."),j())}function Yy(n,e){if(n&1&&(z(0,"div",34),_t(1,Qy,2,0,"small",15)(2,Jy,2,0,"small",15),j()),n&2){sn();let t=Je(35);ae(),xe("ngIf",t.errors==null?null:t.errors.required),ae(),xe("ngIf",t.errors==null?null:t.errors.minlength)}}var Sf=class n{constructor(e,t,r,i){this.router=e;this.validationService=t;this.firestoreService=r;this.notificationService=i}isLogin=!0;fullName="";email="";password="";toggleMode(e){this.isLogin=e==="login",this.isLogin&&(this.fullName="")}async onSubmit(e){if(e&&e.invalid){this.validationService.showAlert("Please fix the errors in the form before submitting.");return}if(!this.validationService.validateEmail(this.email)){this.validationService.showAlert("Please enter a valid email address.");return}if(!this.validationService.validatePassword(this.password)){this.validationService.showAlert("Password must be at least 6 characters long.");return}if(this.isLogin){let t=`profile_${this.email}`;if(!localStorage.getItem(t)){this.validationService.showAlert("No account found with this email. Please register first.");return}}if(!this.isLogin&&!this.validationService.validateRequired(this.fullName)){this.validationService.showAlert("Please enter your full name.");return}if(!this.isLogin&&!this.validationService.validateMaxLength(this.fullName,100)){this.validationService.showAlert("Full name is too long (max 100 characters).");return}try{if(this.isLogin){let o=`profile_${this.email}`,a=localStorage.getItem(o);if(a)try{let l=JSON.parse(a);if(l.password&&l.password!==this.password){this.validationService.showAlert("Invalid email or password.");return}}catch{}}else{let o=`profile_${this.email}`,a={fullName:this.fullName,email:this.email,password:this.password};localStorage.setItem(o,JSON.stringify(a))}let t=this.fullName;if(!t)try{let o=localStorage.getItem(`profile_${this.email}`);o&&(t=JSON.parse(o)?.fullName||"")}catch{t=""}t||(t=(this.email||"").split("@")[0]||"User");let r=`hasLoggedIn_${this.email}`,i=!!localStorage.getItem(r);if(i)sessionStorage.setItem("welcomeMessage",`Welcome back, ${t}!`);else{sessionStorage.setItem("welcomeMessage",`Welcome to our website, ${t}!`);try{localStorage.setItem(r,"true")}catch{}}try{localStorage.setItem("currentUser",JSON.stringify({fullName:t,email:this.email}))}catch{}try{let o=encodeURIComponent(this.email||"unknown");await this.firestoreService.createOrUpdateUser(o,{email:this.email,displayName:t,firstTime:!i})}catch{}}catch{}this.router.navigate(["/dashboard"])}async loginWithGoogle(){if(!Dc){this.validationService.showAlert("Google authentication is not available. Please use email and password.");return}try{let e=new Rc,r=(await Nc(Dc,e)).user,i=r.email||"",o=r.displayName||r.email?.split("@")[0]||"User";try{let a=`profile_${i}`;if(!localStorage.getItem(a)){let _={fullName:o,email:i,googleAuth:!0};localStorage.setItem(a,JSON.stringify(_))}let d=`hasLoggedIn_${i}`,f=!!localStorage.getItem(d);f?sessionStorage.setItem("welcomeMessage",`Welcome back, ${o}!`):(sessionStorage.setItem("welcomeMessage",`Welcome to our website, ${o}!`),localStorage.setItem(d,"true")),localStorage.setItem("currentUser",JSON.stringify({fullName:o,email:i}));try{let _=r.uid||encodeURIComponent(i);await this.firestoreService.createOrUpdateUser(_,{email:i,displayName:o,firstTime:!f})}catch(_){console.warn("Firestore update failed",_)}this.router.navigate(["/dashboard"])}catch(a){console.error("Error storing user data",a),this.notificationService.error("Login successful but failed to save user data. Please try again.")}}catch(e){if(console.error("Google login error",e),e.code==="auth/popup-closed-by-user")return;this.notificationService.error("Failed to login with Google. Please try again or use email and password.")}}static \u0275fac=function(t){return new(t||n)(Yn(ju),Yn(tl),Yn(us),Yn(nl))};static \u0275cmp=Fu({type:n,selectors:[["app-auth"]],decls:52,vars:16,consts:[["authForm","ngForm"],["emailRef","ngModel"],["passwordRef","ngModel"],["fullNameRef","ngModel"],[1,"container"],[1,"left"],[1,"title"],[1,"icon"],[1,"subtitle"],[1,"features"],[1,"right"],["role","tablist","aria-label","Authentication mode",1,"tabs"],["type","button","role","tab","id","login-tab",3,"click"],["type","button","role","tab","id","register-tab",3,"click"],[3,"ngSubmit"],[4,"ngIf"],["for","email",1,"sr-only"],["type","email","id","email","name","email","placeholder","Email","required","","email","","maxlength","254",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],["type","password","name","password","placeholder","Password","required","","minlength","6","maxlength","64",3,"ngModelChange","ngModel"],["type","submit",1,"main-btn",3,"disabled"],[1,"divider"],[1,"divider-line"],[1,"divider-text"],["type","button",1,"google-btn",3,"click"],["viewBox","0 0 24 24","width","20","height","20",1,"google-icon"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],["for","fullName",1,"sr-only"],["type","text","id","fullName","name","fullName","placeholder","Full Name","required","","minlength","2","maxlength","100","aria-required","true",3,"ngModelChange","ngModel"],["class","error","id","fullName-error","role","alert","aria-live","polite",4,"ngIf"],["id","fullName-error","role","alert","aria-live","polite",1,"error"],[1,"error"]],template:function(t,r){if(t&1){let i=Os();z(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7),X(4,"\u{1F393}"),j(),z(5,"h1"),X(6,"Career RoadMap"),j()(),z(7,"p",8),X(8," AI-powered personalized career roadmaps for CSE students. Chart your path from skills to success. "),j(),z(9,"ul",9)(10,"li"),X(11,"\u2728 AI-Generated Roadmaps"),j(),z(12,"li"),X(13,"\u{1F31F} Personalized Learning"),j(),z(14,"li"),X(15,"\u2B50 Progress Tracking"),j()()(),z(16,"div",10)(17,"h2"),X(18,"Get Started"),j(),z(19,"p"),X(20,"Sign in or create an account to begin your journey"),j(),z(21,"div",11)(22,"button",12),Zn("click",function(){return mt(i),gt(r.toggleMode("login"))}),X(23,"Login"),j(),z(24,"button",13),Zn("click",function(){return mt(i),gt(r.toggleMode("register"))}),X(25,"Register"),j()(),z(26,"form",14,0),Zn("ngSubmit",function(){mt(i);let a=Je(27);return gt(r.onSubmit(a))}),_t(28,$y,6,4,"ng-container",15),z(29,"label",16),X(30,"Email"),j(),z(31,"input",17,1),Xr("ngModelChange",function(a){return mt(i),Yr(r.email,a)||(r.email=a),gt(a)}),j(),_t(33,Hy,3,2,"div",18),z(34,"input",19,2),Xr("ngModelChange",function(a){return mt(i),Yr(r.password,a)||(r.password=a),gt(a)}),j(),_t(36,Yy,3,2,"div",18),z(37,"button",20),X(38),j()(),z(39,"div",21),Qr(40,"span",22),z(41,"span",23),X(42,"OR"),j(),Qr(43,"span",22),j(),z(44,"button",24),Zn("click",function(){return mt(i),gt(r.loginWithGoogle())}),Mu(),z(45,"svg",25),Qr(46,"path",26)(47,"path",27)(48,"path",28)(49,"path",29),j(),Lu(),z(50,"span"),X(51,"Login with Google"),j()()()()}if(t&2){let i=Je(27),o=Je(32),a=Je(35);ae(22),Vs("active",r.isLogin),Xn("aria-selected",r.isLogin)("aria-controls","login-panel"),ae(2),Vs("active",!r.isLogin),Xn("aria-selected",!r.isLogin)("aria-controls","register-panel"),ae(2),Xn("aria-label",r.isLogin?"Login form":"Registration form"),ae(2),xe("ngIf",!r.isLogin),ae(3),Jr("ngModel",r.email),ae(2),xe("ngIf",o.invalid&&(o.dirty||o.touched)),ae(),Jr("ngModel",r.password),ae(2),xe("ngIf",a.invalid&&(a.dirty||a.touched)),ae(),xe("disabled",i.invalid),ae(),qu(" ",r.isLogin?"Login":"Create Account"," ")}},dependencies:[zu,el,Qu,Gu,$u,Wu,Ju,Xu,Zu,Yu,Hu,Ku],styles:[".sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}button[_ngcontent-%COMP%]:focus-visible, input[_ngcontent-%COMP%]:focus-visible, select[_ngcontent-%COMP%]:focus-visible{outline:2px solid #2E6BFF;outline-offset:2px;border-radius:4px}button[_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%]{min-height:44px;min-width:44px}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;width:100%;margin:0;padding:0;overflow-x:hidden}app-root[_ngcontent-%COMP%]{display:block;height:100vh;width:100vw}[_nghost-%COMP%]{display:block;width:100vw;height:100vh;margin:0;padding:0;position:fixed;top:0;left:0}.container[_ngcontent-%COMP%]{display:flex;height:100vh;width:100vw;padding:56px 72px;margin:0;background:linear-gradient(135deg,#071b2e,#0e2a47);color:#fff;font-family:Poppins,sans-serif;box-sizing:border-box}.left[_ngcontent-%COMP%]{width:60%;padding-left:60px;display:flex;flex-direction:column;justify-content:center}.title[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:36px;margin-bottom:18px;font-weight:800;line-height:1.02}.icon[_ngcontent-%COMP%]{width:56px;height:56px;display:inline-flex;align-items:center;justify-content:center;background:#ffffff14;border-radius:12px;font-size:20px;margin-right:16px}.subtitle[_ngcontent-%COMP%]{font-size:16px;margin-bottom:28px;max-width:640px;line-height:1.6;color:#a9b7c9}.features[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.features[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 0;font-size:16px}.right[_ngcontent-%COMP%]{width:38%;max-width:520px;background:#0f2138;padding:36px 40px;border-radius:16px;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);display:flex;flex-direction:column;justify-content:center;margin-left:auto;box-shadow:0 12px 40px #0006;border:1px solid #162E4A;transition:all .3s cubic-bezier(.4,0,.2,1);will-change:transform,box-shadow}@media(hover:hover)and (pointer:fine){.right[_ngcontent-%COMP%]:hover{transform:translateY(-10px);box-shadow:0 20px 50px #2e6bff4d;border:3px solid rgba(46,107,255,.4)}}@media(max-width:900px){.right[_ngcontent-%COMP%]{transform:none!important;box-shadow:0 12px 30px #020c2b38}.right[_ngcontent-%COMP%]:hover{transform:none;box-shadow:0 12px 30px #020c2b38}}.right[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:30px;margin-bottom:5px;font-weight:600}.right[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:20px;color:#a9b7c9}.tabs[_ngcontent-%COMP%]{display:flex;margin:20px 0;gap:0;background:#ffffff1a;border-radius:8px;padding:4px}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:12px 0;background:transparent;border:none;font-size:18px;color:#fff;cursor:pointer;border-radius:6px;transition:all .3s cubic-bezier(.4,0,.2,1)}@media(hover:hover)and (pointer:fine){.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.active){background:#2e6bff1a;border:2px solid rgba(46,107,255,.3)}}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#2e6bff;color:#fff;font-weight:600}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:18px}input[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:1px solid #2A4B7C;border-radius:8px;margin-bottom:14px;font-size:15px;outline:none;background:#162b45;color:#dce6f2;box-sizing:border-box}input[_ngcontent-%COMP%]::placeholder{color:#a9b7c9}.main-btn[_ngcontent-%COMP%]{width:100%;padding:14px 28px;background:#2e6bff;color:#fff;border:none;border-radius:10px;font-size:16px;cursor:pointer;font-weight:600;margin-top:8px;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center;gap:10px;font-family:Poppins,sans-serif;box-shadow:0 4px 12px #2e6bff59;white-space:nowrap}.main-btn[_ngcontent-%COMP%]:hover{background:#2558d8;box-shadow:0 6px 18px #2e6bff73;transform:translateY(-2px)}.main-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #2e6bff4d}.main-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.main-btn[_ngcontent-%COMP%]:disabled:hover{transform:none;box-shadow:0 4px 12px #2e6bff59}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0;width:100%}.divider-line[_ngcontent-%COMP%]{flex:1;height:1px;background:#ffffff4d}.divider-text[_ngcontent-%COMP%]{padding:0 12px;color:#ffffffb3;font-size:14px;font-weight:500}.google-btn[_ngcontent-%COMP%]{width:100%;padding:12px 14px;background:#fff;color:#1f2937;border:1px solid rgba(255,255,255,.2);border-radius:10px;font-size:16px;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:10px;transition:transform .18s ease,box-shadow .18s ease,background .18s ease;box-shadow:0 2px 8px #0000001a}.google-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026;background:#f9fafb}.google-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #0000001a}.google-icon[_ngcontent-%COMP%]{flex-shrink:0}"]})};export{Sf as AuthComponent};
