"use strict";(self.webpackChunkRoadMap=self.webpackChunkRoadMap||[]).push([[630],{1630(YS,CT,Rt){Rt.d(CT,{AuthComponent:()=>IS});var y=Rt(467),xT=Rt(9769),ut=Rt(4341);const Ef=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},Af={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,c=o?r[i+1]:0,u=i+2<r.length,l=u?r[i+2]:0;let g=(15&c)<<2|l>>6,A=63&l;u||(A=64,o||(g=64)),n.push(t[s>>2],t[(3&s)<<4|c>>4],t[g],t[A])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Ef(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const u=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(1023&u))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],c=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const p=i<r.length?t[r.charAt(i)]:64;if(++i,null==s||null==c||null==l||null==p)throw new OT;n.push(s<<2|c>>4),64!==l&&(n.push(c<<4&240|l>>2),64!==p&&n.push(l<<6&192|p))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class OT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fs=function(r){return function(r){const e=Ef(r);return Af.encodeByteArray(e,!0)}(r).replace(/\./g,"")},ui=function(r){try{return Af.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const Us=()=>{try{return function wf(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&ui(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},bf=r=>Us()?.emulatorHosts?.[r],Rf=()=>Us()?.config,Pf=r=>Us()?.[`_${r}`];class Sf{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function lr(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}function Cf(r){return Ma.apply(this,arguments)}function Ma(){return(Ma=(0,y.A)(function*(r){return(yield fetch(r,{credentials:"include"})).ok})).apply(this,arguments)}const li={};let xf=!1;function kf(r,e){if(typeof window>"u"||typeof document>"u"||!lr(window.location.host)||li[r]===e||li[r]||xf)return;function t(g){return`__firebase__banner__${g}`}li[r]=e;const n="__firebase__banner",s=function jT(){const r={prod:[],emulator:[]};for(const e of Object.keys(li))li[e]?r.emulator.push(e):r.prod.push(e);return r}().prod.length>0;function p(){const g=function zT(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}(n),A=t("text"),k=document.getElementById(A)||document.createElement("span"),D=t("learnmore"),N=document.getElementById(D)||document.createElement("a"),B=t("preprendIcon"),$=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const j=g.element;(function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"})(j),function d(g,A){g.setAttribute("id",A),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}(N,D);const J=function l(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{xf=!0,function o(){const g=document.getElementById(n);g&&g.remove()}()},g}();(function u(g,A){g.setAttribute("width","24"),g.setAttribute("id",A),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"})($,B),j.append($,k,N,J),document.body.appendChild(j)}s?(k.innerText="Preview backend disconnected.",$.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):($.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',k.innerText="Preview backend running in this workspace."),k.setAttribute("id",A)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p()}function Te(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Nf(){return!function Vf(){const r=Us()?.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class Pt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Pt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hi.prototype.create)}}class hi{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function ZT(r,e){return r.replace(eE,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(s,n):"Error";return new Pt(i,`${this.serviceName}: ${o} (${i}).`,n)}}const eE=/\{\$([^}]+)}/g;function St(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(Lf(s)&&Lf(o)){if(!St(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Lf(r){return null!==r&&"object"==typeof r}function di(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}class rE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function iE(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=La),void 0===i.error&&(i.error=La),void 0===i.complete&&(i.complete=La);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function La(){}function Ce(r){return r&&r._delegate?r._delegate:r}class bn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Rn="[DEFAULT]";class lE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Sf;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function dE(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Rn})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Rn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return(0,y.A)(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=Rn){return this.instances.has(e)}getOptions(e=Rn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Rn?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=Rn){return this.component?this.component.multipleInstances?e:Rn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class fE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Ua=[];var X=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(X||{});const Ff={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},pE=X.INFO,mE={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},gE=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=mE[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class Ba{constructor(e){this.name=e,this._logLevel=pE,this._logHandler=gE,this._userLogHandler=null,Ua.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Ff[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}}let Uf,Bf;const Gf=new WeakMap,Ga=new WeakMap,qf=new WeakMap,qa=new WeakMap,ja=new WeakMap;let za={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return Ga.get(r);if("objectStoreNames"===e)return r.objectStoreNames||qf.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $t(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function wE(r){return"function"==typeof r?function vE(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function IE(){return Bf||(Bf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply($a(this),e),$t(Gf.get(this))}:function(...e){return $t(r.apply($a(this),e))}:function(e,...t){const n=r.call($a(this),e,...t);return qf.set(n,e.sort?e.sort():[e]),$t(n)}}(r):(r instanceof IDBTransaction&&function EE(r){if(Ga.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});Ga.set(r,e)}(r),((r,e)=>e.some(t=>r instanceof t))(r,function yE(){return Uf||(Uf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,za):r)}function $t(r){if(r instanceof IDBRequest)return function TE(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t($t(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Gf.set(t,r)}).catch(()=>{}),ja.set(e,r),e}(r);if(qa.has(r))return qa.get(r);const e=wE(r);return e!==r&&(qa.set(r,e),ja.set(e,r)),e}const $a=r=>ja.get(r),RE=["get","getKey","getAll","getAllKeys","count"],PE=["put","add","delete","clear"],Wa=new Map;function jf(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(Wa.get(e))return Wa.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=PE.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!RE.includes(t))return;const s=function(){var o=(0,y.A)(function*(c,...u){const l=this.transaction(c,i?"readwrite":"readonly");let d=l.store;return n&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&l.done]))[0]});return function(u){return o.apply(this,arguments)}}();return Wa.set(e,s),s}!function AE(r){za=r(za)}(r=>({...r,get:(e,t,n)=>jf(e,t)||r.get(e,t,n),has:(e,t)=>!!jf(e,t)||r.has(e,t)}));class SE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function CE(r){return"VERSION"===r.getComponent()?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const Gs="@firebase/app",Ct=new Ba("@firebase/app"),xE="@firebase/app-compat",kE="@firebase/analytics-compat",VE="@firebase/analytics",NE="@firebase/app-check-compat",DE="@firebase/app-check",OE="@firebase/auth",ME="@firebase/auth-compat",LE="@firebase/database",FE="@firebase/data-connect",UE="@firebase/database-compat",BE="@firebase/functions",GE="@firebase/functions-compat",qE="@firebase/installations",jE="@firebase/installations-compat",zE="@firebase/messaging",$E="@firebase/messaging-compat",WE="@firebase/performance",KE="@firebase/performance-compat",HE="@firebase/remote-config",QE="@firebase/remote-config-compat",JE="@firebase/storage",YE="@firebase/storage-compat",XE="@firebase/firestore",ZE="@firebase/ai",eA="@firebase/firestore-compat",tA="firebase",qs="[DEFAULT]",rA={[Gs]:"fire-core",[xE]:"fire-core-compat",[VE]:"fire-analytics",[kE]:"fire-analytics-compat",[DE]:"fire-app-check",[NE]:"fire-app-check-compat",[OE]:"fire-auth",[ME]:"fire-auth-compat",[LE]:"fire-rtdb",[FE]:"fire-data-connect",[UE]:"fire-rtdb-compat",[BE]:"fire-fn",[GE]:"fire-fn-compat",[qE]:"fire-iid",[jE]:"fire-iid-compat",[zE]:"fire-fcm",[$E]:"fire-fcm-compat",[WE]:"fire-perf",[KE]:"fire-perf-compat",[HE]:"fire-rc",[QE]:"fire-rc-compat",[JE]:"fire-gcs",[YE]:"fire-gcs-compat",[XE]:"fire-fst",[eA]:"fire-fst-compat",[ZE]:"fire-vertex","fire-js":"fire-js",[tA]:"fire-js-all"},Pn=new Map,fi=new Map,pi=new Map;function zf(r,e){try{r.container.addComponent(e)}catch(t){Ct.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function hr(r){const e=r.name;if(pi.has(e))return Ct.debug(`There were multiple attempts to register component ${e}.`),!1;pi.set(e,r);for(const t of Pn.values())zf(t,r);for(const t of fi.values())zf(t,r);return!0}function js(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function lt(r){return null!=r&&void 0!==r.settings}const Xe=new hi("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Wf{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xe.create("app-deleted",{appName:this._name})}}const dr="12.6.0";function Hf(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n={name:qs,automaticDataCollectionEnabled:!0,...e},i=n.name;if("string"!=typeof i||!i)throw Xe.create("bad-app-name",{appName:String(i)});if(t||(t=Rf()),!t)throw Xe.create("no-options");const s=Pn.get(i);if(s){if(St(t,s.options)&&St(n,s.config))return s;throw Xe.create("duplicate-app",{appName:i})}const o=new fE(i);for(const u of pi.values())o.addComponent(u);const c=new Wf(t,n,o);return Pn.set(i,c),c}function Ha(r=qs){const e=Pn.get(r);if(!e&&r===qs&&Rf())return Hf();if(!e)throw Xe.create("no-app",{appName:r});return e}function xt(r,e,t){let n=rA[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${n}" with version "${e}":`];return i&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Ct.warn(o.join(" "))}hr(new bn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const mi="firebase-heartbeat-store";let Ja=null;function Qf(){return Ja||(Ja=function bE(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),c=$t(o);return n&&o.addEventListener("upgradeneeded",u=>{n($t(o.result),u.oldVersion,u.newVersion,$t(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}("firebase-heartbeat-database",1,{upgrade:(r,e)=>{if(0===e)try{r.createObjectStore(mi)}catch(t){console.warn(t)}}}).catch(r=>{throw Xe.create("idb-open",{originalErrorMessage:r.message})})),Ja}function Ya(){return(Ya=(0,y.A)(function*(r){try{const t=(yield Qf()).transaction(mi),n=yield t.objectStore(mi).get(Yf(r));return yield t.done,n}catch(e){if(e instanceof Pt)Ct.warn(e.message);else{const t=Xe.create("idb-get",{originalErrorMessage:e?.message});Ct.warn(t.message)}}})).apply(this,arguments)}function Jf(r,e){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,y.A)(function*(r,e){try{const n=(yield Qf()).transaction(mi,"readwrite");yield n.objectStore(mi).put(e,Yf(r)),yield n.done}catch(t){if(t instanceof Pt)Ct.warn(t.message);else{const n=Xe.create("idb-set",{originalErrorMessage:t?.message});Ct.warn(n.message)}}})).apply(this,arguments)}function Yf(r){return`${r.name}!${r.options.appId}`}class pA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gA(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return(0,y.A)(function*(){try{const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Xf();if(null==e._heartbeatsCache?.heartbeats&&(e._heartbeatsCache=yield e._heartbeatsCachePromise,null==e._heartbeatsCache?.heartbeats)||e._heartbeatsCache.lastSentHeartbeatDate===i||e._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats.length>30){const s=function _A(r){if(0===r.length)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}(e._heartbeatsCache.heartbeats);e._heartbeatsCache.heartbeats.splice(s,1)}return e._storage.overwrite(e._heartbeatsCache)}catch(t){Ct.warn(t)}})()}getHeartbeatsHeader(){var e=this;return(0,y.A)(function*(){try{if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==e._heartbeatsCache?.heartbeats||0===e._heartbeatsCache.heartbeats.length)return"";const t=Xf(),{heartbeatsToSend:n,unsentEntries:i}=function mA(r,e=1024){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Zf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Zf(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=Fs(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s}catch(t){return Ct.warn(t),""}})()}}function Xf(){return(new Date).toISOString().substring(0,10)}class gA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,y.A)(function*(){return!!function Of(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function YT(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return(0,y.A)(function*(){if(yield e._canUseIndexedDBPromise){const n=yield function hA(r){return Ya.apply(this,arguments)}(e.app);return n?.heartbeats?n:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var t=this;return(0,y.A)(function*(){if(yield t._canUseIndexedDBPromise){const i=yield t.read();return Jf(t.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return(0,y.A)(function*(){if(yield t._canUseIndexedDBPromise){const i=yield t.read();return Jf(t.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}})()}}function Zf(r){return Fs(JSON.stringify({version:2,heartbeats:r})).length}!function yA(r){hr(new bn("platform-logger",e=>new SE(e),"PRIVATE")),hr(new bn("heartbeat",e=>new pA(e),"PRIVATE")),xt(Gs,"0.14.6",r),xt(Gs,"0.14.6","esm2020"),xt("fire-js","")}(""),xt("firebase","12.7.0","app");var Wt,ep=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tp={};(function(){var r;function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function i(E,_,T){T||(T=0);const w=Array(16);if("string"==typeof _)for(var v=0;v<16;++v)w[v]=_.charCodeAt(T++)|_.charCodeAt(T++)<<8|_.charCodeAt(T++)<<16|_.charCodeAt(T++)<<24;else for(v=0;v<16;++v)w[v]=_[T++]|_[T++]<<8|_[T++]<<16|_[T++]<<24;let I,C=E.g[3];I=(_=E.g[0])+(C^(T=E.g[1])&((v=E.g[2])^C))+w[0]+3614090360&4294967295,I=C+(v^(_=T+(I<<7&4294967295|I>>>25))&(T^v))+w[1]+3905402710&4294967295,C=_+(I<<12&4294967295|I>>>20),I=v+(T^C&(_^T))+w[2]+606105819&4294967295,I=T+(_^(v=C+(I<<17&4294967295|I>>>15))&(C^_))+w[3]+3250441966&4294967295,I=_+(C^(T=v+(I<<22&4294967295|I>>>10))&(v^C))+w[4]+4118548399&4294967295,I=C+(v^(_=T+(I<<7&4294967295|I>>>25))&(T^v))+w[5]+1200080426&4294967295,C=_+(I<<12&4294967295|I>>>20),I=v+(T^C&(_^T))+w[6]+2821735955&4294967295,I=T+(_^(v=C+(I<<17&4294967295|I>>>15))&(C^_))+w[7]+4249261313&4294967295,I=_+(C^(T=v+(I<<22&4294967295|I>>>10))&(v^C))+w[8]+1770035416&4294967295,I=C+(v^(_=T+(I<<7&4294967295|I>>>25))&(T^v))+w[9]+2336552879&4294967295,C=_+(I<<12&4294967295|I>>>20),I=v+(T^C&(_^T))+w[10]+4294925233&4294967295,I=T+(_^(v=C+(I<<17&4294967295|I>>>15))&(C^_))+w[11]+2304563134&4294967295,I=_+(C^(T=v+(I<<22&4294967295|I>>>10))&(v^C))+w[12]+1804603682&4294967295,I=C+(v^(_=T+(I<<7&4294967295|I>>>25))&(T^v))+w[13]+4254626195&4294967295,C=_+(I<<12&4294967295|I>>>20),I=v+(T^C&(_^T))+w[14]+2792965006&4294967295,I=T+(_^(v=C+(I<<17&4294967295|I>>>15))&(C^_))+w[15]+1236535329&4294967295,I=_+(v^C&((T=v+(I<<22&4294967295|I>>>10))^v))+w[1]+4129170786&4294967295,I=C+(T^v&((_=T+(I<<5&4294967295|I>>>27))^T))+w[6]+3225465664&4294967295,C=_+(I<<9&4294967295|I>>>23),I=v+(_^T&(C^_))+w[11]+643717713&4294967295,I=T+(C^_&((v=C+(I<<14&4294967295|I>>>18))^C))+w[0]+3921069994&4294967295,I=_+(v^C&((T=v+(I<<20&4294967295|I>>>12))^v))+w[5]+3593408605&4294967295,I=C+(T^v&((_=T+(I<<5&4294967295|I>>>27))^T))+w[10]+38016083&4294967295,C=_+(I<<9&4294967295|I>>>23),I=v+(_^T&(C^_))+w[15]+3634488961&4294967295,I=T+(C^_&((v=C+(I<<14&4294967295|I>>>18))^C))+w[4]+3889429448&4294967295,I=_+(v^C&((T=v+(I<<20&4294967295|I>>>12))^v))+w[9]+568446438&4294967295,I=C+(T^v&((_=T+(I<<5&4294967295|I>>>27))^T))+w[14]+3275163606&4294967295,C=_+(I<<9&4294967295|I>>>23),I=v+(_^T&(C^_))+w[3]+4107603335&4294967295,I=T+(C^_&((v=C+(I<<14&4294967295|I>>>18))^C))+w[8]+1163531501&4294967295,I=_+(v^C&((T=v+(I<<20&4294967295|I>>>12))^v))+w[13]+2850285829&4294967295,I=C+(T^v&((_=T+(I<<5&4294967295|I>>>27))^T))+w[2]+4243563512&4294967295,C=_+(I<<9&4294967295|I>>>23),I=v+(_^T&(C^_))+w[7]+1735328473&4294967295,I=T+(C^_&((v=C+(I<<14&4294967295|I>>>18))^C))+w[12]+2368359562&4294967295,I=_+((T=v+(I<<20&4294967295|I>>>12))^v^C)+w[5]+4294588738&4294967295,I=C+((_=T+(I<<4&4294967295|I>>>28))^T^v)+w[8]+2272392833&4294967295,C=_+(I<<11&4294967295|I>>>21),I=v+(C^_^T)+w[11]+1839030562&4294967295,I=T+((v=C+(I<<16&4294967295|I>>>16))^C^_)+w[14]+4259657740&4294967295,I=_+((T=v+(I<<23&4294967295|I>>>9))^v^C)+w[1]+2763975236&4294967295,I=C+((_=T+(I<<4&4294967295|I>>>28))^T^v)+w[4]+1272893353&4294967295,C=_+(I<<11&4294967295|I>>>21),I=v+(C^_^T)+w[7]+4139469664&4294967295,I=T+((v=C+(I<<16&4294967295|I>>>16))^C^_)+w[10]+3200236656&4294967295,I=_+((T=v+(I<<23&4294967295|I>>>9))^v^C)+w[13]+681279174&4294967295,I=C+((_=T+(I<<4&4294967295|I>>>28))^T^v)+w[0]+3936430074&4294967295,C=_+(I<<11&4294967295|I>>>21),I=v+(C^_^T)+w[3]+3572445317&4294967295,I=T+((v=C+(I<<16&4294967295|I>>>16))^C^_)+w[6]+76029189&4294967295,I=_+((T=v+(I<<23&4294967295|I>>>9))^v^C)+w[9]+3654602809&4294967295,I=C+((_=T+(I<<4&4294967295|I>>>28))^T^v)+w[12]+3873151461&4294967295,C=_+(I<<11&4294967295|I>>>21),I=v+(C^_^T)+w[15]+530742520&4294967295,I=T+((v=C+(I<<16&4294967295|I>>>16))^C^_)+w[2]+3299628645&4294967295,I=_+(v^((T=v+(I<<23&4294967295|I>>>9))|~C))+w[0]+4096336452&4294967295,I=C+(T^((_=T+(I<<6&4294967295|I>>>26))|~v))+w[7]+1126891415&4294967295,C=_+(I<<10&4294967295|I>>>22),I=v+(_^(C|~T))+w[14]+2878612391&4294967295,I=T+(C^((v=C+(I<<15&4294967295|I>>>17))|~_))+w[5]+4237533241&4294967295,I=_+(v^((T=v+(I<<21&4294967295|I>>>11))|~C))+w[12]+1700485571&4294967295,I=C+(T^((_=T+(I<<6&4294967295|I>>>26))|~v))+w[3]+2399980690&4294967295,C=_+(I<<10&4294967295|I>>>22),I=v+(_^(C|~T))+w[10]+4293915773&4294967295,I=T+(C^((v=C+(I<<15&4294967295|I>>>17))|~_))+w[1]+2240044497&4294967295,I=_+(v^((T=v+(I<<21&4294967295|I>>>11))|~C))+w[8]+1873313359&4294967295,I=C+(T^((_=T+(I<<6&4294967295|I>>>26))|~v))+w[15]+4264355552&4294967295,C=_+(I<<10&4294967295|I>>>22),I=v+(_^(C|~T))+w[6]+2734768916&4294967295,I=T+(C^((v=C+(I<<15&4294967295|I>>>17))|~_))+w[13]+1309151649&4294967295,I=_+(v^((T=v+(I<<21&4294967295|I>>>11))|~C))+w[4]+4149444226&4294967295,I=C+(T^((_=T+(I<<6&4294967295|I>>>26))|~v))+w[11]+3174756917&4294967295,C=_+(I<<10&4294967295|I>>>22),I=v+(_^(C|~T))+w[2]+718787259&4294967295,I=T+(C^((v=C+(I<<15&4294967295|I>>>17))|~_))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(v+(I<<21&4294967295|I>>>11))&4294967295,E.g[2]=E.g[2]+v&4294967295,E.g[3]=E.g[3]+C&4294967295}function o(E,_){this.h=_;const T=[];let w=!0;for(let v=E.length-1;v>=0;v--){const C=0|E[v];w&&C==_||(T[v]=C,w=!1)}this.g=T}(function e(E,_){function T(){}T.prototype=_.prototype,E.F=_.prototype,E.prototype=new T,E.prototype.constructor=E,E.D=function(w,v,C){for(var I=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)I[Ye-2]=arguments[Ye];return _.prototype[v].apply(w,I)}})(n,function t(){this.blockSize=-1}),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},n.prototype.v=function(E,_){void 0===_&&(_=E.length);const T=_-this.blockSize,w=this.C;let v=this.h,C=0;for(;C<_;){if(0==v)for(;C<=T;)i(this,E,C),C+=this.blockSize;if("string"==typeof E){for(;C<_;)if(w[v++]=E.charCodeAt(C++),v==this.blockSize){i(this,w),v=0;break}}else for(;C<_;)if(w[v++]=E[C++],v==this.blockSize){i(this,w),v=0;break}}this.h=v,this.o+=_},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;_=8*this.o;for(var T=E.length-8;T<E.length;++T)E[T]=255&_,_/=256;for(this.v(E),E=Array(16),_=0,T=0;T<4;++T)for(let w=0;w<32;w+=8)E[_++]=this.g[T]>>>w&255;return E};var c={};function u(E){return-128<=E&&E<128?function s(E,_){var T=c;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=_(E)}(E,function(_){return new o([0|_],_<0?-1:0)}):new o([0|E],E<0?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(E<0)return N(l(-E));const _=[];let T=1;for(let w=0;E>=T;w++)_[w]=E/T|0,T*=4294967296;return new o(_,0)}var p=u(0),g=u(1),A=u(16777216);function k(E){if(0!=E.h)return!1;for(let _=0;_<E.g.length;_++)if(0!=E.g[_])return!1;return!0}function D(E){return-1==E.h}function N(E){const _=E.g.length,T=[];for(let w=0;w<_;w++)T[w]=~E.g[w];return new o(T,~E.h).add(g)}function B(E,_){return E.add(N(_))}function $(E,_){for(;(65535&E[_])!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function j(E,_){this.g=E,this.h=_}function J(E,_){if(k(_))throw Error("division by zero");if(k(E))return new j(p,p);if(D(E))return _=J(N(E),_),new j(N(_.g),N(_.h));if(D(_))return _=J(E,N(_)),new j(N(_.g),_.h);if(E.g.length>30){if(D(E)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var T=g,w=_;w.l(E)<=0;)T=te(T),w=te(w);var v=ne(T,1),C=ne(w,1);for(w=ne(w,2),T=ne(T,2);!k(w);){var I=C.add(w);I.l(E)<=0&&(v=v.add(T),C=I),w=ne(w,1),T=ne(T,1)}return _=B(E,v.j(_)),new j(v,_)}for(v=p;E.l(_)>=0;){for(T=Math.max(1,Math.floor(E.m()/_.m())),w=(w=Math.ceil(Math.log(T)/Math.LN2))<=48?1:Math.pow(2,w-48),I=(C=l(T)).j(_);D(I)||I.l(E)>0;)I=(C=l(T-=w)).j(_);k(C)&&(C=g),v=v.add(C),E=B(E,I)}return new j(v,E)}function te(E){const _=E.g.length+1,T=[];for(let w=0;w<_;w++)T[w]=E.i(w)<<1|E.i(w-1)>>>31;return new o(T,E.h)}function ne(E,_){const T=_>>5;_%=32;const w=E.g.length-T,v=[];for(let C=0;C<w;C++)v[C]=_>0?E.i(C+T)>>>_|E.i(C+T+1)<<32-_:E.i(C+T);return new o(v,E.h)}(r=o.prototype).m=function(){if(D(this))return-N(this).m();let E=0,_=1;for(let T=0;T<this.g.length;T++){const w=this.i(T);E+=(w>=0?w:4294967296+w)*_,_*=4294967296}return E},r.toString=function(E){if((E=E||10)<2||36<E)throw Error("radix out of range: "+E);if(k(this))return"0";if(D(this))return"-"+N(this).toString(E);const _=l(Math.pow(E,6));var T=this;let w="";for(;;){const v=J(T,_).g;let C=(((T=B(T,v.j(_))).g.length>0?T.g[0]:T.h)>>>0).toString(E);if(k(T=v))return C+w;for(;C.length<6;)C="0"+C;w=C+w}},r.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h},r.l=function(E){return D(E=B(this,E))?-1:k(E)?0:1},r.abs=function(){return D(this)?N(this):this},r.add=function(E){const _=Math.max(this.g.length,E.g.length),T=[];let w=0;for(let v=0;v<=_;v++){let C=w+(65535&this.i(v))+(65535&E.i(v)),I=(C>>>16)+(this.i(v)>>>16)+(E.i(v)>>>16);w=I>>>16,C&=65535,I&=65535,T[v]=I<<16|C}return new o(T,-2147483648&T[T.length-1]?-1:0)},r.j=function(E){if(k(this)||k(E))return p;if(D(this))return D(E)?N(this).j(N(E)):N(N(this).j(E));if(D(E))return N(this.j(N(E)));if(this.l(A)<0&&E.l(A)<0)return l(this.m()*E.m());const _=this.g.length+E.g.length,T=[];for(var w=0;w<2*_;w++)T[w]=0;for(w=0;w<this.g.length;w++)for(let v=0;v<E.g.length;v++){const C=this.i(w)>>>16,I=65535&this.i(w),Ye=E.i(v)>>>16,yn=65535&E.i(v);T[2*w+2*v]+=I*yn,$(T,2*w+2*v),T[2*w+2*v+1]+=C*yn,$(T,2*w+2*v+1),T[2*w+2*v+1]+=I*Ye,$(T,2*w+2*v+1),T[2*w+2*v+2]+=C*Ye,$(T,2*w+2*v+2)}for(E=0;E<_;E++)T[E]=T[2*E+1]<<16|T[2*E];for(E=_;E<2*_;E++)T[E]=0;return new o(T,0)},r.B=function(E){return J(this,E).h},r.and=function(E){const _=Math.max(this.g.length,E.g.length),T=[];for(let w=0;w<_;w++)T[w]=this.i(w)&E.i(w);return new o(T,this.h&E.h)},r.or=function(E){const _=Math.max(this.g.length,E.g.length),T=[];for(let w=0;w<_;w++)T[w]=this.i(w)|E.i(w);return new o(T,this.h|E.h)},r.xor=function(E){const _=Math.max(this.g.length,E.g.length),T=[];for(let w=0;w<_;w++)T[w]=this.i(w)^E.i(w);return new o(T,this.h^E.h)},n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,tp.Md5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=function d(E,_){if(0==E.length)throw Error("number format error: empty string");if((_=_||10)<2||36<_)throw Error("radix out of range: "+_);if("-"==E.charAt(0))return N(d(E.substring(1),_));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=l(Math.pow(_,8));let w=p;for(let C=0;C<E.length;C+=8){var v=Math.min(8,E.length-C);const I=parseInt(E.substring(C,C+v),_);v<8?(v=l(Math.pow(_,v)),w=w.j(v).add(l(I))):(w=w.j(T),w=w.add(l(I)))}return w},Wt=tp.Integer=o}).apply(typeof ep<"u"?ep:typeof self<"u"?self:typeof window<"u"?window:{});var rp,gi,ip,$s,Za,sp,op,ap,zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kt={};(function(){var r,e=Object.defineProperty,n=function t(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof zs&&zs];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}(this);function i(a,h){if(h)e:{var f=n;a=a.split(".");for(var m=0;m<a.length-1;m++){var R=a[m];if(!(R in f))break e;f=f[R]}(h=h(m=f[a=a[a.length-1]]))!=m&&null!=h&&e(f,a,{configurable:!0,writable:!0,value:h})}}i("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(a){return a||function(h){var m,f=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&f.push([m,h[m]]);return f}});var s=s||{},o=this||self;function c(a){var h=typeof a;return"object"==h&&null!=a||"function"==h}function u(a,h,f){return a.call.apply(a.bind,arguments)}function l(a,h,f){return(l=u).apply(null,arguments)}function d(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var m=f.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function p(a,h){function f(){}f.prototype=h.prototype,a.Z=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Ob=function(m,R,x){for(var U=Array(arguments.length-2),H=2;H<arguments.length;H++)U[H-2]=arguments[H];return h.prototype[R].apply(m,U)}}var g=typeof AsyncContext<"u"&&"function"==typeof AsyncContext.Snapshot?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function A(a){const h=a.length;if(h>0){const f=Array(h);for(let m=0;m<h;m++)f[m]=a[m];return f}return[]}function k(a,h){for(let m=1;m<arguments.length;m++){const R=arguments[m];var f=typeof R;if("array"==(f="object"!=f?f:R?Array.isArray(R)?"array":f:"null")||"object"==f&&"number"==typeof R.length){const x=R.length||0;a.length=(f=a.length||0)+x;for(let U=0;U<x;U++)a[f+U]=R[U]}else a.push(R)}}function N(a){o.setTimeout(()=>{throw a},0)}function B(){var a=E;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}var j=new class D{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}(()=>new J,a=>a.reset());class J{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let te,ne=!1,E=new class ${constructor(){this.h=this.g=null}add(h,f){const m=j.get();m.set(h,f),this.h?this.h.next=m:this.g=m,this.h=m}},_=()=>{const a=Promise.resolve(void 0);te=()=>{a.then(T)}};function T(){for(var a;a=B();){try{a.h.call(a.g)}catch(f){N(f)}var h=j;h.j(a),h.h<100&&(h.h++,a.next=h.g,h.g=a)}ne=!1}function w(){this.u=this.u,this.C=this.C}function v(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},v.prototype.h=function(){this.defaultPrevented=!0};var C=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};o.addEventListener("test",f,h),o.removeEventListener("test",f,h)}catch{}return a}();function I(a){return/^[\s\xa0]*$/.test(a)}function Ye(a,h){v.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,h)}p(Ye,v),Ye.prototype.init=function(a,h){const f=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=h,(h=a.relatedTarget)||("mouseover"==f?h=a.fromElement:"mouseout"==f&&(h=a.toElement)),this.relatedTarget=h,m?(this.clientX=void 0!==m.clientX?m.clientX:m.pageX,this.clientY=void 0!==m.clientY?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&Ye.Z.h.call(this)},Ye.prototype.h=function(){Ye.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var yn="closure_listenable_"+(1e6*Math.random()|0),TS=0;function ES(a,h,f,m,R){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!m,this.ha=R,this.key=++TS,this.da=this.fa=!1}function Ia(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ta(a,h,f){for(const m in a)h.call(f,a[m],m,a)}function PI(a){const h={};for(const f in a)h[f]=a[f];return h}const SI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function CI(a,h){let f,m;for(let R=1;R<arguments.length;R++){for(f in m=arguments[R],m)a[f]=m[f];for(let x=0;x<SI.length;x++)f=SI[x],Object.prototype.hasOwnProperty.call(m,f)&&(a[f]=m[f])}}function Ea(a){this.src=a,this.g={},this.h=0}function Jd(a,h){const f=h.type;if(f in a.g){var x,m=a.g[f],R=Array.prototype.indexOf.call(m,h,void 0);(x=R>=0)&&Array.prototype.splice.call(m,R,1),x&&(Ia(h),0==a.g[f].length&&(delete a.g[f],a.h--))}}function Yd(a,h,f,m){for(let R=0;R<a.length;++R){const x=a[R];if(!x.da&&x.listener==h&&x.capture==!!f&&x.ha==m)return R}return-1}Ea.prototype.add=function(a,h,f,m,R){const x=a.toString();(a=this.g[x])||(a=this.g[x]=[],this.h++);const U=Yd(a,h,m,R);return U>-1?(h=a[U],f||(h.fa=!1)):((h=new ES(h,this.src,x,!!m,R)).fa=f,a.push(h)),h};var Xd="closure_lm_"+(1e6*Math.random()|0),Zd={};function xI(a,h,f,m,R){if(m&&m.once)return VI(a,h,f,m,R);if(Array.isArray(h)){for(let x=0;x<h.length;x++)xI(a,h[x],f,m,R);return null}return f=rf(f),a&&a[yn]?a.J(h,f,c(m)?!!m.capture:!!m,R):kI(a,h,f,!1,m,R)}function kI(a,h,f,m,R,x){if(!h)throw Error("Invalid event type");const U=c(R)?!!R.capture:!!R;let H=tf(a);if(H||(a[Xd]=H=new Ea(a)),(f=H.add(h,f,m,U,x)).proxy)return f;if(m=function vS(){const h=wS;return function a(f){return h.call(a.src,a.listener,f)}}(),f.proxy=m,m.src=a,m.listener=f,a.addEventListener)C||(R=U),void 0===R&&(R=!1),a.addEventListener(h.toString(),m,R);else if(a.attachEvent)a.attachEvent(DI(h.toString()),m);else{if(!a.addListener||!a.removeListener)throw Error("addEventListener and attachEvent are unavailable.");a.addListener(m)}return f}function VI(a,h,f,m,R){if(Array.isArray(h)){for(let x=0;x<h.length;x++)VI(a,h[x],f,m,R);return null}return f=rf(f),a&&a[yn]?a.K(h,f,c(m)?!!m.capture:!!m,R):kI(a,h,f,!0,m,R)}function NI(a,h,f,m,R){if(Array.isArray(h))for(var x=0;x<h.length;x++)NI(a,h[x],f,m,R);else m=c(m)?!!m.capture:!!m,f=rf(f),a&&a[yn]?(a=a.i,(x=String(h).toString())in a.g&&(f=Yd(h=a.g[x],f,m,R))>-1&&(Ia(h[f]),Array.prototype.splice.call(h,f,1),0==h.length&&(delete a.g[x],a.h--))):a&&(a=tf(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Yd(h,f,m,R)),(f=a>-1?h[a]:null)&&ef(f))}function ef(a){if("number"!=typeof a&&a&&!a.da){var h=a.src;if(h&&h[yn])Jd(h.i,a);else{var f=a.type,m=a.proxy;h.removeEventListener?h.removeEventListener(f,m,a.capture):h.detachEvent?h.detachEvent(DI(f),m):h.addListener&&h.removeListener&&h.removeListener(m),(f=tf(h))?(Jd(f,a),0==f.h&&(f.src=null,h[Xd]=null)):Ia(a)}}}function DI(a){return a in Zd?Zd[a]:Zd[a]="on"+a}function wS(a,h){if(a.da)a=!0;else{h=new Ye(h,this);const f=a.listener,m=a.ha||a.src;a.fa&&ef(a),a=f.call(m,h)}return a}function tf(a){return(a=a[Xd])instanceof Ea?a:null}var nf="__closure_events_fn_"+(1e9*Math.random()>>>0);function rf(a){return"function"==typeof a?a:(a[nf]||(a[nf]=function(h){return a.handleEvent(h)}),a[nf])}function ze(){w.call(this),this.i=new Ea(this),this.M=this,this.G=null}function We(a,h){var f,m=a.G;if(m)for(f=[];m;m=m.G)f.push(m);if(a=a.M,m=h.type||h,"string"==typeof h)h=new v(h,a);else if(h instanceof v)h.target=h.target||a;else{var R=h;CI(h=new v(m,a),R)}let x,U;if(R=!0,f)for(U=f.length-1;U>=0;U--)x=h.g=f[U],R=Aa(x,m,!0,h)&&R;if(x=h.g=a,R=Aa(x,m,!0,h)&&R,R=Aa(x,m,!1,h)&&R,f)for(U=0;U<f.length;U++)x=h.g=f[U],R=Aa(x,m,!1,h)&&R}function Aa(a,h,f,m){if(!(h=a.i.g[String(h)]))return!0;h=h.concat();let R=!0;for(let x=0;x<h.length;++x){const U=h[x];if(U&&!U.da&&U.capture==f){const H=U.listener,Se=U.ha||U.src;U.fa&&Jd(a.i,U),R=!1!==H.call(Se,m)&&R}}return R&&!m.defaultPrevented}function OI(a){a.g=function bS(a,h){if("function"!=typeof a){if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=l(a.handleEvent,a)}return Number(h)>2147483647?-1:o.setTimeout(a,h||0)}(()=>{a.g=null,a.i&&(a.i=!1,OI(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}p(ze,w),ze.prototype[yn]=!0,ze.prototype.removeEventListener=function(a,h,f,m){NI(this,a,h,f,m)},ze.prototype.N=function(){if(ze.Z.N.call(this),this.i){var a=this.i;for(const h in a.g){const f=a.g[h];for(let m=0;m<f.length;m++)Ia(f[m]);delete a.g[h],a.h--}}this.G=null},ze.prototype.J=function(a,h,f,m){return this.i.add(String(a),h,!1,f,m)},ze.prototype.K=function(a,h,f,m){return this.i.add(String(a),h,!0,f,m)};class RS extends w{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:OI(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function As(a){w.call(this),this.h=a,this.g={}}p(As,w);var MI=[];function LI(a){Ta(a.g,function(h,f){this.g.hasOwnProperty(f)&&ef(h)},a),a.g={}}As.prototype.N=function(){As.Z.N.call(this),LI(this)},As.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sf=o.JSON.stringify,PS=o.JSON.parse,SS=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function FI(){}function UI(){}var vs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function of(){v.call(this,"d")}function af(){v.call(this,"c")}p(of,v),p(af,v);var sr={},BI=null;function va(){return BI=BI||new ze}function GI(a){v.call(this,sr.Ia,a)}function ws(a){const h=va();We(h,new GI(h))}function qI(a,h){v.call(this,sr.STAT_EVENT,a),this.stat=h}function Ke(a){const h=va();We(h,new qI(h,a))}function jI(a,h){v.call(this,sr.Ja,a),this.size=h}function bs(a,h){if("function"!=typeof a)throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},h)}function Rs(){this.g=!0}function oi(a,h,f,m){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+function VS(a,h){if(!a.g)return h;if(!h)return null;try{const x=JSON.parse(h);if(x)for(a=0;a<x.length;a++)if(Array.isArray(x[a])){var f=x[a];if(!(f.length<2)){var m=f[1];if(Array.isArray(m)&&!(m.length<1)){var R=m[0];if("noop"!=R&&"stop"!=R&&"close"!=R)for(let U=1;U<m.length;U++)m[U]=""}}}return sf(x)}catch{return h}}(a,f)+(m?" "+m:"")})}sr.Ia="serverreachability",p(GI,v),sr.STAT_EVENT="statevent",p(qI,v),sr.Ja="timingevent",p(jI,v),Rs.prototype.ua=function(){this.g=!1},Rs.prototype.info=function(){};var $I,wa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},zI={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function cf(){}function Ps(a){return encodeURIComponent(String(a))}function NS(a){var h=1;a=a.split(":");const f=[];for(;h>0&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function In(a,h,f,m){this.j=a,this.i=h,this.l=f,this.S=m||1,this.V=new As(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new WI}function WI(){this.i=null,this.g="",this.h=!1}p(cf,FI),cf.prototype.g=function(){return new XMLHttpRequest},$I=new cf;var KI={},uf={};function lf(a,h,f){a.M=1,a.A=Ra(wt(h)),a.u=f,a.R=!0,HI(a,null)}function HI(a,h){a.F=Date.now(),ba(a),a.B=wt(a.A);var f=a.B,m=a.S;Array.isArray(m)||(m=[String(m)]),aT(f.i,"t",m),a.C=0,f=a.j.L,a.h=new WI,a.g=bT(a.j,f?h:null,!a.u),a.P>0&&(a.O=new RS(l(a.Y,a,a.g),a.P)),h=a.V,f=a.g,m=a.ba;var R="readystatechange";Array.isArray(R)||(R&&(MI[0]=R.toString()),R=MI);for(let x=0;x<R.length;x++){const U=xI(f,R[x],m||h.handleEvent,!1,h.h||h);if(!U)break;h.g[U.key]=U}h=a.J?PI(a.J):{},a.u?(a.v||(a.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,h)):(a.v="GET",a.g.ea(a.B,a.v,null,h)),ws(),function CS(a,h,f,m,R,x){a.info(function(){if(a.g)if(x){var U="",H=x.split("&");for(let ce=0;ce<H.length;ce++){var Se=H[ce].split("=");if(Se.length>1){const Oe=Se[0];Se=Se[1];const bt=Oe.split("_");U=bt.length>=2&&"type"==bt[1]?U+(Oe+"=")+Se+"&":U+(Oe+"=redacted&")}}}else U=null;else U=x;return"XMLHTTP REQ ("+m+") [attempt "+R+"]: "+h+"\n"+f+"\n"+U})}(a.i,a.v,a.B,a.l,a.S,a.u)}function QI(a){return!!a.g&&"GET"==a.v&&2!=a.M&&a.j.Aa}function OS(a,h){var f=a.C,m=h.indexOf("\n",f);return-1==m?uf:(f=Number(h.substring(f,m)),isNaN(f)?KI:(m+=1)+f>h.length?uf:(h=h.slice(m,m+f),a.C=m+f,h))}function ba(a){a.T=Date.now()+a.H,JI(a,a.H)}function JI(a,h){if(null!=a.D)throw Error("WatchDog timer not null");a.D=bs(l(a.aa,a),h)}function hf(a){a.D&&(o.clearTimeout(a.D),a.D=null)}function Ss(a){0==a.j.I||a.K||ET(a.j,a)}function or(a){hf(a);var h=a.O;h&&"function"==typeof h.dispose&&h.dispose(),a.O=null,LI(a.V),a.g&&(h=a.g,a.g=null,h.abort(),h.dispose())}function df(a,h){try{var f=a.j;if(0!=f.I&&(f.g==a||ff(f.h,a)))if(!a.L&&ff(f.h,a)&&3==f.I){try{var m=f.Ba.g.parse(h)}catch{m=null}if(Array.isArray(m)&&3==m.length){var R=m;if(0==R[0]){e:if(!f.v){if(f.g){if(!(f.g.F+3e3<a.F))break e;Va(f),xa(f)}yf(f),Ke(18)}}else f.xa=R[1],0<f.xa-f.K&&R[2]<37500&&f.F&&0==f.A&&!f.C&&(f.C=bs(l(f.Va,f),6e3));ZI(f.h)<=1&&f.ta&&(f.ta=void 0)}else cr(f,11)}else if((a.L||f.g==a)&&Va(f),!I(h))for(R=f.Ba.g.parse(h),h=0;h<R.length;h++){let ce=R[h];const Oe=ce[0];if(!(Oe<=f.K))if(f.K=Oe,ce=ce[1],2==f.I)if("c"==ce[0]){f.M=ce[1],f.ba=ce[2];const bt=ce[3];null!=bt&&(f.ka=bt,f.j.info("VER="+f.ka));const ur=ce[4];null!=ur&&(f.za=ur,f.j.info("SVER="+f.za));const vn=ce[5];null!=vn&&"number"==typeof vn&&vn>0&&(f.O=m=1.5*vn,f.j.info("backChannelRequestTimeoutMs_="+m)),m=f;const wn=a.g;if(wn){const Da=wn.g?wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Da){var x=m.h;x.g||-1==Da.indexOf("spdy")&&-1==Da.indexOf("quic")&&-1==Da.indexOf("h2")||(x.j=x.l,x.g=new Set,x.h&&(pf(x,x.h),x.h=null))}if(m.G){const Tf=wn.g?wn.g.getResponseHeader("X-HTTP-Session-Id"):null;Tf&&(m.wa=Tf,fe(m.J,m.G,Tf))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-a.F,f.j.info("Handshake RTT: "+f.T+"ms"));var U=a;if((m=f).na=wT(m,m.L?m.ba:null,m.W),U.L){eT(m.h,U);var H=U,Se=m.O;Se&&(H.H=Se),H.D&&(hf(H),ba(H)),m.g=U}else IT(m);f.i.length>0&&ka(f)}else"stop"!=ce[0]&&"close"!=ce[0]||cr(f,7);else 3==f.I&&("stop"==ce[0]||"close"==ce[0]?"stop"==ce[0]?cr(f,7):_f(f):"noop"!=ce[0]&&f.l&&f.l.qa(ce),f.A=0)}ws()}catch{}}In.prototype.ba=function(a){a=a.target;const h=this.O;h&&3==An(a)?h.j():this.Y(a)},In.prototype.Y=function(a){try{if(a==this.g)e:{const H=An(this.g),Se=this.g.ya();if(this.g.ca(),!(H<3)&&(3!=H||this.g&&(this.h.h||this.g.la()||pT(this.g)))){this.K||4!=H||7==Se||ws(),hf(this);var h=this.g.ca();this.X=h;var f=function DS(a){if(!QI(a))return a.g.la();const h=pT(a.g);if(""===h)return"";let f="";const m=h.length,R=4==An(a.g);if(!a.h.i){if(typeof TextDecoder>"u")return or(a),Ss(a),"";a.h.i=new o.TextDecoder}for(let x=0;x<m;x++)a.h.h=!0,f+=a.h.i.decode(h[x],{stream:!(R&&x==m-1)});return h.length=0,a.h.g+=f,a.C=0,a.h.g}(this);if(this.o=200==h,function xS(a,h,f,m,R,x,U){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+R+"]: "+h+"\n"+f+"\n"+x+" "+U})}(this.i,this.v,this.B,this.l,this.S,H,h),this.o){if(this.U&&!this.L){t:{if(this.g){var m,R=this.g;if((m=R.g?R.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(m)){var x=m;break t}}x=null}if(!(a=x)){this.o=!1,this.m=3,Ke(12),or(this),Ss(this);break e}oi(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,df(this,a)}if(this.R){let Oe;for(a=!0;!this.K&&this.C<f.length;){if(Oe=OS(this,f),Oe==uf){4==H&&(this.m=4,Ke(14),a=!1),oi(this.i,this.l,null,"[Incomplete Response]");break}if(Oe==KI){this.m=4,Ke(15),oi(this.i,this.l,f,"[Invalid Chunk]"),a=!1;break}oi(this.i,this.l,Oe,null),df(this,Oe)}if(QI(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=H||0!=f.length||this.h.h||(this.m=1,Ke(16),a=!1),this.o=this.o&&a,a){if(f.length>0&&!this.W){this.W=!0;var U=this.j;U.g==this&&U.aa&&!U.P&&(U.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),If(U),U.P=!0,Ke(11))}}else oi(this.i,this.l,f,"[Invalid Chunked Response]"),or(this),Ss(this)}else oi(this.i,this.l,f,null),df(this,f);4==H&&or(this),this.o&&!this.K&&(4==H?ET(this.j,this):(this.o=!1,ba(this)))}else(function QS(a){const h={};a=(a.g&&An(a)>=2&&a.g.getAllResponseHeaders()||"").split("\r\n");for(let m=0;m<a.length;m++){if(I(a[m]))continue;var f=NS(a[m]);const R=f[0];if("string"!=typeof(f=f[1]))continue;f=f.trim();const x=h[R]||[];h[R]=x,x.push(f)}!function AS(a,h){for(const f in a)h.call(void 0,a[f],f,a)}(h,function(m){return m.join(", ")})})(this.g),400==h&&f.indexOf("Unknown SID")>0?(this.m=3,Ke(12)):(this.m=0,Ke(13)),or(this),Ss(this)}}}catch{}},In.prototype.cancel=function(){this.K=!0,or(this)},In.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(function kS(a,h){a.info(function(){return"TIMEOUT: "+h})}(this.i,this.B),2!=this.M&&(ws(),Ke(17)),or(this),this.m=2,Ss(this)):JI(this,this.T-a)};var MS=class{constructor(a,h){this.g=a,this.map=h}};function YI(a){this.l=a||10,a=o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation")).length>0&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function XI(a){return!!a.h||!!a.g&&a.g.size>=a.j}function ZI(a){return a.h?1:a.g?a.g.size:0}function ff(a,h){return a.h?a.h==h:!!a.g&&a.g.has(h)}function pf(a,h){a.g?a.g.add(h):a.h=h}function eT(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}function tT(a){if(null!=a.h)return a.i.concat(a.h.G);if(null!=a.g&&0!==a.g.size){let h=a.i;for(const f of a.g.values())h=h.concat(f.G);return h}return A(a.i)}YI.prototype.cancel=function(){if(this.i=tT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const a of this.g.values())a.cancel();this.g.clear()}};var nT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Tn(a){let h;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,a instanceof Tn?(this.l=a.l,Cs(this,a.j),this.o=a.o,this.g=a.g,xs(this,a.u),this.h=a.h,mf(this,cT(a.i)),this.m=a.m):a&&(h=String(a).match(nT))?(this.l=!1,Cs(this,h[1]||"",!0),this.o=ks(h[2]||""),this.g=ks(h[3]||"",!0),xs(this,h[4]),this.h=ks(h[5]||"",!0),mf(this,h[6]||"",!0),this.m=ks(h[7]||"")):(this.l=!1,this.i=new Ns(null,this.l))}function wt(a){return new Tn(a)}function Cs(a,h,f){a.j=f?ks(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function xs(a,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);a.u=h}else a.u=null}function mf(a,h,f){h instanceof Ns?(a.i=h,function jS(a,h){h&&!a.j&&(ar(a),a.i=null,a.g.forEach(function(f,m){const R=m.toLowerCase();m!=R&&(iT(this,m),aT(this,R,f))},a)),a.j=h}(a.i,a.l)):(f||(h=Vs(h,GS)),a.i=new Ns(h,a.l))}function fe(a,h,f){a.i.set(h,f)}function Ra(a){return fe(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function ks(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Vs(a,h,f){return"string"==typeof a?(a=encodeURI(a).replace(h,FS),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function FS(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Tn.prototype.toString=function(){const a=[];var h=this.j;h&&a.push(Vs(h,rT,!0),":");var f=this.g;return(f||"file"==h)&&(a.push("//"),(h=this.o)&&a.push(Vs(h,rT,!0),"@"),a.push(Ps(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(f=this.u)&&a.push(":",String(f))),(f=this.h)&&(this.g&&"/"!=f.charAt(0)&&a.push("/"),a.push(Vs(f,"/"==f.charAt(0)?BS:US,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Vs(f,qS)),a.join("")},Tn.prototype.resolve=function(a){const h=wt(this);let f=!!a.j;f?Cs(h,a.j):f=!!a.o,f?h.o=a.o:f=!!a.g,f?h.g=a.g:f=null!=a.u;var m=a.h;if(f)xs(h,a.u);else if(f=!!a.h){if("/"!=m.charAt(0))if(this.g&&!this.h)m="/"+m;else{var R=h.h.lastIndexOf("/");-1!=R&&(m=h.h.slice(0,R+1)+m)}if(".."==(R=m)||"."==R)m="";else if(-1!=R.indexOf("./")||-1!=R.indexOf("/.")){m=0==R.lastIndexOf("/",0),R=R.split("/");const x=[];for(let U=0;U<R.length;){const H=R[U++];"."==H?m&&U==R.length&&x.push(""):".."==H?((x.length>1||1==x.length&&""!=x[0])&&x.pop(),m&&U==R.length&&x.push("")):(x.push(H),m=!0)}m=x.join("/")}else m=R}return f?h.h=m:f=""!==a.i.toString(),f?mf(h,cT(a.i)):f=!!a.m,f&&(h.m=a.m),h};var rT=/[#\/\?@]/g,US=/[#\?:]/g,BS=/[#\?]/g,GS=/[#\?@]/g,qS=/#/g;function Ns(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function ar(a){a.g||(a.g=new Map,a.h=0,a.i&&function LS(a,h){if(a){a=a.split("&");for(let f=0;f<a.length;f++){const m=a[f].indexOf("=");let R,x=null;m>=0?(R=a[f].substring(0,m),x=a[f].substring(m+1)):R=a[f],h(R,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}function iT(a,h){ar(a),h=ai(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function sT(a,h){return ar(a),h=ai(a,h),a.g.has(h)}function oT(a,h){ar(a);let f=[];if("string"==typeof h)sT(a,h)&&(f=f.concat(a.g.get(ai(a,h))));else for(a=Array.from(a.g.values()),h=0;h<a.length;h++)f=f.concat(a[h]);return f}function aT(a,h,f){iT(a,h),f.length>0&&(a.i=null,a.g.set(ai(a,h),A(f)),a.h+=f.length)}function cT(a){const h=new Ns;return h.i=a.i,a.g&&(h.g=new Map(a.g),h.h=a.h),h}function ai(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function En(a,h,f,m,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),m(f)}catch{}}function WS(){this.g=new SS}function Pa(a){this.i=a.Sb||null,this.h=a.ab||!1}function Sa(a,h){ze.call(this),this.H=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function uT(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}function Ds(a){a.readyState=4,a.l=null,a.j=null,a.B=null,Os(a)}function Os(a){a.onreadystatechange&&a.onreadystatechange.call(a)}function lT(a){let h="";return Ta(a,function(f,m){h+=m,h+=":",h+=f,h+="\r\n"}),h}function gf(a,h,f){e:{for(m in f){var m=!1;break e}m=!0}m||(f=lT(f),"string"==typeof a?null!=f&&Ps(f):fe(a,h,f))}function Ie(a){ze.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(r=Ns.prototype).add=function(a,h){ar(this),this.i=null,a=ai(this,a);let f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this},r.forEach=function(a,h){ar(this),this.g.forEach(function(f,m){f.forEach(function(R){a.call(h,R,m,this)},this)},this)},r.set=function(a,h){return ar(this),this.i=null,sT(this,a=ai(this,a))&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},r.get=function(a,h){return a&&(a=oT(this,a)).length>0?String(a[0]):h},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(let m=0;m<h.length;m++){var f=h[m];const R=Ps(f);f=oT(this,f);for(let x=0;x<f.length;x++){let U=R;""!==f[x]&&(U+="="+Ps(f[x])),a.push(U)}}return this.i=a.join("&")},p(Pa,FI),Pa.prototype.g=function(){return new Sa(this.i,this.h)},p(Sa,ze),(r=Sa.prototype).open=function(a,h){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=h,this.readyState=1,Os(this)},r.send=function(a){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(h.body=a),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ds(this)),this.readyState=0},r.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if("arraybuffer"===this.responseType)a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;uT(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))},r.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ds(this):Os(this),3==this.readyState&&uT(this)}},r.Oa=function(a){this.g&&(this.response=this.responseText=a,Ds(this))},r.Na=function(a){this.g&&(this.response=a,Ds(this))},r.ga=function(){this.g&&Ds(this)},r.setRequestHeader=function(a,h){this.A.append(a,h)},r.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var f=h.next();!f.done;)a.push((f=f.value)[0]+": "+f[1]),f=h.next();return a.join("\r\n")},Object.defineProperty(Sa.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(a){this.m=a?"include":"same-origin"}}),p(Ie,ze);var KS=/^https?$/i,HS=["POST","PUT"];function hT(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.o=5,dT(a),Ca(a)}function dT(a){a.A||(a.A=!0,We(a,"complete"),We(a,"error"))}function fT(a){if(a.h&&typeof s<"u")if(a.v&&4==An(a))setTimeout(a.Ca.bind(a),0);else if(We(a,"readystatechange"),4==An(a)){a.h=!1;try{const x=a.ca();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var m;if(m=0===x){let U=String(a.D).match(nT)[1]||null;!U&&o.self&&o.self.location&&(U=o.self.location.protocol.slice(0,-1)),m=!KS.test(U?U.toLowerCase():"")}f=m}if(f)We(a,"complete"),We(a,"success");else{a.o=6;try{var R=An(a)>2?a.g.statusText:""}catch{R=""}a.l=R+" ["+a.ca()+"]",dT(a)}}finally{Ca(a)}}}function Ca(a,h){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const f=a.g;a.g=null,h||We(a,"ready");try{f.onreadystatechange=null}catch{}}}function An(a){return a.g?a.g.readyState:0}function pT(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ms(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function mT(a){this.za=0,this.i=[],this.j=new Rs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ms("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ms("baseRetryDelayMs",5e3,a),this.Za=Ms("retryDelaySeedMs",1e4,a),this.Ta=Ms("forwardChannelMaxRetries",2,a),this.va=Ms("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new YI(a&&a.concurrentRequestLimit),this.Ba=new WS,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function _f(a){if(gT(a),3==a.I){var h=a.V++,f=wt(a.J);if(fe(f,"SID",a.M),fe(f,"RID",h),fe(f,"TYPE","terminate"),Ls(a,f),(h=new In(a,a.j,h)).M=2,h.A=Ra(wt(f)),f=!1,o.navigator&&o.navigator.sendBeacon)try{f=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!f&&o.Image&&((new Image).src=h.A,f=!0),f||(h.g=bT(h.j,null),h.g.ea(h.A)),h.F=Date.now(),ba(h)}vT(a)}function xa(a){a.g&&(If(a),a.g.cancel(),a.g=null)}function gT(a){xa(a),a.v&&(o.clearTimeout(a.v),a.v=null),Va(a),a.h.cancel(),a.m&&("number"==typeof a.m&&o.clearTimeout(a.m),a.m=null)}function ka(a){if(!XI(a.h)&&!a.m){a.m=!0;var h=a.Ea;te||_(),ne||(te(),ne=!0),E.add(h,a),a.D=0}}function _T(a,h){var f;f=h?h.l:a.V++;const m=wt(a.J);fe(m,"SID",a.M),fe(m,"RID",f),fe(m,"AID",a.K),Ls(a,m),a.u&&a.o&&gf(m,a.u,a.o),f=new In(a,a.j,f,a.D+1),null===a.u&&(f.J=a.o),h&&(a.i=h.G.concat(a.i)),h=yT(a,f,1e3),f.H=Math.round(.5*a.va)+Math.round(.5*a.va*Math.random()),pf(a.h,f),lf(f,m,h)}function Ls(a,h){a.H&&Ta(a.H,function(f,m){fe(h,m,f)}),a.l&&Ta({},function(f,m){fe(h,m,f)})}function yT(a,h,f){f=Math.min(a.i.length,f);const m=a.l?l(a.l.Ka,a.l,a):null;e:{var R=a.i;let H=-1;for(;;){const Se=["count="+f];-1==H?f>0?(H=R[0].g,Se.push("ofs="+H)):H=0:Se.push("ofs="+H);let ce=!0;for(let Oe=0;Oe<f;Oe++){var x=R[Oe].g;const bt=R[Oe].map;if((x-=H)<0)H=Math.max(0,R[Oe].g-100),ce=!1;else try{x="req"+x+"_"||0;try{var U=bt instanceof Map?bt:Object.entries(bt);for(const[ur,vn]of U){let wn=vn;c(vn)&&(wn=sf(vn)),Se.push(x+ur+"="+encodeURIComponent(wn))}}catch(ur){throw Se.push(x+"type="+encodeURIComponent("_badmap")),ur}}catch{m&&m(bt)}}if(ce){U=Se.join("&");break e}}U=void 0}return a=a.i.splice(0,f),h.G=a,U}function IT(a){if(!a.g&&!a.v){a.Y=1;var h=a.Da;te||_(),ne||(te(),ne=!0),E.add(h,a),a.A=0}}function yf(a){return!(a.g||a.v||a.A>=3||(a.Y++,a.v=bs(l(a.Da,a),AT(a,a.A)),a.A++,0))}function If(a){null!=a.B&&(o.clearTimeout(a.B),a.B=null)}function TT(a){a.g=new In(a,a.j,"rpc",a.Y),null===a.u&&(a.g.J=a.o),a.g.P=0;var h=wt(a.na);fe(h,"RID","rpc"),fe(h,"SID",a.M),fe(h,"AID",a.K),fe(h,"CI",a.F?"0":"1"),!a.F&&a.ia&&fe(h,"TO",a.ia),fe(h,"TYPE","xmlhttp"),Ls(a,h),a.u&&a.o&&gf(h,a.u,a.o),a.O&&(a.g.H=a.O);var f=a.g;a=a.ba,f.M=1,f.A=Ra(wt(h)),f.u=null,f.R=!0,HI(f,a)}function Va(a){null!=a.C&&(o.clearTimeout(a.C),a.C=null)}function ET(a,h){var f=null;if(a.g==h){Va(a),If(a),a.g=null;var m=2}else{if(!ff(a.h,h))return;f=h.G,eT(a.h,h),m=1}if(0!=a.I)if(h.o)if(1==m){f=h.u?h.u.length:0,h=Date.now()-h.F;var R=a.D;We(m=va(),new jI(m,f)),ka(a)}else IT(a);else if(3==(R=h.m)||0==R&&h.X>0||!(1==m&&function JS(a,h){return!(ZI(a.h)>=a.h.j-(a.m?1:0)||(a.m?(a.i=h.G.concat(a.i),0):1==a.I||2==a.I||a.D>=(a.Sa?0:a.Ta)||(a.m=bs(l(a.Ea,a,h),AT(a,a.D)),a.D++,0)))}(a,h)||2==m&&yf(a)))switch(f&&f.length>0&&(h=a.h,h.i=h.i.concat(f)),R){case 1:cr(a,5);break;case 4:cr(a,10);break;case 3:cr(a,6);break;default:cr(a,2)}}function AT(a,h){let f=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(f*=2),f*h}function cr(a,h){if(a.j.info("Error code "+h),2==h){var f=l(a.bb,a),m=a.Ua;const R=!m;m=new Tn(m||"//www.google.com/images/cleardot.gif"),o.location&&"http"==o.location.protocol||Cs(m,"https"),Ra(m),R?function zS(a,h){const f=new Rs;if(o.Image){const m=new Image;m.onload=d(En,f,"TestLoadImage: loaded",!0,h,m),m.onerror=d(En,f,"TestLoadImage: error",!1,h,m),m.onabort=d(En,f,"TestLoadImage: abort",!1,h,m),m.ontimeout=d(En,f,"TestLoadImage: timeout",!1,h,m),o.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else h(!1)}(m.toString(),f):function $S(a,h){new Rs;const m=new AbortController,R=setTimeout(()=>{m.abort(),En(0,0,!1,h)},1e4);fetch(a,{signal:m.signal}).then(x=>{clearTimeout(R),En(0,0,!!x.ok,h)}).catch(()=>{clearTimeout(R),En(0,0,!1,h)})}(m.toString(),f)}else Ke(2);a.I=0,a.l&&a.l.pa(h),vT(a),gT(a)}function vT(a){if(a.I=0,a.ja=[],a.l){const h=tT(a.h);(0!=h.length||0!=a.i.length)&&(k(a.ja,h),k(a.ja,a.i),a.h.i.length=0,A(a.i),a.i.length=0),a.l.oa()}}function wT(a,h,f){var m=f instanceof Tn?wt(f):new Tn(f);if(""!=m.g)h&&(m.g=h+"."+m.g),xs(m,m.u);else{var R=o.location;m=R.protocol,h=h?h+"."+R.hostname:R.hostname,R=+R.port;const x=new Tn(null);m&&Cs(x,m),h&&(x.g=h),R&&xs(x,R),f&&(x.h=f),m=x}return h=a.wa,(f=a.G)&&h&&fe(m,f,h),fe(m,"VER",a.ka),Ls(a,m),m}function bT(a,h,f){if(h&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return(h=new Ie(a.Aa&&!a.ma?new Pa({ab:f}):a.ma)).Fa(a.L),h}function RT(){}function Na(){}function st(a,h){ze.call(this),this.g=new mT(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(a?a["X-WebChannel-Client-Profile"]=h.sa:a={"X-WebChannel-Client-Profile":h.sa}),this.g.U=a,(a=h&&h.Qb)&&!I(a)&&(this.g.u=a),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!I(h)&&(this.g.G=h,null!==(a=this.h)&&h in a&&h in(a=this.h)&&delete a[h]),this.j=new ci(this)}function PT(a){of.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=null!==h&&a in h?h[a]:void 0),this.data=h}else this.data=a}function ST(){af.call(this),this.status=1}function ci(a){this.g=a}(r=Ie.prototype).Fa=function(a){this.H=a},r.ea=function(a,h,f,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():$I.g(),this.g.onreadystatechange=g(l(this.Ca,this));try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(x){return void hT(this,x)}if(a=f||"",f=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var R in m)f.set(R,m[R]);else{if("function"!=typeof m.keys||"function"!=typeof m.get)throw Error("Unknown input type for opt_headers: "+String(m));for(const x of m.keys())f.set(x,m.get(x))}m=Array.from(f.keys()).find(x=>"content-type"==x.toLowerCase()),R=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(HS,h,void 0)>=0)||m||R||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[x,U]of f)this.g.setRequestHeader(x,U);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(x){hT(this,x)}},r.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,We(this,"complete"),We(this,"abort"),Ca(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ca(this,!0)),Ie.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?fT(this):this.Xa())},r.Xa=function(){fT(this)},r.isActive=function(){return!!this.g},r.ca=function(){try{return An(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(a){if(this.g){var h=this.g.responseText;return a&&0==h.indexOf(a)&&(h=h.substring(a.length)),PS(h)}},r.ya=function(){return this.o},r.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(r=mT.prototype).ka=8,r.I=1,r.connect=function(a,h,f,m){Ke(0),this.W=a,this.H=h||{},f&&void 0!==m&&(this.H.OSID=f,this.H.OAID=m),this.F=this.X,this.J=wT(this,null,this.W),ka(this)},r.Ea=function(a){if(this.m)if(this.m=null,1==this.I){if(!a){this.V=Math.floor(1e5*Math.random()),a=this.V++;const R=new In(this,this.j,a);let x=this.o;if(this.U&&(x?(x=PI(x),CI(x,this.U)):x=this.U),null!==this.u||this.R||(R.J=x,x=null),this.S)e:{for(var h=0,f=0;f<this.i.length;f++){var m=this.i[f];if(void 0===(m="__data__"in m.map&&"string"==typeof(m=m.map.__data__)?m.length:void 0))break;if((h+=m)>4096){h=f;break e}if(4096===h||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=yT(this,R,h),fe(f=wt(this.J),"RID",a),fe(f,"CVER",22),this.G&&fe(f,"X-HTTP-Session-Id",this.G),Ls(this,f),x&&(this.R?h="headers="+Ps(lT(x))+"&"+h:this.u&&gf(f,this.u,x)),pf(this.h,R),this.Ra&&fe(f,"TYPE","init"),this.S?(fe(f,"$req",h),fe(f,"SID","null"),R.U=!0,lf(R,f,null)):lf(R,f,h),this.I=2}}else 3==this.I&&(a?_T(this,a):0==this.i.length||XI(this.h)||_T(this))},r.Da=function(){if(this.v=null,TT(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=bs(l(this.Wa,this),a)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ke(10),xa(this),TT(this))},r.Va=function(){null!=this.C&&(this.C=null,xa(this),yf(this),Ke(19))},r.bb=function(a){a?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))},r.isActive=function(){return!!this.l&&this.l.isActive(this)},(r=RT.prototype).ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){},Na.prototype.g=function(a,h){return new st(a,h)},p(st,ze),st.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},st.prototype.close=function(){_f(this.g)},st.prototype.o=function(a){var h=this.g;if("string"==typeof a){var f={};f.__data__=a,a=f}else this.v&&((f={}).__data__=sf(a),a=f);h.i.push(new MS(h.Ya++,a)),3==h.I&&ka(h)},st.prototype.N=function(){this.g.l=null,delete this.j,_f(this.g),delete this.g,st.Z.N.call(this)},p(PT,of),p(ST,af),p(ci,RT),ci.prototype.ra=function(){We(this.g,"a")},ci.prototype.qa=function(a){We(this.g,new PT(a))},ci.prototype.pa=function(a){We(this.g,new ST)},ci.prototype.oa=function(){We(this.g,"b")},Na.prototype.createWebChannel=Na.prototype.g,st.prototype.send=st.prototype.o,st.prototype.open=st.prototype.m,st.prototype.close=st.prototype.close,ap=kt.createWebChannelTransport=function(){return new Na},op=kt.getStatEventTarget=function(){return va()},sp=kt.Event=sr,Za=kt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},wa.NO_ERROR=0,wa.TIMEOUT=8,wa.HTTP_ERROR=6,$s=kt.ErrorCode=wa,zI.COMPLETE="complete",ip=kt.EventType=zI,UI.EventType=vs,vs.OPEN="a",vs.CLOSE="b",vs.ERROR="c",vs.MESSAGE="d",ze.prototype.listen=ze.prototype.J,gi=kt.WebChannel=UI,kt.FetchXmlHttpFactory=Pa,Ie.prototype.listenOnce=Ie.prototype.K,Ie.prototype.getLastError=Ie.prototype.Ha,Ie.prototype.getLastErrorCode=Ie.prototype.ya,Ie.prototype.getStatus=Ie.prototype.ca,Ie.prototype.getResponseJson=Ie.prototype.La,Ie.prototype.getResponseText=Ie.prototype.la,Ie.prototype.send=Ie.prototype.ea,Ie.prototype.setWithCredentials=Ie.prototype.Fa,rp=kt.XhrIo=Ie}).apply(typeof zs<"u"?zs:typeof self<"u"?self:typeof window<"u"?window:{});const cp="@firebase/firestore";class xe{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xe.UNAUTHENTICATED=new xe(null),xe.GOOGLE_CREDENTIALS=new xe("google-credentials-uid"),xe.FIRST_PARTY=new xe("first-party-uid"),xe.MOCK_USER=new xe("mock-user");let fr="12.7.0";const Kt=new Ba("@firebase/firestore");function pr(){return Kt.logLevel}function O(r,...e){if(Kt.logLevel<=X.DEBUG){const t=e.map(ec);Kt.debug(`Firestore (${fr}): ${r}`,...t)}}function Ee(r,...e){if(Kt.logLevel<=X.ERROR){const t=e.map(ec);Kt.error(`Firestore (${fr}): ${r}`,...t)}}function ot(r,...e){if(Kt.logLevel<=X.WARN){const t=e.map(ec);Kt.warn(`Firestore (${fr}): ${r}`,...t)}}function ec(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function G(r,e,t){let n="Unexpected state";"string"==typeof e?n=e:t=e,lp(r,n,t)}function lp(r,e,t){let n=`FIRESTORE (${fr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(void 0!==t)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Ee(n),new Error(n)}function q(r,e,t,n){let i="Unexpected state";"string"==typeof t?i=t:n=t,r||lp(e,i,n)}function F(r,e){return r}const S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class V extends Pt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ke{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class hp{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(xe.UNAUTHENTICATED))}shutdown(){}}class vA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class wA{constructor(e){this.t=e,this.currentUser=xe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;q(void 0===this.o,42304);let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new ke;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ke,e.enqueueRetryable(()=>s(this.currentUser))};const c=()=>{const l=o;e.enqueueRetryable((0,y.A)(function*(){yield l.promise,yield s(n.currentUser)}))},u=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ke)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(q("string"==typeof n.accessToken,31837,{l:n}),new hp(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return q(null===e||"string"==typeof e,2055,{h:e}),new xe(e)}}class bA{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=xe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class RA{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new bA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(xe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){q(void 0===this.o,3512);const n=s=>{null!=s.error&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tc(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(q("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new tc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function SA(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class nc{static newId(){const t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=SA(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function W(r,e){return r<e?-1:r>e?1:0}function rc(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),s=e.charAt(n);if(i!==s)return ic(i)===ic(s)?W(i,s):ic(i)?1:-1}return W(r.length,e.length)}function ic(r){const e=r.charCodeAt(0);return e>=55296&&e<=57343}function mr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}const sc="__name__";class pt{constructor(e,t,n){void 0===t?t=0:t>e.length&&G(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&G(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===pt.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pt?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=pt.compareSegments(e.get(i),t.get(i));if(0!==s)return s}return W(e.length,t.length)}static compareSegments(e,t){const n=pt.isNumericId(e),i=pt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?pt.extractNumericId(e).compare(pt.extractNumericId(t)):rc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wt.fromString(e.substring(4,e.length-2))}}class Q extends pt{construct(e,t,n){return new Q(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new V(S.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Q(t)}static emptyPath(){return new Q([])}}const kA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pe extends pt{construct(e,t,n){return new pe(e,t,n)}static isValidIdentifier(e){return kA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===sc}static keyField(){return new pe([sc])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new V(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const c=e[i];if("\\"===c){if(i+1===e.length)throw new V(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new V(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else"`"===c?(o=!o,i++):"."!==c||o?(n+=c,i++):(s(),i++)}if(s(),o)throw new V(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pe(t)}static emptyPath(){return new pe([])}}class L{constructor(e){this.path=e}static fromPath(e){return new L(Q.fromString(e))}static fromName(e){return new L(Q.fromString(e).popFirst(5))}static empty(){return new L(Q.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Q.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Q.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new L(new Q(e.slice()))}}function oc(r,e,t){if(!t)throw new V(S.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function fp(r){if(!L.isDocumentKey(r))throw new V(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function pp(r){if(L.isDocumentKey(r))throw new V(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function mp(r){return"object"==typeof r&&null!==r&&(Object.getPrototypeOf(r)===Object.prototype||null===Object.getPrototypeOf(r))}function Ws(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(n=r).constructor?n.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var n;return"function"==typeof r?"a function":G(12329,{type:typeof r})}function Y(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new V(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ws(r);throw new V(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function we(r,e){const t={typeString:r};return e&&(t.value=e),t}function Sn(r,e){if(!mp(r))throw new V(S.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const o=r[n];if(i&&typeof o!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new V(S.INVALID_ARGUMENT,t);return!0}const _p=-62135596800;class re{static now(){return re.fromMillis(Date.now())}static fromDate(e){return re.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new re(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<_p)throw new V(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:re._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Sn(e,re._jsonSchema))return new re(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds-_p).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}re._jsonSchemaVersion="firestore/timestamp/1.0",re._jsonSchema={type:we("string",re._jsonSchemaVersion),seconds:we("number"),nanoseconds:we("number")};class z{static fromTimestamp(e){return new z(e)}static min(){return new z(new re(0,0))}static max(){return new z(new re(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Tp(r){return new Ze(r.readTime,r.key,-1)}class Ze{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ze(z.min(),L.empty(),-1)}static max(){return new Ze(z.max(),L.empty(),-1)}}function cc(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=L.comparator(r.documentKey,e.documentKey),0!==t?t:W(r.largestBatchId,e.largestBatchId))}class Ap{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ht(r){return uc.apply(this,arguments)}function uc(){return(uc=(0,y.A)(function*(r){if(r.code!==S.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==r.message)throw r;O("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class b{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new b((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof b?t:b.resolve(t)}catch(t){return b.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):b.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):b.reject(t)}static resolve(e){return new b((t,n)=>{t(e)})}static reject(e){return new b((t,n)=>{n(e)})}static waitFor(e){return new b((t,n)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},u=>n(u))}),o=!0,s===i&&t()})}static or(e){let t=b.resolve(!1);for(const n of e)t=t.next(i=>i?b.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new b((n,i)=>{const s=e.length,o=new Array(s);let c=0;for(let u=0;u<s;u++){const l=u;t(e[l]).next(d=>{o[l]=d,++c,c===s&&n(o)},d=>i(d))}})}static doWhile(e,t){return new b((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}function Qt(r){return"IndexedDbTransactionError"===r.name}let tt=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}return r.ce=-1,r})();function Ii(r){return null==r}function Ti(r){return 0===r&&1/r==-1/0}function UA(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function Rp(r){return r+"\x01\x01"}const Ai="mutationQueues",ht="mutations",Tr="documentMutations",vi="remoteDocumentGlobal",Er="targets",Ar="targetDocuments",Dn="targetGlobal",wi="collectionParents",vr="clientMetadata",Zs="bundles",eo="namedQueries";function Up(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Yt(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Gp(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class ue{constructor(e,t){this.comparator=e,this.root=t||Me.EMPTY}insert(e,t){return new ue(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Me.BLACK,null,null))}remove(e){return new ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Me.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new no(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new no(this.root,e,this.comparator,!1)}getReverseIterator(){return new no(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new no(this.root,e,this.comparator,!0)}}class no{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Me{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Me.RED,this.left=i??Me.EMPTY,this.right=s??Me.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Me(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Me.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Me.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Me.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Me.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw G(43730,{key:this.key,value:this.value});if(this.right.isRed())throw G(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw G(27949);return e+(this.isRed()?0:1)}}Me.EMPTY=null,Me.RED=!0,Me.BLACK=!1,Me.EMPTY=new class{constructor(){this.size=0}get key(){throw G(57766)}get value(){throw G(16141)}get color(){throw G(16727)}get left(){throw G(29726)}get right(){throw G(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Me(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ie{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qp(this.data.getIterator())}getIteratorFrom(e){return new qp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof ie)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ie(this.comparator);return t.data=e,t}}class qp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class He{constructor(e){this.fields=e,e.sort(pe.comparator)}static empty(){return new He([])}unionWith(e){let t=new ie(pe.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new He(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class jp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ye{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jp("Invalid base64 string: "+s):s}}(e);return new ye(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ye(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ye.EMPTY_BYTE_STRING=new ye("");const hv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vt(r){if(q(!!r,39018),"string"==typeof r){let e=0;const t=hv.exec(r);if(q(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:me(r.seconds),nanos:me(r.nanos)}}function me(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function Nt(r){return"string"==typeof r?ye.fromBase64String(r):ye.fromUint8Array(r)}const zp="server_timestamp",$p="__type__",Wp="__previous_value__",Kp="__local_write_time__";function ro(r){return(r?.mapValue?.fields||{})[$p]?.stringValue===zp}function io(r){const e=r.mapValue.fields[Wp];return ro(e)?io(e):e}function Pi(r){const e=Vt(r.mapValue.fields[Kp].timestampValue);return new re(e.seconds,e.nanos)}class dv{constructor(e,t,n,i,s,o,c,u,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=d}}const Si="(default)";class On{constructor(e,t){this.projectId=e,this.database=t||Si}static empty(){return new On("","")}get isDefaultDatabase(){return this.database===Si}isEqual(e){return e instanceof On&&e.projectId===this.projectId&&e.database===this.database}}const Ic="__type__",Hp="__max__",Xt_mapValue={fields:{__type__:{stringValue:Hp}}},Tc="__vector__",br="value";function Zt(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?ro(r)?4:Zp(r)?9007199254740991:co(r)?10:11:G(28295,{value:r})}function _t(r,e){if(r===e)return!0;const t=Zt(r);if(t!==Zt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Pi(r).isEqual(Pi(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Vt(i.timestampValue),c=Vt(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return s=e,Nt(r.bytesValue).isEqual(Nt(s.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return me(i.geoPointValue.latitude)===me(s.geoPointValue.latitude)&&me(i.geoPointValue.longitude)===me(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return me(i.integerValue)===me(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=me(i.doubleValue),c=me(s.doubleValue);return o===c?Ti(o)===Ti(c):isNaN(o)&&isNaN(c)}return!1}(r,e);case 9:return mr(r.arrayValue.values||[],e.arrayValue.values||[],_t);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(Up(o)!==Up(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===c[u]||!_t(o[u],c[u])))return!1;return!0}(r,e);default:return G(52216,{left:r})}var s}function Ci(r,e){return void 0!==(r.values||[]).find(t=>_t(t,e))}function en(r,e){if(r===e)return 0;const t=Zt(r),n=Zt(e);if(t!==n)return W(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(r.booleanValue,e.booleanValue);case 2:return function(s,o){const c=me(s.integerValue||s.doubleValue),u=me(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(r,e);case 3:return Qp(r.timestampValue,e.timestampValue);case 4:return Qp(Pi(r),Pi(e));case 5:return rc(r.stringValue,e.stringValue);case 6:return function(s,o){const c=Nt(s),u=Nt(o);return c.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const c=s.split("/"),u=o.split("/");for(let l=0;l<c.length&&l<u.length;l++){const d=W(c[l],u[l]);if(0!==d)return d}return W(c.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const c=W(me(s.latitude),me(o.latitude));return 0!==c?c:W(me(s.longitude),me(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Jp(r.arrayValue,e.arrayValue);case 10:return function(s,o){const c=s.fields||{},u=o.fields||{},l=c[br]?.arrayValue,d=u[br]?.arrayValue,p=W(l?.values?.length||0,d?.values?.length||0);return 0!==p?p:Jp(l,d)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===Xt_mapValue&&o===Xt_mapValue)return 0;if(s===Xt_mapValue)return 1;if(o===Xt_mapValue)return-1;const c=s.fields||{},u=Object.keys(c),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const g=rc(u[p],d[p]);if(0!==g)return g;const A=en(c[u[p]],l[d[p]]);if(0!==A)return A}return W(u.length,d.length)}(r.mapValue,e.mapValue);default:throw G(23264,{he:t})}}function Qp(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return W(r,e);const t=Vt(r),n=Vt(e),i=W(t.seconds,n.seconds);return 0!==i?i:W(t.nanos,n.nanos)}function Jp(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=en(t[i],n[i]);if(s)return s}return W(t.length,n.length)}function Rr(r){return Ec(r)}function Ec(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Vt(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?Nt(r.bytesValue).toBase64():"referenceValue"in r?L.fromName(r.referenceValue).toString():"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=Ec(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${Ec(t.fields[o])}`;return i+"}"}(r.mapValue):G(61005,{value:r})}function oo(r){switch(Zt(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=io(r);return e?16+oo(e):16;case 5:return 2*r.stringValue.length;case 6:return Nt(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(r.arrayValue.values||[]).reduce((i,s)=>i+oo(s),0);case 10:case 11:return function(n){let i=0;return Yt(n.fields,(s,o)=>{i+=s.length+oo(o)}),i}(r.mapValue);default:throw G(13486,{value:r})}}function Ac(r){return!!r&&"integerValue"in r}function xi(r){return!!r&&"arrayValue"in r}function ao(r){return!!r&&"mapValue"in r}function co(r){return(r?.mapValue?.fields||{})[Ic]?.stringValue===Tc}function ki(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return Yt(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=ki(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ki(r.arrayValue.values[t]);return e}return{...r}}function Zp(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Hp}class Le{constructor(e){this.value=e}static empty(){return new Le({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ao(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ki(t)}setAll(e){let t=pe.emptyPath(),n={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,n,i),n={},i=[],t=c.popLast()}o?n[c.lastSegment()]=ki(o):i.push(c.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());ao(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _t(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];ao(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Yt(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Le(ki(this.value))}}function rm(r){const e=[];return Yt(r.fields,(t,n)=>{const i=new pe([t]);if(ao(n)){const s=rm(n.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new He(e)}class le{constructor(e,t,n,i,s,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new le(e,0,z.min(),z.min(),z.min(),Le.empty(),0)}static newFoundDocument(e,t,n,i){return new le(e,1,t,z.min(),n,i,0)}static newNoDocument(e,t){return new le(e,2,t,z.min(),z.min(),Le.empty(),0)}static newUnknownDocument(e,t){return new le(e,3,t,z.min(),z.min(),Le.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Le.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Le.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof le&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class tn{constructor(e,t){this.position=e,this.inclusive=t}}function im(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(n=s.field.isKeyField()?L.comparator(L.fromName(o.referenceValue),t.key):en(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function sm(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!_t(r.position[t],e.position[t]))return!1;return!0}class Vi{constructor(e,t="asc"){this.field=e,this.dir=t}}function mv(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class om{}class Z extends om{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new gv(e,t,n):"array-contains"===t?new Iv(e,n):"in"===t?new dm(e,n):"not-in"===t?new Tv(e,n):"array-contains-any"===t?new Ev(e,n):new Z(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new _v(e,n):new yv(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(en(t,this.value)):null!==t&&Zt(this.value)===Zt(t)&&this.matchesComparison(en(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return G(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class se extends om{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new se(e,t)}matches(e){return Pr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Pr(r){return"and"===r.op}function wc(r){return function am(r){for(const e of r.filters)if(e instanceof se)return!1;return!0}(r)&&Pr(r)}function bc(r){if(r instanceof Z)return r.field.canonicalString()+r.op.toString()+Rr(r.value);if(wc(r))return r.filters.map(e=>bc(e)).join(",");{const e=r.filters.map(t=>bc(t)).join(",");return`${r.op}(${e})`}}function cm(r,e){return r instanceof Z?(n=r,(i=e)instanceof Z&&n.op===i.op&&n.field.isEqual(i.field)&&_t(n.value,i.value)):r instanceof se?function(n,i){return i instanceof se&&n.op===i.op&&n.filters.length===i.filters.length&&n.filters.reduce((s,o,c)=>s&&cm(o,i.filters[c]),!0)}(r,e):void G(19439);var n,i}function lm(r){return r instanceof Z?`${(t=r).field.canonicalString()} ${t.op} ${Rr(t.value)}`:r instanceof se?function(t){return t.op.toString()+" {"+t.getFilters().map(lm).join(" ,")+"}"}(r):"Filter";var t}class gv extends Z{constructor(e,t,n){super(e,t,n),this.key=L.fromName(n.referenceValue)}matches(e){const t=L.comparator(e.key,this.key);return this.matchesComparison(t)}}class _v extends Z{constructor(e,t){super(e,"in",t),this.keys=hm(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class yv extends Z{constructor(e,t){super(e,"not-in",t),this.keys=hm(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function hm(r,e){return(e.arrayValue?.values||[]).map(t=>L.fromName(t.referenceValue))}class Iv extends Z{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xi(t)&&Ci(t.arrayValue,this.value)}}class dm extends Z{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ci(this.value.arrayValue,t)}}class Tv extends Z{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ci(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Ci(this.value.arrayValue,t)}}class Ev extends Z{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Ci(this.value.arrayValue,n))}}class Av{constructor(e,t=null,n=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}}function Rc(r,e=null,t=[],n=[],i=null,s=null,o=null){return new Av(r,e,t,n,i,s,o)}function Ln(r){const e=F(r);if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>bc(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(s=n).field.canonicalString()+s.dir;var s}).join(","),Ii(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Rr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Rr(n)).join(",")),e.Te=t}return e.Te}function Ni(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!mv(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!cm(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!sm(r.startAt,e.startAt)&&sm(r.endAt,e.endAt)}class Dt{constructor(e,t=null,n=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null}}function gm(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function Cr(r){const e=F(r);if(null===e.Ie){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new ie(pe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(c=c.add(l.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Vi(s,n))}),t.has(pe.keyField().canonicalString())||e.Ie.push(new Vi(pe.keyField(),n))}return e.Ie}function Be(r){const e=F(r);return e.Ee||(e.Ee=function ym(r,e){if("F"===r.limitType)return Rc(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>new Vi(i.field,"desc"===i.dir?"asc":"desc"));const t=r.endAt?new tn(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new tn(r.startAt.position,r.startAt.inclusive):null;return Rc(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}(e,Cr(r))),e.Ee}function ho(r,e,t){return new Dt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Di(r,e){return Ni(Be(r),Be(e))&&r.limitType===e.limitType}function Im(r){return`${Ln(Be(r))}|lt:${r.limitType}`}function xr(r){return`Query(target=${function(t){let n=t.path.canonicalString();return null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>lm(i)).join(", ")}]`),Ii(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Rr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Rr(i)).join(",")),`Target(${n})`}(Be(r))}; limitType=${r.limitType})`}function Oi(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return null!==n.collectionGroup?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):L.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of Cr(n))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&(i=e,!((n=r).startAt&&!function(o,c,u){const l=im(o,c,u);return o.inclusive?l<=0:l<0}(n.startAt,Cr(n),i)||n.endAt&&!function(o,c,u){const l=im(o,c,u);return o.inclusive?l>=0:l>0}(n.endAt,Cr(n),i)));var n,i}function vv(r,e,t){const n=r.field.isKeyField()?L.comparator(e.key,t.key):function(s,o,c){const u=o.data.field(s),l=c.data.field(s);return null!==u&&null!==l?en(u,l):G(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return G(19790,{direction:r.dir})}}class Ot{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yt(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Gp(this.inner)}size(){return this.innerSize}}const wv=new ue(L.comparator);function Qe(){return wv}const Am=new ue(L.comparator);function Mi(...r){let e=Am;for(const t of r)e=e.insert(t.key,t);return e}function vm(r){let e=Am;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function yt(){return Li()}function wm(){return Li()}function Li(){return new Ot(r=>r.toString(),(r,e)=>r.isEqual(e))}const bv=new ue(L.comparator),Rv=new ie(L.comparator);function K(...r){let e=Rv;for(const t of r)e=e.add(t);return e}const Pv=new ie(W);function xc(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ti(e)?"-0":e}}function bm(r){return{integerValue:""+r}}function Rm(r,e){return function bp(r){return"number"==typeof r&&Number.isInteger(r)&&!Ti(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?bm(e):xc(r,e)}class fo{constructor(){this._=void 0}}function Sv(r,e,t){return r instanceof kr?function(i,s){const o={fields:{[$p]:{stringValue:zp},[Kp]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ro(s)&&(s=io(s)),s&&(o.fields[Wp]=s),{mapValue:o}}(t,e):r instanceof Fn?Sm(r,e):r instanceof Un?Cm(r,e):function(i,s){const o=Pm(i,s),c=xm(o)+xm(i.Ae);return Ac(o)&&Ac(i.Ae)?bm(c):xc(i.serializer,c)}(r,e)}function Cv(r,e,t){return r instanceof Fn?Sm(r,e):r instanceof Un?Cm(r,e):t}function Pm(r,e){return r instanceof Vr?Ac(n=e)||(s=n)&&"doubleValue"in s?e:{integerValue:0}:null;var n,s}class kr extends fo{}class Fn extends fo{constructor(e){super(),this.elements=e}}function Sm(r,e){const t=km(e);for(const n of r.elements)t.some(i=>_t(i,n))||t.push(n);return{arrayValue:{values:t}}}class Un extends fo{constructor(e){super(),this.elements=e}}function Cm(r,e){let t=km(e);for(const n of r.elements)t=t.filter(i=>!_t(i,n));return{arrayValue:{values:t}}}class Vr extends fo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function xm(r){return me(r.integerValue||r.doubleValue)}function km(r){return xi(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class Fi{constructor(e,t){this.field=e,this.transform=t}}class kv{constructor(e,t){this.version=e,this.transformResults=t}}class ge{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ge}static exists(e){return new ge(void 0,e)}static updateTime(e){return new ge(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function po(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class mo{}function Vm(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new Dr(r.key,ge.none()):new Nr(r.key,r.data,ge.none());{const t=r.data,n=Le.empty();let i=new ie(pe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),i=i.add(s)}return new Mt(r.key,n,new He(i.toArray()),ge.none())}}function Vv(r,e,t){r instanceof Nr?function(i,s,o){const c=i.value.clone(),u=Om(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(r,e,t):r instanceof Mt?function(i,s,o){if(!po(i.precondition,s))return void s.convertToUnknownDocument(o.version);const c=Om(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Dm(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Ui(r,e,t,n){return r instanceof Nr?function(s,o,c,u){if(!po(s.precondition,o))return c;const l=s.value.clone(),d=Mm(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof Mt?function(s,o,c,u){if(!po(s.precondition,o))return c;const l=Mm(s.fieldTransforms,u,o),d=o.data;return d.setAll(Dm(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null===c?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(r,e,t,n):(c=t,po(r.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c);var o,c}function Nv(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=Pm(n.transform,i||null);null!=s&&(null===t&&(t=Le.empty()),t.set(n.field,s))}return t||null}function Nm(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(n=r.fieldTransforms)&&void 0===i||n&&i&&mr(n,i,(s,o)=>function xv(r,e){return r.field.isEqual(e.field)&&(i=e.transform,(n=r.transform)instanceof Fn&&i instanceof Fn||n instanceof Un&&i instanceof Un?mr(n.elements,i.elements,_t):n instanceof Vr&&i instanceof Vr?_t(n.Ae,i.Ae):n instanceof kr&&i instanceof kr);var n,i}(s,o))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var n,i}class Nr extends mo{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Mt extends mo{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Dm(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Om(r,e,t){const n=new Map;q(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,c=e.data.field(s.field);n.set(s.field,Cv(o,c,t[i]))}return n}function Mm(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,Sv(s,o,e))}return n}class Dr extends mo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kc extends mo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Vc{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Vv(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ui(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ui(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=wm();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;const u=Vm(o,c);null!==u&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(z.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&mr(this.mutations,e.mutations,(t,n)=>Nm(t,n))&&mr(this.baseMutations,e.baseMutations,(t,n)=>Nm(t,n))}}class Nc{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){q(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return bv}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new Nc(e,t,n,i)}}class Dc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var be,ee;(ee=be||(be={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS",new Wt([4294967295,4294967295],0),Error;class Bv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Or(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Km(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Gv(r,e){return Or(r,e.toTimestamp())}function Ae(r){return q(!!r,49232),z.fromTimestamp(function(t){const n=Vt(t);return new re(n.seconds,n.nanos)}(r))}function Fc(r,e){return Uc(r,e).canonicalString()}function Uc(r,e){const t=(i=r,new Q(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===e?t:t.child(e)}function ji(r,e){return Fc(r.databaseId,e.path)}function Jm(r){const e=function Hm(r){const e=Q.fromString(r);return q(function ig(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}(e),10190,{key:e.toString()}),e}(r);return 4===e.length?Q.emptyPath():function Ym(r){return q(r.length>4&&"documents"===r.get(4),29091,{key:r.toString()}),r.popFirst(5)}(e)}function Xm(r,e,t){return{name:ji(r,e),fields:t.value.mapValue.fields}}function tg(r){let e=Jm(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){q(1===n,65062);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){const g=ng(p);return g instanceof se&&wc(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(g=>{return new Vi(Mr((k=g).field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction));var k}));let c=null;t.limit&&(c=function(p){let g;return g="object"==typeof p?p.value:p,Ii(g)?null:g}(t.limit));let u=null;var p;t.startAt&&(u=new tn((p=t.startAt).values||[],!!p.before));let l=null;return t.endAt&&(l=function(p){return new tn(p.values||[],!p.before)}(t.endAt)),function mm(r,e,t,n,i,s,o,c){return new Dt(r,e,t,n,i,s,o,c)}(e,i,o,s,c,"F",u,l)}function ng(r){return void 0!==r.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Mr(t.unaryFilter.field);return Z.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Mr(t.unaryFilter.field);return Z.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mr(t.unaryFilter.field);return Z.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mr(t.unaryFilter.field);return Z.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return G(61313);default:return G(60726)}}(r):void 0!==r.fieldFilter?Z.create(Mr((t=r).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return G(58110);default:return G(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==r.compositeFilter?function(t){return se.create(t.compositeFilter.filters.map(n=>ng(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G(1026)}}(t.compositeFilter.op))}(r):G(30097,{filter:r});var t}function Mr(r){return pe.fromServerFormat(r.fieldPath)}function Qv(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}class sg{constructor(e){this.yt=e}}function Eo(r){const e=tg({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?ho(e,e.limit,"L"):e}class jn{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(me(e.integerValue));else if("doubleValue"in e){const n=me(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Ti(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Vt(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Nt(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Zp(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):co(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):G(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const i of Object.keys(n))this.Ot(i,t),this.Ct(n[i],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const i=br,s=n[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(me(s)),this.Ot(i,t),this.Ct(n[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const i of n)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),L.fromName(e).path.forEach(n=>{this.Ft(t,60),this.Ut(n,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jn.Kt=new jn;class iw{constructor(){this.Cn=new Kc}addToCollectionParentIndex(e,t){return this.Cn.add(t),b.resolve()}getCollectionParents(e,t){return b.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return b.resolve()}deleteFieldIndex(e,t){return b.resolve()}deleteAllFieldIndexes(e){return b.resolve()}createTargetIndexes(e,t){return b.resolve()}getDocumentsMatchingTarget(e,t){return b.resolve(null)}getIndexType(e,t){return b.resolve(0)}getFieldIndexes(e,t){return b.resolve([])}getNextCollectionGroupToUpdate(e){return b.resolve(null)}getMinOffset(e,t){return b.resolve(Ze.min())}getMinOffsetFromCollectionGroup(e,t){return b.resolve(Ze.min())}updateCollectionGroup(e,t,n){return b.resolve()}updateIndexEntries(e,t){return b.resolve()}}class Kc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ie(Q.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ie(Q.comparator)).toArray()}}new Uint8Array(0);const Ag={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ge{static withCacheSize(e){return new Ge(e,Ge.DEFAULT_COLLECTION_PERCENTILE,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Ge.DEFAULT_COLLECTION_PERCENTILE=10,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ge.DEFAULT=new Ge(41943040,Ge.DEFAULT_COLLECTION_PERCENTILE,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ge.DISABLED=new Ge(-1,0,0);class $n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $n(0)}static cr(){return new $n(-1)}}const Sg="LruGarbageCollector";function xg([r,e],[t,n]){const i=W(r,t);return 0===i?W(e,n):i}class aw{constructor(e){this.Ir=e,this.buffer=new ie(xg),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();xg(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class kg{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){var t=this;O(Sg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,y.A)(function*(){t.Rr=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(n){Qt(n)?O(Sg,"Ignoring IndexedDB error during garbage collection: ",n):yield Ht(n)}yield t.Vr(3e5)}))}}class cw{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(0===t)return b.resolve(tt.ce);const n=new aw(t);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(Ag)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ag):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,s,o,c,u,l;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,t))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(l=Date.now(),pr()<=X.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-d}ms\n\tDetermined least recently used ${i} in `+(c-o)+`ms\n\tRemoved ${s} targets in `+(u-c)+`ms\n\tRemoved ${p} documents in `+(l-u)+`ms\nTotal Duration: ${l-d}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}class Ng{constructor(){this.changes=new Ot(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?b.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class dw{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Fg{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&Ui(n.mutation,i,He.empty(),re.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,K()).next(()=>n))}getLocalViewOfDocuments(e,t,n=K()){const i=yt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=Mi();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=yt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,K()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,n,i){let s=Qe();const o=Li(),c=Li();return t.forEach((u,l)=>{const d=n.get(l.key);i.has(l.key)&&(void 0===d||d.mutation instanceof Mt)?s=s.insert(l.key,l):void 0!==d?(o.set(l.key,d.mutation.getFieldMask()),Ui(d.mutation,l,d.mutation.getFieldMask(),re.now())):o.set(l.key,He.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>c.set(l,new dw(d,o.get(l)??null))),c))}recalculateAndSaveOverlays(e,t){const n=Li();let i=new ue((o,c)=>o-c),s=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(u=>{const l=t.get(u);if(null===l)return;let d=n.get(u)||He.empty();d=c.applyToLocalView(l,d),n.set(u,d);const p=(i.get(c.batchId)||K()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),l=u.key,d=u.value,p=wm();d.forEach(g=>{if(!s.has(g)){const A=Vm(t.get(g),n.get(g));null!==A&&p.set(g,A),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return b.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return L.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):function Pc(r){return null!==r.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i);var o}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):b.resolve(yt());let c=-1,u=s;return o.next(l=>b.forEach(l,(d,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(d)?b.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,K())).next(d=>({batchId:c,changes:vm(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(n=>{let i=Mi();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=Mi();return this.indexManager.getCollectionParents(e,s).next(c=>b.forEach(c,u=>{const l=(p=t,g=u.child(s),new Dt(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt));var p,g;return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(d=>{d.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((u,l)=>{const d=l.getKey();null===o.get(d)&&(o=o.insert(d,le.newInvalidDocument(d)))});let c=Mi();return o.forEach((u,l)=>{const d=s.get(u);void 0!==d&&Ui(d.mutation,l,He.empty(),re.now()),Oi(t,l)&&(c=c.insert(u,l))}),c})}}class fw{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return b.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,{id:(i=t).id,version:i.version,createTime:Ae(i.createTime)}),b.resolve();var i}getNamedQuery(e,t){return b.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,{name:(i=t).name,query:Eo(i.bundledQuery),readTime:Ae(i.readTime)}),b.resolve();var i}}class pw{constructor(){this.overlays=new ue(L.comparator),this.qr=new Map}getOverlay(e,t){return b.resolve(this.overlays.get(t))}getOverlays(e,t){const n=yt();return b.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.St(e,t,s)}),b.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(n)),b.resolve()}getOverlaysForCollection(e,t,n){const i=yt(),s=t.length+1,o=new L(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return b.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new ue((l,d)=>l-d);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let d=s.get(l.largestBatchId);null===d&&(d=yt(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}const c=yt(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>c.set(l,d)),!(c.size()>=i)););return b.resolve(c)}St(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const o=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Dc(t,n));let s=this.qr.get(t);void 0===s&&(s=K(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class mw{constructor(){this.sessionToken=ye.EMPTY_BYTE_STRING}getSessionToken(e){return b.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,b.resolve()}}class Hc{constructor(){this.Qr=new ie(Ve.$r),this.Ur=new ie(Ve.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ve(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Ve(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new L(new Q([])),n=new Ve(t,e),i=new Ve(t,e+1),s=[];return this.Ur.forEachInRange([n,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new L(new Q([])),n=new Ve(t,e),i=new Ve(t,e+1);let s=K();return this.Ur.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Ve(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ve{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return L.comparator(e.key,t.key)||W(e.Yr,t.Yr)}static Kr(e,t){return W(e.Yr,t.Yr)||L.comparator(e.key,t.key)}}class gw{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ie(Ve.$r)}checkEmpty(e){return b.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.tr;this.tr++;const o=new Vc(s,t,n,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new Ve(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return b.resolve(o)}lookupMutationBatch(e,t){return b.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ei(t+1),s=i<0?0:i;return b.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ve(t,0),i=new Ve(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],o=>{const c=this.Xr(o.Yr);s.push(c)}),b.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ie(W);return t.forEach(i=>{const s=new Ve(i,0),o=new Ve(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],c=>{n=n.add(c.Yr)})}),b.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;L.isDocumentKey(s)||(s=s.child(""));const o=new Ve(new L(s),0);let c=new ie(W);return this.Zr.forEachWhile(u=>{const l=u.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(c=c.add(u.Yr)),!0)},o),b.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(n=>{const i=this.Xr(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){q(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return b.forEach(t.mutations,i=>{const s=new Ve(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Ve(t,0),i=this.Zr.firstAfterOrEqual(n);return b.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return b.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class _w{constructor(e){this.ri=e,this.docs=new ue(L.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return b.resolve(n?n.document.mutableCopy():le.newInvalidDocument(t))}getEntries(e,t){let n=Qe();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():le.newInvalidDocument(i))}),b.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Qe();const o=t.path,c=new L(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||cc(Tp(d),n)<=0||(i.has(d.key)||Oi(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return b.resolve(s)}getAllFromCollectionGroup(e,t,n,i){G(9500)}ii(e,t){return b.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new yw(this)}getSize(e){return b.resolve(this.size)}}class yw extends Ng{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),b.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Iw{constructor(e){this.persistence=e,this.si=new Ot(t=>Ln(t),Ni),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.oi=0,this._i=new Hc,this.targetCount=0,this.ai=$n.ur()}forEachTarget(e,t){return this.si.forEach((n,i)=>t(i)),b.resolve()}getLastRemoteSnapshotVersion(e){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return b.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),b.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new $n(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,b.resolve()}updateTargetData(e,t){return this.Pr(t),b.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,b.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=t&&null===n.get(c.targetId)&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),b.waitFor(s).next(()=>i)}getTargetCount(e){return b.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return b.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),b.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),b.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),b.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return b.resolve(n)}containsKey(e,t){return b.resolve(this._i.containsKey(t))}}class Qc{constructor(e,t){this.ui={},this.overlays={},this.ci=new tt(0),this.li=!1,this.li=!0,this.hi=new mw,this.referenceDelegate=e(this),this.Pi=new Iw(this),this.indexManager=new iw,this.remoteDocumentCache=new _w(n=>this.referenceDelegate.Ti(n)),this.serializer=new sg(t),this.Ii=new fw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new gw(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){O("MemoryPersistence","Starting transaction:",e);const i=new Tw(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return b.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Tw extends Ap{constructor(e){super(),this.currentSequenceNumber=e}}class Co{constructor(e){this.persistence=e,this.Ri=new Hc,this.Vi=null}static mi(e){return new Co(e)}get fi(){if(this.Vi)return this.Vi;throw G(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),b.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),b.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),b.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.fi,n=>{const i=L.fromPath(n);return this.gi(e,i).next(s=>{s||t.removeEntry(i,z.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return b.or([()=>b.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class xo{constructor(e,t){this.persistence=e,this.pi=new Ot(n=>function Ue(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Rp(e)),e=UA(r.get(t),e);return Rp(e)}(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=function Vg(r,e){return new cw(r,e)}(this,t)}static mi(e,t){return new xo(e,t)}Ei(){}di(e){return b.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return b.forEach(this.pi,(n,i)=>this.br(e,n,i).next(s=>s?b.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,t).next(c=>{c||(n++,s.removeEntry(o,z.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),b.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),b.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),b.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),b.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=oo(e.data.value)),t}br(e,t,n){return b.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return b.resolve(void 0!==i&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tu{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=K(),i=K();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new tu(e,t.fromCache,n,i)}}class Aw{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Gg{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=Nf()?8:function vp(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}(Te())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Aw;return this.Ss(e,t,o).next(c=>{if(s.result=c,this.Vs)return this.bs(e,t,o,c.size)})}).next(()=>s.result)}bs(e,t,n,i){return n.documentReadCount<this.fs?(pr()<=X.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",xr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),b.resolve()):(pr()<=X.DEBUG&&O("QueryEngine","Query:",xr(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(pr()<=X.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",xr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Be(t))):b.resolve())}ys(e,t){if(gm(t))return b.resolve(null);let n=Be(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=ho(t,null,"F"),n=Be(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=K(...s);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const l=this.Ds(t,c);return this.Cs(t,l,o,u.readTime)?this.ys(e,ho(t,null,"F")):this.vs(e,l,t,u)}))})))}ws(e,t,n,i){return gm(t)||i.isEqual(z.min())?b.resolve(null):this.ps.getDocuments(e,n).next(s=>{const o=this.Ds(t,s);return this.Cs(t,o,n,i)?b.resolve(null):(pr()<=X.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xr(t)),this.vs(e,o,t,function Ip(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=z.fromTimestamp(1e9===n?new re(t+1,0):new re(t,n));return new Ze(i,L.empty(),e)}(i,-1)).next(c=>c))})}Ds(e,t){let n=new ie(function Em(r){return(e,t)=>{let n=!1;for(const i of Cr(r)){const s=vv(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}(e));return t.forEach((i,s)=>{Oi(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return pr()<=X.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",xr(t)),this.ps.getDocumentsMatchingQuery(e,t,Ze.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class ww{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new ue(W),this.xs=new Ot(s=>Ln(s),Ni),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fg(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function jg(r,e){return ru.apply(this,arguments)}function ru(){return(ru=(0,y.A)(function*(r,e){const t=F(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],c=[];let u=K();for(const l of i){o.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}for(const l of s){c.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(n,u).next(l=>({Ls:l,removedBatchIds:o,addedBatchIds:c}))})})})).apply(this,arguments)}function Pw(r,e){const t=F(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}class uu{constructor(){this.activeTargetIds=function Cc(){return Pv}()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class e_{constructor(){this.Mo=new uu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new uu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class xw{Oo(e){}shutdown(){}}const t_="ConnectivityMonitor";class n_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(t_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){O(t_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Oo=null;function hu(){return null===Oo?Oo=268435456+Math.round(2147483648*Math.random()):Oo++,"0x"+Oo.toString(16)}const du="RestConnection",kw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Vw{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Si?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,s){const o=hu(),c=this.zo(e,t.toUriEncodedString());O(du,`Sending RPC '${e}' ${o}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);const{host:l}=new URL(c),d=lr(l);return this.Jo(e,c,u,n,d).then(p=>(O(du,`Received RPC '${e}' ${o}: `,p),p),p=>{throw ot(du,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,t,n,i,s,o){return this.Go(e,t,n,i,s)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+fr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}zo(e,t){return`${this.Uo}/v1/${t}:${kw[e]}`}terminate(){}}class Nw{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const qe="WebChannelConnection";class Dw extends Vw{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const o=hu();return new Promise((c,u)=>{const l=new rp;l.setWithCredentials(!0),l.listenOnce(ip.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case $s.NO_ERROR:const p=l.getResponseJson();O(qe,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case $s.TIMEOUT:O(qe,`RPC '${e}' ${o} timed out`),u(new V(S.DEADLINE_EXCEEDED,"Request time out"));break;case $s.HTTP_ERROR:const g=l.getStatus();if(O(qe,`RPC '${e}' ${o} failed with status:`,g,"response text:",l.getResponseText()),g>0){let A=l.getResponseJson();Array.isArray(A)&&(A=A[0]);const k=A?.error;if(k&&k.status&&k.message){const D=function(B){const $=B.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf($)>=0?$:S.UNKNOWN}(k.status);u(new V(D,k.message))}else u(new V(S.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new V(S.UNAVAILABLE,"Connection failed."));break;default:G(9055,{l_:e,streamId:o,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{O(qe,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);O(qe,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",d,n,15)})}T_(e,t,n){const i=hu(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ap(),c=op(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=s.join("");O(qe,`Creating RPC '${e}' stream ${i}: ${d}`,u);const p=o.createWebChannel(d,u);this.I_(p);let g=!1,A=!1;const k=new Nw({Yo:N=>{A?O(qe,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(g||(O(qe,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),O(qe,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},Zo:()=>p.close()}),D=(N,B,$)=>{N.listen(B,j=>{try{$(j)}catch(J){setTimeout(()=>{throw J},0)}})};return D(p,gi.EventType.OPEN,()=>{A||(O(qe,`RPC '${e}' stream ${i} transport opened.`),k.o_())}),D(p,gi.EventType.CLOSE,()=>{A||(A=!0,O(qe,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(p))}),D(p,gi.EventType.ERROR,N=>{A||(A=!0,ot(qe,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),k.a_(new V(S.UNAVAILABLE,"The operation could not be completed")))}),D(p,gi.EventType.MESSAGE,N=>{if(!A){const B=N.data[0];q(!!B,16349);const $=B,j=$?.error||$[0]?.error;if(j){O(qe,`RPC '${e}' stream ${i} received error:`,j);const J=j.status;let te=function(_){const T=be[_];if(void 0!==T)return function Um(r){if(void 0===r)return Ee("GRPC error has no .code"),S.UNKNOWN;switch(r){case be.OK:return S.OK;case be.CANCELLED:return S.CANCELLED;case be.UNKNOWN:return S.UNKNOWN;case be.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case be.INTERNAL:return S.INTERNAL;case be.UNAVAILABLE:return S.UNAVAILABLE;case be.UNAUTHENTICATED:return S.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case be.NOT_FOUND:return S.NOT_FOUND;case be.ALREADY_EXISTS:return S.ALREADY_EXISTS;case be.PERMISSION_DENIED:return S.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case be.ABORTED:return S.ABORTED;case be.OUT_OF_RANGE:return S.OUT_OF_RANGE;case be.UNIMPLEMENTED:return S.UNIMPLEMENTED;case be.DATA_LOSS:return S.DATA_LOSS;default:return G(39323,{code:r})}}(T)}(J),ne=j.message;void 0===te&&(te=S.INTERNAL,ne="Unknown error status: "+J+" with message "+j.message),A=!0,k.a_(new V(te,ne)),p.close()}else O(qe,`RPC '${e}' stream ${i} received:`,B),k.u_(B)}}),D(c,sp.STAT_EVENT,N=>{N.stat===Za.PROXY?O(qe,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Za.NOPROXY&&O(qe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Mo(){return typeof document<"u"?document:null}function Kn(r){return new Bv(r,!0)}class fu{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const i_="PersistentStream";class s_{constructor(e,t,n,i,s,o,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new fu(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}stop(){var e=this;return(0,y.A)(function*(){e.x_()&&(yield e.close(0))})()}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}k_(){var e=this;return(0,y.A)(function*(){if(e.O_())return e.close(0)})()}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){var n=this;return(0,y.A)(function*(){n.Q_(),n.U_(),n.M_.cancel(),n.D_++,4!==e?n.M_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(Ee(t.toString()),Ee("Using maximum backoff delay to prevent overloading the backend."),n.M_.g_()):t&&t.code===S.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.K_(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.r_(t)})()}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===t&&this.G_(n,i)},n=>{e(()=>{const i=new V(S.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>1==++this.F_?this.J_(i):this.onNext(i))})}N_(){var e=this;this.state=5,this.M_.p_((0,y.A)(function*(){e.state=0,e.start()}))}z_(e){return O(i_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(O(i_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Mw extends s_{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return q(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,q(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){q(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function zv(r,e){return r&&r.length>0?(q(void 0!==e,14353),r.map(t=>function(i,s){let o=Ae(i.updateTime?i.updateTime:s);return o.isEqual(z.min())&&(o=Ae(s)),new kv(o,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Ae(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=function Bc(r){return new Q(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function zi(r,e){let t;if(e instanceof Nr)t={update:Xm(r,e.key,e.value)};else if(e instanceof Dr)t={delete:ji(r,e.key)};else if(e instanceof Mt)t={update:Xm(r,e.key,e.data),updateMask:Qv(e.fieldMask)};else{if(!(e instanceof kc))return G(16599,{Vt:e.type});t={verify:ji(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const c=o.transform;if(c instanceof kr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Fn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Un)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Vr)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw G(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Gv(r,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:G(27497)),t;var s}(this.serializer,n))};this.q_(t)}}class Lw{}class Fw extends Lw{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new V(S.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Uc(t,n),i,s,o)).catch(s=>{throw"FirebaseError"===s.name?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(S.UNKNOWN,s.toString())})}Ho(e,t,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,Uc(t,n),i,o,c,s)).catch(o=>{throw"FirebaseError"===o.name?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(S.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Uw{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ee(t),this.aa=!1):O("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Hn="RemoteStore";class Bw{constructor(e,t,n,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(c=>{n.enqueueAndForget((0,y.A)(function*(){var u;cn(o)&&(O(Hn,"Restarting streams for network reachability change."),yield(u=(0,y.A)(function*(d){const p=F(d);p.Ea.add(4),yield zr(p),p.Ra.set("Unknown"),p.Ea.delete(4),yield Xi(p)}),function l(d){return u.apply(this,arguments)})(o))}))}),this.Ra=new Uw(n,i)}}function Xi(r){return pu.apply(this,arguments)}function pu(){return(pu=(0,y.A)(function*(r){if(cn(r))for(const e of r.da)yield e(!0)})).apply(this,arguments)}function zr(r){return mu.apply(this,arguments)}function mu(){return(mu=(0,y.A)(function*(r){for(const e of r.da)yield e(!1)})).apply(this,arguments)}function cn(r){return 0===F(r).Ea.size}function Fo(r,e,t){return vu.apply(this,arguments)}function vu(){return(vu=(0,y.A)(function*(r,e,t){if(!Qt(e))throw e;r.Ea.add(1),yield zr(r),r.Ra.set("Offline"),t||(t=()=>function zg(r){const e=F(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}(r.localStore)),r.asyncQueue.enqueueRetryable((0,y.A)(function*(){O(Hn,"Retrying IndexedDB access"),yield t(),r.Ea.delete(1),yield Xi(r)}))})).apply(this,arguments)}function c_(r,e){return e().catch(t=>Fo(r,t,e))}function Wr(r){return wu.apply(this,arguments)}function wu(){return(wu=(0,y.A)(function*(r){const e=F(r),t=un(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;$w(e);)try{const i=yield Pw(e.localStore,n);if(null===i){0===e.Ta.length&&t.L_();break}n=i.batchId,Ww(e,i)}catch(i){yield Fo(e,i)}u_(e)&&l_(e)})).apply(this,arguments)}function $w(r){return cn(r)&&r.Ta.length<10}function Ww(r,e){r.Ta.push(e);const t=un(r);t.O_()&&t.X_&&t.ea(e.mutations)}function u_(r){return cn(r)&&!un(r).x_()&&r.Ta.length>0}function l_(r){un(r).start()}function Kw(r){return bu.apply(this,arguments)}function bu(){return(bu=(0,y.A)(function*(r){un(r).ra()})).apply(this,arguments)}function Hw(r){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,y.A)(function*(r){const e=un(r);for(const t of r.Ta)e.ea(t.mutations)})).apply(this,arguments)}function Qw(r,e,t){return Pu.apply(this,arguments)}function Pu(){return(Pu=(0,y.A)(function*(r,e,t){const n=r.Ta.shift(),i=Nc.from(n,e,t);yield c_(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield Wr(r)})).apply(this,arguments)}function Jw(r,e){return Su.apply(this,arguments)}function Su(){return Su=(0,y.A)(function*(r,e){var t;e&&un(r).X_&&(yield(t=(0,y.A)(function*(i,s){if(function Fm(r){switch(r){case S.OK:return G(64938);case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return G(15467,{code:r})}}(c=s.code)&&c!==S.ABORTED){const o=i.Ta.shift();un(i).B_(),yield c_(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Wr(i)}var c}),function n(i,s){return t.apply(this,arguments)})(r,e)),u_(r)&&l_(r)}),Su.apply(this,arguments)}function h_(r,e){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,y.A)(function*(r,e){const t=F(r);t.asyncQueue.verifyOperationInProgress(),O(Hn,"RemoteStore received new credentials");const n=cn(t);t.Ea.add(3),yield zr(t),n&&t.Ra.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),yield Xi(t)})).apply(this,arguments)}function xu(r,e){return ku.apply(this,arguments)}function ku(){return(ku=(0,y.A)(function*(r,e){const t=F(r);e?(t.Ea.delete(2),yield Xi(t)):e||(t.Ea.add(2),yield zr(t),t.Ra.set("Unknown"))})).apply(this,arguments)}function un(r){return r.fa||(r.fa=function(t,n,i){const s=F(t);return s.sa(),new Mw(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:Kw.bind(null,r),r_:Jw.bind(null,r),ta:Hw.bind(null,r),na:Qw.bind(null,r)}),r.da.push(function(){var e=(0,y.A)(function*(t){t?(r.fa.B_(),yield Wr(r)):(yield r.fa.stop(),r.Ta.length>0&&(O(Hn,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))});return function(t){return e.apply(this,arguments)}}())),r.fa}class Vu{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ke,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,c=new Vu(e,t,o,i,s);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new V(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hr(r,e){if(Ee("AsyncQueue",`${e}: ${r}`),Qt(r))return new V(S.UNAVAILABLE,`${e}: ${r}`);throw r}class Xw{constructor(){this.queries=f_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,n){const i=F(t),s=i.queries;i.queries=f_(),s.forEach((o,c)=>{for(const u of c.Sa)u.onError(n)})}(this,new V(S.ABORTED,"Firestore shutting down"))}}function f_(){return new Ot(r=>Im(r),Di)}var Fu,p_;(p_=Fu||(Fu={})).Ma="default",p_.Cache="cache";class rb{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ot(c=>Im(c),Di),this.Iu=new Map,this.Eu=new Set,this.du=new ue(L.comparator),this.Au=new Map,this.Ru=new Hc,this.Vu={},this.mu=new Map,this.fu=$n.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function Hu(){return(Hu=(0,y.A)(function*(r,e,t){const n=function fl(r){const e=F(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hb.bind(null,e),e}(r);try{const i=yield function(o,c){const u=F(o),l=re.now(),d=c.reduce((A,k)=>A.add(k.key),K());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",A=>{let k=Qe(),D=K();return u.Ns.getEntries(A,d).next(N=>{k=N,k.forEach((B,$)=>{$.isValidDocument()||(D=D.add(B))})}).next(()=>u.localDocuments.getOverlayedDocuments(A,k)).next(N=>{p=N;const B=[];for(const $ of c){const j=Nv($,p.get($.key).overlayedDocument);null!=j&&B.push(new Mt($.key,j,rm(j.value.mapValue),ge.exists(!0)))}return u.mutationQueue.addMutationBatch(A,l,B,c)}).next(N=>{g=N;const B=N.applyToLocalDocumentSet(p,D);return u.documentOverlayCache.saveOverlays(A,N.batchId,B)})}).then(()=>({batchId:g.batchId,changes:vm(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let l=o.Vu[o.currentUser.toKey()];l||(l=new ue(W)),l=l.insert(c,u),o.Vu[o.currentUser.toKey()]=l}(n,i.batchId,t),yield Ft(n,i.changes),yield Wr(n.remoteStore)}catch(i){const s=Hr(i,"Failed to persist write");t.reject(s)}})).apply(this,arguments)}function v_(r,e,t){const n=F(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.Tu.forEach((s,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=F(o);u.onlineState=c;let l=!1;u.queries.forEach((d,p)=>{for(const g of p.Sa)g.va(c)&&(l=!0)}),l&&function Lu(r){r.Ca.forEach(e=>{e.next()})}(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function lb(r,e){return Yu.apply(this,arguments)}function Yu(){return(Yu=(0,y.A)(function*(r,e){const t=F(r),n=e.batch.batchId;try{const i=yield function bw(r,e){const t=F(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,l,d){const p=l.batch,g=p.keys();let A=b.resolve();return g.forEach(k=>{A=A.next(()=>d.getEntry(u,k)).next(D=>{const N=l.docVersions.get(k);q(null!==N,48541),D.version.compareTo(N)<0&&(p.applyToRemoteDocument(D,l),D.isValidDocument()&&(D.setReadTime(l.commitVersion),d.addEntry(D)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=K();for(let l=0;l<c.mutationResults.length;++l)c.mutationResults[l].transformResults.length>0&&(u=u.add(c.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);tl(t,n,null),el(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield Ft(t,i)}catch(i){yield Ht(i)}})).apply(this,arguments)}function hb(r,e,t){return Xu.apply(this,arguments)}function Xu(){return(Xu=(0,y.A)(function*(r,e,t){const n=F(r);try{const i=yield function(o,c){const u=F(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,c).next(p=>(q(null!==p,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(n.localStore,e);tl(n,e,t),el(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield Ft(n,i)}catch(i){yield Ht(i)}})).apply(this,arguments)}function el(r,e){(r.mu.get(e)||[]).forEach(t=>{t.resolve()}),r.mu.delete(e)}function tl(r,e,t){const n=F(r);let i=n.Vu[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Ft(r,e,t){return il.apply(this,arguments)}function il(){return il=(0,y.A)(function*(r,e,t){const n=F(r),i=[],s=[],o=[];var c;n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{o.push(n.pu(u,e,t).then(l=>{if((l||t)&&n.isPrimaryClient){const d=l?!l.fromCache:t?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);const d=tu.As(u.targetId,l);s.push(d)}}))}),yield Promise.all(o),n.Pu.H_(i),yield(c=(0,y.A)(function*(l,d){const p=F(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>b.forEach(d,A=>b.forEach(A.Es,k=>p.persistence.referenceDelegate.addReference(g,A.targetId,k)).next(()=>b.forEach(A.ds,k=>p.persistence.referenceDelegate.removeReference(g,A.targetId,k)))))}catch(g){if(!Qt(g))throw g;O("LocalStore","Failed to update sequence numbers: "+g)}for(const g of d){const A=g.targetId;if(!g.fromCache){const k=p.Ms.get(A),N=k.withLastLimboFreeSnapshotVersion(k.snapshotVersion);p.Ms=p.Ms.insert(A,N)}}}),function u(l,d){return c.apply(this,arguments)})(n.localStore,s))}),il.apply(this,arguments)}function pb(r,e){return sl.apply(this,arguments)}function sl(){return(sl=(0,y.A)(function*(r,e){const t=F(r);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());const n=yield jg(t.localStore,e);t.currentUser=e,(s=t).mu.forEach(c=>{c.forEach(u=>{u.reject(new V(S.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.mu.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield Ft(t,n.Ls)}var s})).apply(this,arguments)}let Bo=(()=>{class r{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){var n=this;return(0,y.A)(function*(){n.serializer=Kn(t.databaseInfo.databaseId),n.sharedClientState=n.Du(t),n.persistence=n.Cu(t),yield n.persistence.start(),n.localStore=n.vu(t),n.gcScheduler=n.Fu(t,n.localStore),n.indexBackfillerScheduler=n.Mu(t,n.localStore)})()}Fu(t,n){return null}Mu(t,n){return null}vu(t){return function qg(r,e,t,n){return new ww(r,e,t,n)}(this.persistence,new Gg,t.initialUser,this.serializer)}Cu(t){return new Qc(Co.mi,this.serializer)}Du(t){return new e_}terminate(){var t=this;return(0,y.A)(function*(){t.gcScheduler?.stop(),t.indexBackfillerScheduler?.stop(),t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}return r.provider={build:()=>new r},r})();class pl extends Bo{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){return q(this.persistence.referenceDelegate instanceof xo,46915),new kg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Ge.withCacheSize(this.cacheSizeBytes):Ge.DEFAULT;return new Qc(n=>xo.mi(n,t),this.serializer)}}let Jr=(()=>{class r{initialize(t,n){var i=this;return(0,y.A)(function*(){i.localStore||(i.localStore=t.localStore,i.sharedClientState=t.sharedClientState,i.datastore=i.createDatastore(n),i.remoteStore=i.createRemoteStore(n),i.eventManager=i.createEventManager(n),i.syncEngine=i.createSyncEngine(n,!t.synchronizeTabs),i.sharedClientState.onlineStateHandler=s=>v_(i.syncEngine,s,1),i.remoteStore.remoteSyncer.handleCredentialChange=pb.bind(null,i.syncEngine),yield xu(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Xw}createDatastore(t){const n=Kn(t.databaseInfo.databaseId),i=new Dw(t.databaseInfo);return new Fw(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return i=this.localStore,s=this.datastore,o=t.asyncQueue,c=n=>v_(this.syncEngine,n,0),u=n_.v()?new n_:new xw,new Bw(i,s,o,c,u);var i,s,o,c,u}createSyncEngine(t,n){return function(s,o,c,u,l,d,p){const g=new rb(s,o,c,u,l,d);return p&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){var t=this;return(0,y.A)(function*(){var n;yield(n=(0,y.A)(function*(s){const o=F(s);O(Hn,"RemoteStore shutting down."),o.Ea.add(5),yield zr(o),o.Aa.shutdown(),o.Ra.set("Unknown")}),function i(s){return n.apply(this,arguments)})(t.remoteStore),t.datastore?.terminate(),t.eventManager?.terminate()})()}}return r.provider={build:()=>new r},r})();const hn="FirestoreClient";class Sb{constructor(e,t,n,i,s){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=xe.UNAUTHENTICATED,this.clientId=nc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,function(){var c=(0,y.A)(function*(u){O(hn,"Received user=",u.uid),yield o.authCredentialListener(u),o.user=u});return function(u){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(n,c=>(O(hn,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ke;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,y.A)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Hr(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function gl(r,e){return _l.apply(this,arguments)}function _l(){return _l=(0,y.A)(function*(r,e){r.asyncQueue.verifyOperationInProgress(),O(hn,"Initializing OfflineComponentProvider");const t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=(0,y.A)(function*(s){n.isEqual(s)||(yield jg(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),_l.apply(this,arguments)}function C_(r,e){return yl.apply(this,arguments)}function yl(){return(yl=(0,y.A)(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Il(r){return Tl.apply(this,arguments)}(r);O(hn,"Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>h_(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>h_(e.remoteStore,i)),r._onlineComponents=e})).apply(this,arguments)}function Tl(){return(Tl=(0,y.A)(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){O(hn,"Using user provided OfflineComponentProvider");try{yield gl(r,r._uninitializedComponentsProvider._offline)}catch(e){if(!("FirebaseError"===(i=e).name?i.code===S.FAILED_PRECONDITION||i.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||22===i.code||20===i.code||11===i.code))throw e;ot("Error using user provided cache. Falling back to memory cache: "+e),yield gl(r,new Bo)}}else O(hn,"Using default OfflineComponentProvider"),yield gl(r,new pl(void 0));var i;return r._offlineComponents})).apply(this,arguments)}function qo(r){return El.apply(this,arguments)}function El(){return(El=(0,y.A)(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(O(hn,"Using user provided OnlineComponentProvider"),yield C_(r,r._uninitializedComponentsProvider._online)):(O(hn,"Using default OnlineComponentProvider"),yield C_(r,new Jr))),r._onlineComponents})).apply(this,arguments)}function M_(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const L_=new Map,F_="firestore.googleapis.com";class B_{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new V(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=F_,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new V(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function VA(r,e,t,n){if(!0===e&&!0===n)throw new V(S.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=M_(e.experimentalLongPollingOptions??{}),function(n){if(void 0!==n.timeoutSeconds){if(isNaN(n.timeoutSeconds))throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zi{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new B_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new V(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new B_(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(n){if(!n)return new AA;switch(n.type){case"firstParty":return new RA(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new V(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){var e=this;return(0,y.A)(function*(){"notTerminated"===e._terminateTask?yield e._terminate():e._terminateTask="notTerminated"})()}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=L_.get(t);n&&(O("ComponentProvider","Removing Datastore"),L_.delete(t),n.terminate())}(this),Promise.resolve()}}class Ne{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ne(this.firestore,e,this._query)}}class oe{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Et(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new oe(this.firestore,e,this._key)}toJSON(){return{type:oe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Sn(t,oe._jsonSchema))return new oe(e,n||null,new L(Q.fromString(t.referencePath)))}}oe._jsonSchemaVersion="firestore/documentReference/1.0",oe._jsonSchema={type:we("string",oe._jsonSchemaVersion),referencePath:we("string")};class Et extends Ne{constructor(e,t,n){super(e,t,function Sr(r){return new Dt(r)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new oe(this.firestore,null,new L(e))}withConverter(e){return new Et(this.firestore,e,this._path)}}function dn(r,e,...t){if(r=Ce(r),oc("collection","path",e),r instanceof Zi){const n=Q.fromString(e,...t);return pp(n),new Et(r,null,n)}{if(!(r instanceof oe||r instanceof Et))throw new V(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Q.fromString(e,...t));return pp(n),new Et(r.firestore,null,n)}}function jo(r,e,...t){if(r=Ce(r),1===arguments.length&&(e=nc.newId()),oc("doc","path",e),r instanceof Zi){const n=Q.fromString(e,...t);return fp(n),new oe(r,null,new L(n))}{if(!(r instanceof oe||r instanceof Et))throw new V(S.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Q.fromString(e,...t));return fp(n),new oe(r.firestore,r instanceof Et?r.converter:null,new L(n))}}const q_="AsyncQueue";class j_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new fu(this,"async_queue_retry"),this._c=()=>{const n=Mo();n&&O(q_,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Mo();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Mo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new ke;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}lc(){var e=this;return(0,y.A)(function*(){if(0!==e.Xu.length){try{yield e.Xu[0](),e.Xu.shift(),e.M_.reset()}catch(t){if(!Qt(t))throw t;O(q_,"Operation failed with retryable error: "+t)}e.Xu.length>0&&e.M_.p_(()=>e.lc())}})()}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Ee("INTERNAL UNHANDLED ERROR: ",z_(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Vu.createAndSchedule(this,e,t,n,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&G(47125,{Pc:z_(this.nc)})}verifyOperationInProgress(){}Tc(){var e=this;return(0,y.A)(function*(){let t;do{t=e.ac,yield t}while(t!==e.ac)})()}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function z_(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+"\n"+r.stack),e}class ae extends Zi{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new j_,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){var e=this;return(0,y.A)(function*(){if(e._firestoreClient){const t=e._firestoreClient.terminate();e._queue=new j_(t),e._firestoreClient=void 0,yield t}})()}}function _e(r){if(r._terminated)throw new V(S.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||function $_(r){const e=r._freezeSettings(),t=new dv(r._databaseId,r._app?.options.appId||"",r._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,M_(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator);var c;r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new Sb(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}}(r._componentsProvider))}(r),r._firestoreClient}class nt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nt(ye.fromBase64String(e))}catch(t){throw new V(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new nt(ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Sn(e,nt._jsonSchema))return nt.fromBase64String(e.bytes)}}nt._jsonSchemaVersion="firestore/bytes/1.0",nt._jsonSchema={type:we("string",nt._jsonSchemaVersion),bytes:we("string")};class Yn{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new V(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xn{constructor(e){this._methodName=e}}class At{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:At._jsonSchemaVersion}}static fromJSON(e){if(Sn(e,At._jsonSchema))return new At(e.latitude,e.longitude)}}At._jsonSchemaVersion="firestore/geoPoint/1.0",At._jsonSchema={type:we("string",At._jsonSchemaVersion),latitude:we("number"),longitude:we("number")};class dt{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:dt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Sn(e,dt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>"number"==typeof t))return new dt(e.vectorValues);throw new V(S.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dt._jsonSchemaVersion="firestore/vectorValue/1.0",dt._jsonSchema={type:we("string",dt._jsonSchemaVersion),vectorValues:we("object")};const $b=/^__.*__$/;class Wb{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Mt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Nr(e,this.data,t,this.fieldTransforms)}}class H_{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Mt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Q_(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G(40011,{Ac:r})}}class zo{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zo({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ko(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Q_(this.Ac)&&$b.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Kb{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Kn(e)}Cc(e,t,n,i=!1){return new zo({Ac:e,methodName:t,Dc:n,path:pe.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zn(r){const e=r._freezeSettings(),t=Kn(r._databaseId);return new Kb(r._databaseId,!!e.ignoreUndefinedProperties,t)}function $o(r,e,t,n,i,s={}){const o=r.Cc(s.merge||s.mergeFields?2:0,e,t,i);kl("Data must be an object, but it was:",o,n);const c=X_(n,o);let u,l;if(s.merge)u=new He(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const g=ns(e,p,t);if(!o.contains(g))throw new V(S.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);ey(d,g)||d.push(g)}u=new He(d),l=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=o.fieldTransforms;return new Wb(new Le(c),u,l)}class ts extends Xn{_toFieldTransform(e){if(2!==e.Ac)throw e.Sc(1===e.Ac?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ts}}class bl extends Xn{_toFieldTransform(e){return new Fi(e.path,new kr)}isEqual(e){return e instanceof bl}}function er(r,e){if(Z_(r=Ce(r)))return kl("Unsupported field value:",e,r),X_(r,e);if(r instanceof Xn)return function(n,i){if(!Q_(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&4!==e.Ac)throw e.Sc("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const c of n){let u=er(c,i.wc(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if(null===(n=Ce(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return Rm(i.serializer,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const s=re.fromDate(n);return{timestampValue:Or(i.serializer,s)}}if(n instanceof re){const s=new re(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Or(i.serializer,s)}}if(n instanceof At)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof nt)return{bytesValue:Km(i.serializer,n._byteString)};if(n instanceof oe){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof dt)return o=n,c=i,{mapValue:{fields:{[Ic]:{stringValue:Tc},[br]:{arrayValue:{values:o.toArray().map(l=>{if("number"!=typeof l)throw c.Sc("VectorValues must only contain numeric values.");return xc(c.serializer,l)})}}}}};var o,c;throw i.Sc(`Unsupported field value: ${Ws(n)}`)}(r,e)}function X_(r,e){const t={};return Gp(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yt(r,(n,i)=>{const s=er(i,e.mc(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function Z_(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof re||r instanceof At||r instanceof nt||r instanceof oe||r instanceof Xn||r instanceof dt)}function kl(r,e,t){if(!Z_(t)||!mp(t)){const n=Ws(t);throw e.Sc("an object"===n?r+" a custom object":r+" "+n)}}function ns(r,e,t){if((e=Ce(e))instanceof Yn)return e._internalPath;if("string"==typeof e)return Wo(r,e);throw Ko("Field path arguments must be of type string or ",r,!1,void 0,t)}const Hb=new RegExp("[~\\*/\\[\\]]");function Wo(r,e,t){if(e.search(Hb)>=0)throw Ko(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Yn(...e.split("."))._internalPath}catch{throw Ko(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Ko(r,e,t,n,i){const s=n&&!n.isEmpty(),o=void 0!==i;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new V(S.INVALID_ARGUMENT,c+r+u)}function ey(r,e){return r.some(t=>t.isEqual(e))}class rs{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new oe(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Qb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ho("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Qb extends rs{data(){return super.data()}}function Ho(r,e){return"string"==typeof e?Wo(r,e):e instanceof Yn?e._internalPath:e._delegate._internalPath}function Xo(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class fn{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rt extends rs{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Zo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ho("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new V(S.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=rt._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle="NOT SUPPORTED",t):t}}rt._jsonSchemaVersion="firestore/documentSnapshot/1.0",rt._jsonSchema={type:we("string",rt._jsonSchemaVersion),bundleSource:we("string","DocumentSnapshot"),bundleName:we("string"),bundle:we("string")};class Zo extends rt{data(e={}){return super.data(e)}}class it{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new fn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Zo(this._firestore,this._userDataWriter,n.key,n,new fn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>({type:"added",doc:new Zo(i._firestore,i._userDataWriter,c.doc.key,c.doc,new fn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||3!==c.type).map(c=>{const u=new Zo(i._firestore,i._userDataWriter,c.doc.key,c.doc,new fn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,d=-1;return 0!==c.type&&(l=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),1!==c.type&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:Yb(c.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new V(S.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=it._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=nc.newId();const t=[],n=[],i=[];return this.docs.forEach(s=>{null!==s._document&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle="NOT SUPPORTED",e}}function Yb(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G(61501,{type:r})}}function uy(r,e,t){r=Y(r,oe);const n=Y(r.firestore,ae),i=Xo(r.converter,e,t);return os(n,[$o(Zn(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,ge.none())])}function tr(r,e){const t=Y(r.firestore,ae),n=jo(r),i=Xo(r.converter,e);return os(t,[$o(Zn(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,ge.exists(!1))]).then(()=>n)}function os(r,e){return function(n,i){const s=new ke;return n.asyncQueue.enqueueAndForget((0,y.A)(function*(){return function cb(r,e,t){return Hu.apply(this,arguments)}(yield function Al(r){return qo(r).then(e=>e.syncEngine)}(n),i,s)})),s.promise}(_e(r),e)}function at(){return new bl("serverTimestamp")}it._jsonSchemaVersion="firestore/querySnapshot/1.0",it._jsonSchema={type:we("string",it._jsonSchemaVersion),bundleSource:we("string","QuerySnapshot"),bundleName:we("string"),bundle:we("string")},function(e,t=!0){fr=dr,hr(new bn("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),c=new ae(new wA(n.getProvider("auth-internal")),new PA(o,n.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new V(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new On(l.options.projectId,d)}(o,i),o);return s={useFetchStreams:t,...s},c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),xt(cp,"4.9.3",e),xt(cp,"4.9.3","esm2020")}();const dR=function py(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},my=new hi("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ta=new Ba("@firebase/auth");function na(r,...e){ta.logLevel<=X.ERROR&&ta.error(`Auth (${dr}): ${r}`,...e)}function Je(r,...e){throw Fl(r,...e)}function $e(r,...e){return Fl(r,...e)}function Ll(r,e,t){const n={...dR(),[e]:t};return new hi("auth","Firebase",n).create(e,{appName:r.name})}function De(r){return Ll(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fl(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return my.create(r,...e)}function M(r,e,...t){if(!r)throw Fl(e,...t)}function vt(r){const e="INTERNAL ASSERTION FAILED: "+r;throw na(e),new Error(e)}function Ut(r,e){r||vt(e)}function as(){return typeof self<"u"&&self.location?.href||""}function gy(){return typeof self<"u"&&self.location?.protocol||null}function pR(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function Ul(){return"http:"===gy()||"https:"===gy()}()||function HT(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}()||"connection"in navigator))||navigator.onLine}class cs{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ut(t>e,"Short delay should be less than long delay!"),this.isMobile=function $T(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Te())}()||function QT(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return pR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Bl(r,e){Ut(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class _y{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void vt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void vt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void vt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},_R=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yR=new cs(3e4,6e4);function he(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}function de(r,e,t,n){return Gl.apply(this,arguments)}function Gl(){return(Gl=(0,y.A)(function*(r,e,t,n,i={}){return yy(r,i,(0,y.A)(function*(){let s={},o={};n&&("GET"===e?o=n:s={body:JSON.stringify(n)});const c=di({key:r.config.apiKey,...o}).slice(1),u=yield r._getAdditionalHeaders();u["Content-Type"]="application/json",r.languageCode&&(u["X-Firebase-Locale"]=r.languageCode);const l={method:e,headers:u,...s};return function KT(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}()||(l.referrerPolicy="no-referrer"),r.emulatorConfig&&lr(r.emulatorConfig.host)&&(l.credentials="include"),_y.fetch()(yield Iy(r,r.config.apiHost,t,c),l)}))})).apply(this,arguments)}function yy(r,e,t){return ql.apply(this,arguments)}function ql(){return(ql=(0,y.A)(function*(r,e,t){r._canInitEmulator=!1;const n={...gR,...e};try{const i=new TR(r),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=yield s.json();if("needConfirmation"in o)throw us(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const c=s.ok?o.errorMessage:o.error.message,[u,l]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw us(r,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw us(r,"email-already-in-use",o);if("USER_DISABLED"===u)throw us(r,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Ll(r,d,l);Je(r,d)}}catch(i){if(i instanceof Pt)throw i;Je(r,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function Bt(r,e,t,n){return jl.apply(this,arguments)}function jl(){return(jl=(0,y.A)(function*(r,e,t,n,i={}){const s=yield de(r,e,t,n,i);return"mfaPendingCredential"in s&&Je(r,"multi-factor-auth-required",{_serverResponse:s}),s})).apply(this,arguments)}function Iy(r,e,t,n){return zl.apply(this,arguments)}function zl(){return(zl=(0,y.A)(function*(r,e,t,n){const i=`${e}${t}?${n}`,s=r,o=s.config.emulator?Bl(r.config,i):`${r.config.apiScheme}://${i}`;return _R.includes(t)&&(yield s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())?s._getPersistence()._getFinalTarget(o).toString():o})).apply(this,arguments)}class TR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n($e(this.auth,"network-request-failed")),yR.get())})}}function us(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=$e(r,e,n);return i.customData._tokenResponse=t,i}function Kl(){return(Kl=(0,y.A)(function*(r,e){return de(r,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function ra(r,e){return Ql.apply(this,arguments)}function Ql(){return(Ql=(0,y.A)(function*(r,e){return de(r,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function ls(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Jl(){return(Jl=(0,y.A)(function*(r,e=!1){const t=Ce(r),n=yield t.getIdToken(e),i=ia(n);M(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:n,authTime:ls(Yl(i.auth_time)),issuedAtTime:ls(Yl(i.iat)),expirationTime:ls(Yl(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})).apply(this,arguments)}function Yl(r){return 1e3*Number(r)}function ia(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return na("JWT malformed, contained fewer than 3 sections"),null;try{const i=ui(t);return i?JSON.parse(i):(na("Failed to decode base64 JWT payload"),null)}catch(i){return na("Caught error parsing JWT payload as JSON",i?.toString()),null}}function wy(r){const e=ia(r);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Gt(r,e){return Xl.apply(this,arguments)}function Xl(){return(Xl=(0,y.A)(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof Pt&&function bR({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}})).apply(this,arguments)}class RR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout((0,y.A)(function*(){yield t.iteration()}),n)}iteration(){var e=this;return(0,y.A)(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class Zl{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ls(this.lastLoginAt),this.creationTime=ls(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function hs(r){return eh.apply(this,arguments)}function eh(){return(eh=(0,y.A)(function*(r){const e=r.auth,t=yield r.getIdToken(),n=yield Gt(r,ra(e,{idToken:t}));M(n?.users.length,e,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const s=i.providerUserInfo?.length?by(i.providerUserInfo):[],o=function SR(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,s),l=!!r.isAnonymous&&!(r.email&&i.passwordHash||o?.length),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zl(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(r,d)})).apply(this,arguments)}function th(){return(th=(0,y.A)(function*(r){const e=Ce(r);yield hs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function by(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}function nh(){return(nh=(0,y.A)(function*(r,e){const t=yield yy(r,{},(0,y.A)(function*(){const n=di({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=yield Iy(r,i,"/v1/token",`key=${s}`),c=yield r._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return r.emulatorConfig&&lr(r.emulatorConfig.host)&&(u.credentials="include"),_y.fetch()(o,u)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})).apply(this,arguments)}function rh(){return(rh=(0,y.A)(function*(r,e){return de(r,"POST","/v2/accounts:revokeToken",he(r,e))})).apply(this,arguments)}class ni{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(0!==e.length,"internal-error");const t=wy(e);this.updateTokensAndExpiration(e,null,t)}getToken(e){var t=this;return(0,y.A)(function*(n,i=!1){return i||!t.accessToken||t.isExpired?(M(t.refreshToken,n,"user-token-expired"),t.refreshToken?(yield t.refresh(n,t.refreshToken),t.accessToken):null):t.accessToken}).apply(this,arguments)}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return(0,y.A)(function*(){const{accessToken:i,refreshToken:s,expiresIn:o}=yield function CR(r,e){return nh.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,s,Number(o))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new ni;return n&&(M("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(M("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(M("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ni,this.toJSON())}_performRefresh(){return vt("not implemented")}}function gn(r,e){M("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class ft{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new RR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Zl(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){var t=this;return(0,y.A)(function*(){const n=yield Gt(t,t.stsTokenManager.getToken(t.auth,e));return M(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function wR(r){return Jl.apply(this,arguments)}(this,e)}reload(){return function PR(r){return th.apply(this,arguments)}(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ft({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e){var t=this;return(0,y.A)(function*(n,i=!1){let s=!1;n.idToken&&n.idToken!==t.stsTokenManager.accessToken&&(t.stsTokenManager.updateFromServerResponse(n),s=!0),i&&(yield hs(t)),yield t.auth._persistUserIfCurrent(t),s&&t.auth._notifyListenersIfCurrent(t)}).apply(this,arguments)}delete(){var e=this;return(0,y.A)(function*(){if(lt(e.auth.app))return Promise.reject(De(e.auth));const t=yield e.getIdToken();return yield Gt(e,function AR(r,e){return Kl.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:A,providerData:k,stsTokenManager:D}=t;M(p&&D,e,"internal-error");const N=ni.fromJSON(this.name,D);M("string"==typeof p,e,"internal-error"),gn(n,e.name),gn(i,e.name),M("boolean"==typeof g,e,"internal-error"),M("boolean"==typeof A,e,"internal-error"),gn(s,e.name),gn(o,e.name),gn(c,e.name),gn(u,e.name),gn(l,e.name),gn(d,e.name);const B=new ft({uid:p,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:A,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:N,createdAt:l,lastLoginAt:d});return k&&Array.isArray(k)&&(B.providerData=k.map($=>({...$}))),u&&(B._redirectEventId=u),B}static _fromIdTokenResponse(e,t){return(0,y.A)(function*(n,i,s=!1){const o=new ni;o.updateFromServerResponse(i);const c=new ft({uid:i.localId,auth:n,stsTokenManager:o,isAnonymous:s});return yield hs(c),c}).apply(this,arguments)}static _fromGetAccountInfoResponse(e,t,n){return(0,y.A)(function*(){const i=t.users[0];M(void 0!==i.localId,"internal-error");const s=void 0!==i.providerUserInfo?by(i.providerUserInfo):[],o=!(i.email&&i.passwordHash||s?.length),c=new ni;c.updateFromIdToken(n);const u=new ft({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Zl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||s?.length)};return Object.assign(u,l),u})()}}const Ry=new Map;function qt(r){Ut(r instanceof Function,"Expected a class definition");let e=Ry.get(r);return e?(Ut(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,Ry.set(r,e),e)}const Py=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,y.A)(function*(){return!0})()}_set(t,n){var i=this;return(0,y.A)(function*(){i.storage[t]=n})()}_get(t){var n=this;return(0,y.A)(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return(0,y.A)(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function sa(r,e,t){return`firebase:${r}:${e}:${t}`}class ri{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=sa(this.userKey,i.apiKey,s),this.fullPersistenceKey=sa("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return(0,y.A)(function*(){const t=yield e.persistence._get(e.fullUserKey);if(!t)return null;if("string"==typeof t){const n=yield ra(e.auth,{idToken:t}).catch(()=>{});return n?ft._fromGetAccountInfoResponse(e.auth,n,t):null}return ft._fromJSON(e.auth,t)})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return(0,y.A)(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t){return(0,y.A)(function*(n,i,s="authUser"){if(!i.length)return new ri(qt(Py),n,s);const o=(yield Promise.all(i.map(function(){var p=(0,y.A)(function*(g){if(yield g._isAvailable())return g});return function(g){return p.apply(this,arguments)}}()))).filter(p=>p);let c=o[0]||qt(Py);const u=sa(s,n.config.apiKey,n.name);let l=null;for(const p of i)try{const g=yield p._get(u);if(g){let A;if("string"==typeof g){const k=yield ra(n,{idToken:g}).catch(()=>{});if(!k)break;A=yield ft._fromGetAccountInfoResponse(n,k,g)}else A=ft._fromJSON(n,g);p!==c&&(l=A),c=p;break}}catch{}const d=o.filter(p=>p._shouldAllowMigration);return c._shouldAllowMigration&&d.length?(c=d[0],l&&(yield c._set(u,l.toJSON())),yield Promise.all(i.map(function(){var p=(0,y.A)(function*(g){if(g!==c)try{yield g._remove(u)}catch{}});return function(g){return p.apply(this,arguments)}}())),new ri(c,n,s)):new ri(c,n,s)}).apply(this,arguments)}}function Sy(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Cy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dy(e))return"Blackberry";if(Oy(e))return"Webos";if(xy(e))return"Safari";if((e.includes("chrome/")||ky(e))&&!e.includes("edge/"))return"Chrome";if(Ny(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function Cy(r=Te()){return/firefox\//i.test(r)}function xy(r=Te()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ky(r=Te()){return/crios\//i.test(r)}function Vy(r=Te()){return/iemobile/i.test(r)}function Ny(r=Te()){return/android/i.test(r)}function Dy(r=Te()){return/blackberry/i.test(r)}function Oy(r=Te()){return/webos/i.test(r)}function ih(r=Te()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function My(r=Te()){return ih(r)||Ny(r)||Oy(r)||Dy(r)||/windows phone/i.test(r)||Vy(r)}function Ly(r,e=[]){let t;switch(r){case"Browser":t=Sy(Te());break;case"Worker":t=`${Sy(Te())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${dr}/${n}`}class NR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,c)=>{try{o(e(s))}catch(u){c(u)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return(0,y.A)(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function sh(){return(sh=(0,y.A)(function*(r,e={}){return de(r,"GET","/v2/passwordPolicy",he(r,e))})).apply(this,arguments)}class MR{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class LR{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fy(this),this.idTokenSubscription=new Fy(this),this.beforeStateQueue=new NR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=my,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=qt(t)),this._initializationPromise=this.queue((0,y.A)(function*(){if(!n._deleted&&(n.persistenceManager=yield ri.create(n,e),n._resolvePersistenceManagerAvailable?.(),!n._deleted)){if(n._popupRedirectResolver?._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=n.currentUser?.uid||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return(0,y.A)(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUserFromIdToken(e){var t=this;return(0,y.A)(function*(){try{const n=yield ra(t,{idToken:e}),i=yield ft._fromGetAccountInfoResponse(t,n,e);yield t.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield t.directlySetCurrentUser(null)}})()}initializeCurrentUser(e){var t=this;return(0,y.A)(function*(){if(lt(t.app)){const o=t.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>t.initializeCurrentUserFromIdToken(o).then(c,c))}):t.directlySetCurrentUser(null)}const n=yield t.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const o=t.redirectUser?._redirectEventId,c=i?._redirectEventId,u=yield t.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(i=u.user,s=!0)}if(!i)return t.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(i)}catch(o){i=n,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(o))}return i?t.reloadAndSetCurrentUserOrClear(i):t.directlySetCurrentUser(null)}return M(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(e){var t=this;return(0,y.A)(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return(0,y.A)(function*(){try{yield hs(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function mR(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return(0,y.A)(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return(0,y.A)(function*(){if(lt(t.app))return Promise.reject(De(t));const n=e?Ce(e):null;return n&&M(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e){var t=this;return(0,y.A)(function*(n,i=!1){if(!t._deleted)return n&&M(t.tenantId===n.tenantId,t,"tenant-id-mismatch"),i||(yield t.beforeStateQueue.runMiddleware(n)),t.queue((0,y.A)(function*(){yield t.directlySetCurrentUser(n),t.notifyAuthListeners()}))}).apply(this,arguments)}signOut(){var e=this;return(0,y.A)(function*(){return lt(e.app)?Promise.reject(De(e)):(yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0))})()}setPersistence(e){var t=this;return lt(this.app)?Promise.reject(De(this)):this.queue((0,y.A)(function*(){yield t.assertedPersistence.setPersistence(qt(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){var t=this;return(0,y.A)(function*(){t._getPasswordPolicyInternal()||(yield t._updatePasswordPolicy());const n=t._getPasswordPolicyInternal();return n.schemaVersion!==t.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(t._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var e=this;return(0,y.A)(function*(){const t=yield function DR(r){return sh.apply(this,arguments)}(e),n=new MR(t);null===e.tenantId?e._projectPasswordPolicy=n:e._tenantPasswordPolicies[e.tenantId]=n})()}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hi("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}revokeAccessToken(e){var t=this;return(0,y.A)(function*(){if(t.currentUser){const n=yield t.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};null!=t.tenantId&&(i.tenantId=t.tenantId),yield function xR(r,e){return rh.apply(this,arguments)}(t,i)}})()}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}_setRedirectUser(e,t){var n=this;return(0,y.A)(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return(0,y.A)(function*(){if(!t.redirectPersistenceManager){const n=e&&qt(e)||t._popupRedirectResolver;M(n,t,"argument-error"),t.redirectPersistenceManager=yield ri.create(t,[qt(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return(0,y.A)(function*(){return t._isInitialized&&(yield t.queue((0,y.A)(function*(){}))),t._currentUser?._redirectEventId===e?t._currentUser:t.redirectUser?._redirectEventId===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return(0,y.A)(function*(){if(e===t.currentUser)return t.queue((0,y.A)(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),"function"==typeof t){const u=e.addObserver(t,n,i);return()=>{o=!0,u()}}{const u=e.addObserver(t);return()=>{o=!0,u()}}}directlySetCurrentUser(e){var t=this;return(0,y.A)(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ly(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return(0,y.A)(function*(){const t={"X-Client-Version":e.clientVersion};e.app.options.appId&&(t["X-Firebase-gmpid"]=e.app.options.appId);const n=yield e.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(t["X-Firebase-Client"]=n);const i=yield e._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})()}_getAppCheckToken(){var e=this;return(0,y.A)(function*(){if(lt(e.app)&&e.app.settings.appCheckToken)return e.app.settings.appCheckToken;const t=yield e.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&function fR(r,...e){ta.logLevel<=X.WARN&&ta.warn(`Auth (${dr}): ${r}`,...e)}(`Error while retrieving App Check token: ${t.error}`),t?.token})()}}function ve(r){return Ce(r)}class Fy{constructor(e){this.auth=e,this.observer=null,this.addObserver=function nE(r,e){const t=new rE(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ds={loadJS:()=>(0,y.A)(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Uy(r){return`__${r}${Math.floor(1e6*Math.random())}`}function qy(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function jy(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class ms{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return vt("not implemented")}_getIdTokenResponse(e){return vt("not implemented")}_linkToIdToken(e,t){return vt("not implemented")}_getReauthenticationResolver(e){return vt("not implemented")}}function jt(r,e){return vh.apply(this,arguments)}function vh(){return(vh=(0,y.A)(function*(r,e){return Bt(r,"POST","/v1/accounts:signInWithIdp",he(r,e))})).apply(this,arguments)}class ii extends ms{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ii(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Je("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,...s}=t;if(!n||!i)return null;const o=new ii(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return jt(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,jt(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,jt(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=di(t)}return e}}class zt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ky extends zt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let yP=(()=>{class r extends Ky{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return ii._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();class ct{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n){return(0,y.A)(function*(i,s,o,c=!1){const u=yield ft._fromIdTokenResponse(i,o,c),l=Qy(o);return new ct({user:u,providerId:l,_tokenResponse:o,operationType:s})}).apply(this,arguments)}static _forOperation(e,t,n){return(0,y.A)(function*(){yield e._updateTokensIfNecessary(n,!0);const i=Qy(n);return new ct({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function Qy(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class la extends Pt{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,la.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new la(e,t,n,i)}}function Jy(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?la._fromErrorAndOperation(r,s,e,n):s})}function Vh(r,e){return Nh.apply(this,arguments)}function Nh(){return(Nh=(0,y.A)(function*(r,e,t=!1){const n=yield Gt(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return ct._forOperation(r,"link",n)})).apply(this,arguments)}function Xy(r,e){return Oh.apply(this,arguments)}function Oh(){return(Oh=(0,y.A)(function*(r,e,t=!1){const{auth:n}=r;if(lt(n.app))return Promise.reject(De(n));const i="reauthenticate";try{const s=yield Gt(r,Jy(n,i,e,r),t);M(s.idToken,n,"internal-error");const o=ia(s.idToken);M(o,n,"internal-error");const{sub:c}=o;return M(r.uid===c,n,"user-mismatch"),ct._forOperation(r,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&Je(n,"user-mismatch"),s}})).apply(this,arguments)}function Zy(r,e){return Mh.apply(this,arguments)}function Mh(){return(Mh=(0,y.A)(function*(r,e,t=!1){if(lt(r.app))return Promise.reject(De(r));const n="signIn",i=yield Jy(r,n,e),s=yield ct._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(s.user)),s})).apply(this,arguments)}const fa="__sak";class rI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fa,"1"),this.storage.removeItem(fa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const UP=(()=>{class r extends rI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=My(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((c,u,l)=>{this.notifyListeners(c,l)});const i=t.key;n?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);!function VR(){return function JT(){const r=Te();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,s=this;return(0,y.A)(function*(){yield i().call(s,t,n),s.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return(0,y.A)(function*(){const s=yield n().call(i,t);return i.localCache[t]=JSON.stringify(s),s})()}_remove(t){var n=()=>super._remove,i=this;return(0,y.A)(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),iI=(()=>{class r extends rI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let GP=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return(0,y.A)(function*(){const i=t,{eventId:s,eventType:o,data:c}=i.data,u=n.handlersMap[o];if(!u?.size)return;i.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const l=Array.from(u).map(function(){var p=(0,y.A)(function*(g){return g(i.origin,c)});return function(g){return p.apply(this,arguments)}}()),d=yield function BP(r){return Promise.all(r.map(function(){var e=(0,y.A)(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:d})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function pa(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class qP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t){var n=this;return(0,y.A)(function*(i,s,o=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let u,l;return new Promise((d,p)=>{const g=pa("",20);c.port1.start();const A=setTimeout(()=>{p(new Error("unsupported_event"))},o);l={messageChannel:c,onMessage(k){const D=k;if(D.data.eventId===g)switch(D.data.status){case"ack":clearTimeout(A),u=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),d(D.data.response);break;default:clearTimeout(A),clearTimeout(u),p(new Error("invalid_response"))}}},n.handlers.add(l),c.port1.addEventListener("message",l.onMessage),n.target.postMessage({eventType:i,eventId:g,data:s},[c.port2])}).finally(()=>{l&&n.removeMessageHandler(l)})}).apply(this,arguments)}}function Re(){return window}function fd(){return typeof Re().WorkerGlobalScope<"u"&&"function"==typeof Re().importScripts}function pd(){return(pd=(0,y.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const sI="firebaseLocalStorageDb",ma="firebaseLocalStorage",oI="fbase_key";class Is{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ga(r,e){return r.transaction([ma],e?"readwrite":"readonly").objectStore(ma)}function md(){const r=indexedDB.open(sI,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(ma,{keyPath:oI})}catch(i){t(i)}}),r.addEventListener("success",(0,y.A)(function*(){const n=r.result;n.objectStoreNames.contains(ma)?e(n):(n.close(),yield function HP(){const r=indexedDB.deleteDatabase(sI);return new Is(r).toPromise()}(),e(yield md()))}))})}function aI(r,e,t){return gd.apply(this,arguments)}function gd(){return(gd=(0,y.A)(function*(r,e,t){const n=ga(r,!0).put({[oI]:e,value:t});return new Is(n).toPromise()})).apply(this,arguments)}function _d(){return(_d=(0,y.A)(function*(r,e){const t=ga(r,!1).get(e),n=yield new Is(t).toPromise();return void 0===n?null:n.value})).apply(this,arguments)}function cI(r,e){const t=ga(r,!0).delete(e);return new Is(t).toPromise()}const XP=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return(0,y.A)(function*(){return t.db||(t.db=yield md()),t.db})()}_withRetries(t){var n=this;return(0,y.A)(function*(){let i=0;for(;;)try{const s=yield n._openDb();return yield t(s)}catch(s){if(i++>3)throw s;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return(0,y.A)(function*(){return fd()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return(0,y.A)(function*(){t.receiver=GP._getInstance(function WP(){return fd()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=(0,y.A)(function*(i,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(i,s){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=(0,y.A)(function*(i,s){return["keyChanged"]});return function(i,s){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return(0,y.A)(function*(){if(t.activeServiceWorker=yield function zP(){return pd.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new qP(t.activeServiceWorker);const n=yield t.sender._send("ping",{},800);n&&n[0]?.fulfilled&&n[0]?.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return(0,y.A)(function*(){if(n.sender&&n.activeServiceWorker&&function $P(){return navigator?.serviceWorker?.controller||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,y.A)(function*(){try{if(!indexedDB)return!1;const t=yield md();return yield aI(t,fa,"1"),yield cI(t,fa),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return(0,y.A)(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return(0,y.A)(function*(){return i._withPendingWrite((0,y.A)(function*(){return yield i._withRetries(s=>aI(s,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return(0,y.A)(function*(){const i=yield n._withRetries(s=>function QP(r,e){return _d.apply(this,arguments)}(s,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return(0,y.A)(function*(){return n._withPendingWrite((0,y.A)(function*(){return yield n._withRetries(i=>cI(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return(0,y.A)(function*(){const n=yield t._withRetries(o=>{const c=ga(o,!1).getAll();return new Is(c).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],s=new Set;if(0!==n.length)for(const{fbase_key:o,value:c}of n)s.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(c)&&(t.notifyListeners(o,c),i.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!s.has(o)&&(t.notifyListeners(o,null),i.push(o));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval((0,y.A)(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function rr(r,e){return e?qt(e):(M(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}Uy("rcb"),new cs(3e4,6e4);class Sd extends ms{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jt(e,this._buildIdpRequest())}_linkToIdToken(e,t){return jt(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return jt(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function a0(r){return Zy(r.auth,new Sd(r),r.bypassAuthState)}function c0(r){const{auth:e,user:t}=r;return M(t,e,"internal-error"),Xy(t,new Sd(r),r.bypassAuthState)}function u0(r){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,y.A)(function*(r){const{auth:e,user:t}=r;return M(t,e,"internal-error"),Vh(t,new Sd(r),r.bypassAuthState)})).apply(this,arguments)}class lI{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=(0,y.A)(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return(0,y.A)(function*(){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:c,type:u}=e;if(c)return void t.reject(c);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(u)(l))}catch(d){t.reject(d)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return a0;case"linkViaPopup":case"linkViaRedirect":return u0;case"reauthViaPopup":case"reauthViaRedirect":return c0;default:Je(this.auth,"internal-error")}}resolve(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const l0=new cs(2e3,1e4);function xd(){return(xd=(0,y.A)(function*(r,e,t){if(lt(r.app))return Promise.reject($e(r,"operation-not-supported-in-this-environment"));const n=ve(r);!function ti(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Je(r,"argument-error"),Ll(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,zt);const i=rr(n,t);return new Nd(n,"signInViaPopup",e,i).executeNotNull()})).apply(this,arguments)}let Nd=(()=>{class r extends lI{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return(0,y.A)(function*(){const n=yield t.execute();return M(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return(0,y.A)(function*(){Ut(1===t.filter.length,"Popup operations only handle one event");const n=pa();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject($e(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($e(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{this.pollId=this.authWindow?.window?.closed?window.setTimeout(()=>{this.pollId=null,this.reject($e(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,l0.get())};t()}}return r.currentPopupAction=null,r})();const Es=new Map;class f0 extends lI{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return(0,y.A)(function*(){let n=Es.get(t.auth._key());if(!n){try{const s=(yield function p0(r,e){return Dd.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(s)}catch(i){n=()=>Promise.reject(i)}Es.set(t.auth._key(),n)}return t.bypassAuthState||Es.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return(0,y.A)(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return(0,y.A)(function*(){})()}cleanUp(){}}function Dd(){return(Dd=(0,y.A)(function*(r,e){const t=function dI(r){return sa("pendingRedirect",r.config.apiKey,r.name)}(e),n=function hI(r){return qt(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i})).apply(this,arguments)}function m0(r,e){Es.set(r._key(),e)}function fI(r,e){return Gd.apply(this,arguments)}function Gd(){return(Gd=(0,y.A)(function*(r,e,t=!1){if(lt(r.app))return Promise.reject(De(r));const n=ve(r),i=rr(n,e),o=yield new f0(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield n._persistUserIfCurrent(o.user),yield n._setRedirectUser(null,e)),o})).apply(this,arguments)}class T0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function E0(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gI(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!gI(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError($e(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mI(e))}saveEventToCache(e){this.cachedEventUids.add(mI(e)),this.lastProcessedEventTime=Date.now()}}function mI(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function gI({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function jd(){return(jd=(0,y.A)(function*(r,e={}){return de(r,"GET","/v1/projects",e)})).apply(this,arguments)}const v0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w0=/^https?/;function zd(){return zd=(0,y.A)(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function A0(r){return jd.apply(this,arguments)}(r);for(const t of e)try{if(R0(t))return}catch{}Je(r,"unauthorized-domain")}),zd.apply(this,arguments)}function R0(r){const e=as(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return""===o.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===n}if(!w0.test(t))return!1;if(v0.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const P0=new cs(3e4,6e4);function _I(){const r=Re().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}function S0(r){return new Promise((e,t)=>{function n(){_I(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_I(),t($e(r,"network-request-failed"))},timeout:P0.get()})}if(Re().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else{if(!Re().gapi?.load){const i=Uy("iframefcb");return Re()[i]=()=>{gapi.load?n():t($e(r,"network-request-failed"))},function oh(r){return ds.loadJS(r)}(`${function GR(){return ds.gapiScript}()}?onload=${i}`).catch(s=>t(s))}n()}}).catch(e=>{throw _a=null,e})}let _a=null;const x0=new cs(5e3,15e3),N0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O0(r){const e=r.config;M(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Bl(e,"emulator/auth/iframe"):`https://${r.config.authDomain}/__/auth/iframe`,n={apiKey:e.apiKey,appName:r.name,v:dr},i=D0.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${di(n).slice(1)}`}function $d(){return $d=(0,y.A)(function*(r){const e=yield function C0(r){return _a=_a||S0(r),_a}(r),t=Re().gapi;return M(t,r,"internal-error"),e.open({where:document.body,url:O0(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:N0,dontclear:!0},n=>new Promise(function(){var i=(0,y.A)(function*(s,o){yield n.restyle({setHideOnLeave:!1});const c=$e(r,"network-request-failed"),u=Re().setTimeout(()=>{o(c)},x0.get());function l(){Re().clearTimeout(u),s(n)}n.ping(l).then(l,()=>{o(c)})});return function(s,o){return i.apply(this,arguments)}}()))}),$d.apply(this,arguments)}const L0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class yI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const W0=encodeURIComponent("fac");function II(r,e,t,n,i,s){return Wd.apply(this,arguments)}function Wd(){return(Wd=(0,y.A)(function*(r,e,t,n,i,s){M(r.config.authDomain,r,"auth-domain-config-required"),M(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:dr,eventId:i};if(e instanceof zt){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",function tE(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof Ky){const d=e.getScopes().filter(p=>""!==p);d.length>0&&(o.scopes=d.join(","))}r.tenantId&&(o.tid=r.tenantId);const c=o;for(const d of Object.keys(c))void 0===c[d]&&delete c[d];const u=yield r._getAppCheckToken(),l=u?`#${W0}=${encodeURIComponent(u)}`:"";return`${function K0({config:r}){return r.emulator?Bl(r,"emulator/auth/handler"):`https://${r.authDomain}/__/auth/handler`}(r)}?${di(c).slice(1)}${l}`})).apply(this,arguments)}const Kd="webStorageSupport",Q0=class H0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iI,this._completeRedirectFn=fI,this._overrideRedirectResult=m0}_openPopup(e,t,n,i){var s=this;return(0,y.A)(function*(){Ut(s.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=yield II(e,t,n,as(),i);return function q0(r,e,t,n=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...L0,width:n.toString(),height:i.toString(),top:s,left:o},l=Te().toLowerCase();t&&(c=ky(l)?"_blank":t),Cy(l)&&(e=e||"http://localhost",u.scrollbars="yes");const d=Object.entries(u).reduce((g,[A,k])=>`${g}${A}=${k},`,"");if(function kR(r=Te()){return ih(r)&&!!window.navigator?.standalone}(l)&&"_self"!==c)return function j0(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",c),new yI(null);const p=window.open(e||"",c,d);M(p,r,"popup-blocked");try{p.focus()}catch{}return new yI(p)}(e,o,pa())})()}_openRedirect(e,t,n,i){var s=this;return(0,y.A)(function*(){return yield s._originValidation(e),function jP(r){Re().location.href=r}(yield II(e,t,n,as(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ut(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return(0,y.A)(function*(){const n=yield function M0(r){return $d.apply(this,arguments)}(e),i=new T0(e);return n.register("authEvent",s=>(M(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kd,{type:Kd},i=>{const s=i?.[0]?.[Kd];void 0!==s&&t(!!s),Je(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function b0(r){return zd.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return My()||xy()||ih()}};var vI="@firebase/auth";class J0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}getToken(e){var t=this;return(0,y.A)(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Z0=Pf("authIdTokenMaxAge")||300;let bI=null;const eS=r=>function(){var e=(0,y.A)(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>Z0)return;const s=n?.token;bI!==s&&(bI=s,yield fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();(function FR(r){ds=r})({loadJS:r=>new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=$e("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",function nS(){return document.getElementsByTagName("head")?.[0]??document}().appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function X0(r){hr(new bn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;M(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ly(r)},l=new LR(n,i,s,u);return function YR(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(qt);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),hr(new bn("auth-internal",e=>{const t=ve(e.getProvider("auth").getImmediate());return new J0(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xt(vI,"1.12.0",function Y0(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(r)),xt(vI,"1.12.0","esm2020")}("Browser");const rS={apiKey:"AIzaSyB6w2XQOpuwol6ZvJiQxob0QE0s3kUQwA0",authDomain:"roadmap-b6949.firebaseapp.com",projectId:"roadmap-b6949",storageBucket:"roadmap-b6949.firebasestorage.app",messagingSenderId:"751503678528",appId:"1:751503678528:web:a6eeddd87d74659e0813a5",measurementId:"G-W3EKPGV2PF"};let ir=null;try{ir=function aA(){return Array.from(Pn.values())}().length?Ha():Hf(rS)}catch{ir=null}const je=ir?function qb(r,e){const t="object"==typeof r?r:Ha(),n="string"==typeof r?r:e||Si,i=js(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=(()=>{const e=bf("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();s&&function Bb(r,e,t,n={}){r=Y(r,Zi);const i=lr(e),s=r._getSettings(),o={...s,emulatorOptions:r._getEmulatorOptions()},c=`${e}:${t}`;i&&(Cf(`https://${c}`),kf("Firestore",!0)),s.host!==F_&&s.host!==c&&ot("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:c,ssl:i,emulatorOptions:n};if(!St(u,o)&&(r._setSettings(u),n.mockUserToken)){let l,d;if("string"==typeof n.mockUserToken)l=n.mockUserToken,d=xe.MOCK_USER;else{l=function qT(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Fs(JSON.stringify({alg:"none",type:"JWT"})),Fs(JSON.stringify(o)),""].join(".")}(n.mockUserToken,r._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new V(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new xe(p)}r._authCredentials=new vA(new hp(l,d))}}(i,...s)}return i}(ir):null,RI=ir?function tS(r=Ha()){const e=js(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function JR(r,e){const t=js(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(St(t.getOptions(),e??{}))return i;Je(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:Q0,persistence:[XP,UP,iI]}),n=Pf("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=eS(s.toString());(function NP(r,e,t){Ce(r).beforeAuthStateChanged(e,t)})(t,o,()=>o(t.currentUser)),function VP(r,e,t,n){Ce(r).onIdTokenChanged(e,t,n)}(t,c=>o(c))}}const i=bf("auth");return i&&function XR(r,e,t){const n=ve(r);M(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=qy(e),{host:o,port:c}=function ZR(r){const e=qy(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:jy(n.substr(s.length+1))}}{const[s,o]=n.split(":");return{host:s,port:jy(o)}}}(e),u=null===c?"":`:${c}`,l={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator)return M(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),void M(St(l,n.config.emulator)&&St(d,n.emulatorConfig),n,"emulator-config-failed");n.config.emulator=l,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,lr(o)?(Cf(`${s}//${o}${u}`),kf("Auth",!0)):i||function eP(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}(t,`http://${i}`),t}(ir):null;function Qd(){return(Qd=(0,y.A)(function*(r){if(!je)throw new Error("Firestore not initialized (check firebaseConfig in src/environments/firebase.ts)");let e=r||null;if(!e)try{const n=localStorage.getItem("currentUser");if(n){const i=JSON.parse(n);e=encodeURIComponent(i.email||i.uid||"unknown")}}catch{e="unknown"}e||(e="unknown");const t={roadmaps:0,completionEvents:0,quizAttempts:0,badges:0};try{const n=localStorage.getItem("savedRoadmaps")||"[]",i=JSON.parse(n);for(const s of i){const o={owner:e,title:s.name||s.title||"Untitled Roadmap",skillsRequired:s.skills||[],steps:s.roadmapLevels||[],certifications:s.certifications||[],projectIdeas:s.projectIdeas||[],createdAt:at(),updatedAt:at()};try{yield tr(dn(je,"roadmaps"),o),t.roadmaps++}catch{try{const u=jo(dn(je,"roadmaps"));yield uy(u,o),t.roadmaps++}catch(u){console.warn("Failed to write roadmap",u)}}}}catch(n){console.warn("No savedRoadmaps to migrate",n)}try{const n=localStorage.getItem("completionEvents")||"[]",i=JSON.parse(n);for(const s of i)try{yield tr(dn(je,`users/${e}/activity`),{type:"completion",payload:s,createdAt:at()}),t.completionEvents++}catch(o){console.warn("Failed to write completion event",o)}}catch(n){console.warn("No completionEvents to migrate",n)}try{const n=localStorage.getItem("quizAttempts")||"[]",i=JSON.parse(n);for(const s of i)try{yield tr(dn(je,`users/${e}/activity`),{type:"quizAttempt",payload:s,createdAt:at()}),t.quizAttempts++}catch(o){console.warn("Failed to write quiz attempt",o)}}catch(n){console.warn("No quizAttempts to migrate",n)}try{const n=localStorage.getItem("badges")||"[]",i=JSON.parse(n);for(const s of i)try{yield tr(dn(je,`users/${e}/badges`),{...s,createdAt:at()}),t.badges++}catch(o){console.warn("Failed to write badge",o)}}catch(n){console.warn("No badges to migrate",n)}return console.info("Migration complete",t),t})).apply(this,arguments)}try{window.runLocalStorageMigration=function iS(r){return Qd.apply(this,arguments)}}catch{}var P=Rt(5547),Fe=Rt(375),sS=Rt(9635),oS=Rt(3481);let aS=(()=>{class r{createOrUpdateUser(t,n){return(0,y.A)(function*(){if(je)try{const i=jo(je,"users",t);yield uy(i,{uid:t,email:n.email,displayName:n.displayName||null,firstTime:n.firstTime??!1,skills:[],goals:null,createdAt:at(),lastLogin:at()},{merge:!0})}catch(i){console.warn("Firestore createOrUpdateUser failed",i)}})()}updateLastLogin(t){return(0,y.A)(function*(){if(je)try{const n=jo(je,"users",t);yield function Xb(r,e,t,...n){r=Y(r,oe);const i=Y(r.firestore,ae),s=Zn(i);let o;return o="string"==typeof(e=Ce(e))||e instanceof Yn?function xl(r,e,t,n,i,s){const o=r.Cc(1,e,t),c=[ns(e,n,t)],u=[i];if(s.length%2!=0)throw new V(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(ns(e,s[g])),u.push(s[g+1]);const l=[],d=Le.empty();for(let g=c.length-1;g>=0;--g)if(!ey(l,c[g])){const A=c[g];let k=u[g];k=Ce(k);const D=o.yc(A);if(k instanceof ts)l.push(A);else{const N=er(k,D);null!=N&&(l.push(A),d.set(A,N))}}const p=new He(l);return new H_(d,p,o.fieldTransforms)}(s,"updateDoc",r._key,e,t,n):function Cl(r,e,t,n){const i=r.Cc(1,e,t);kl("Data must be an object, but it was:",i,n);const s=[],o=Le.empty();Yt(n,(u,l)=>{const d=Wo(e,u,t);l=Ce(l);const p=i.yc(d);if(l instanceof ts)s.push(d);else{const g=er(l,p);null!=g&&(s.push(d),o.set(d,g))}});const c=new He(s);return new H_(o,c,i.fieldTransforms)}(s,"updateDoc",r._key,e),os(i,[o.toMutation(r._key,ge.exists(!0))])}(n,{lastLogin:at(),firstTime:!1})}catch{}})()}createRoadmap(t,n){return(0,y.A)(function*(){if(!je)return null;try{const i=dn(je,"roadmaps");return(yield tr(i,{owner:t,title:n.title,skillsRequired:n.skillsRequired||[],steps:n.steps||[],createdAt:at(),updatedAt:at()})).id}catch(i){return console.warn("createRoadmap failed",i),null}})()}recordActivity(t,n){return(0,y.A)(function*(){if(je)try{const i=dn(je,`users/${t}/activity`);yield tr(i,{...n,createdAt:at()})}catch(i){console.warn("recordActivity failed",i)}})()}submitFeedback(t,n){return(0,y.A)(function*(){if(je)try{const i=dn(je,"feedback");yield tr(i,{uid:t||null,text:n,createdAt:at()})}catch(i){console.warn("submitFeedback failed",i)}})()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=Fe.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var cS=Rt(7473);function uS(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Full name is required."),P.k0s())}function lS(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Full name must be at least 2 characters."),P.k0s())}function hS(r,e){if(1&r&&(P.j41(0,"div",33),P.DNE(1,uS,2,0,"small",15)(2,lS,2,0,"small",15),P.k0s()),2&r){P.XpG();const t=P.sdS(4);P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.required),P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.minlength)}}function dS(r,e){if(1&r){const t=P.RV6();P.qex(0),P.j41(1,"label",30),P.EFF(2,"Full Name"),P.k0s(),P.j41(3,"input",31,3),P.mxI("ngModelChange",function(i){Fe.eBV(t);const s=P.XpG();return P.DH7(s.fullName,i)||(s.fullName=i),Fe.Njj(i)}),P.k0s(),P.DNE(5,hS,3,2,"div",32),P.bVm()}if(2&r){const t=P.sdS(4),n=P.XpG();P.R7$(3),P.R50("ngModel",n.fullName),P.BMQ("aria-invalid",t.invalid&&(t.dirty||t.touched))("aria-describedby",t.invalid&&(t.dirty||t.touched)?"fullName-error":null),P.R7$(2),P.Y8G("ngIf",t.invalid&&(t.dirty||t.touched))}}function fS(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Email is required."),P.k0s())}function pS(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Please enter a valid email address."),P.k0s())}function mS(r,e){if(1&r&&(P.j41(0,"div",34),P.DNE(1,fS,2,0,"small",15)(2,pS,2,0,"small",15),P.k0s()),2&r){P.XpG();const t=P.sdS(32);P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.required),P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.email)}}function gS(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Password is required."),P.k0s())}function _S(r,e){1&r&&(P.j41(0,"small"),P.EFF(1,"Password must be at least 6 characters."),P.k0s())}function yS(r,e){if(1&r&&(P.j41(0,"div",34),P.DNE(1,gS,2,0,"small",15)(2,_S,2,0,"small",15),P.k0s()),2&r){P.XpG();const t=P.sdS(35);P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.required),P.R7$(),P.Y8G("ngIf",null==t.errors?null:t.errors.minlength)}}let IS=(()=>{class r{router;validationService;firestoreService;notificationService;isLogin=!0;fullName="";email="";password="";constructor(t,n,i,s){this.router=t,this.validationService=n,this.firestoreService=i,this.notificationService=s}toggleMode(t){this.isLogin="login"===t,this.isLogin&&(this.fullName="")}onSubmit(t){var n=this;return(0,y.A)(function*(){if(t&&t.invalid)n.validationService.showAlert("Please fix the errors in the form before submitting.");else if(n.validationService.validateEmail(n.email))if(n.validationService.validatePassword(n.password)){if(n.isLogin&&!localStorage.getItem(`profile_${n.email}`))return void n.validationService.showAlert("No account found with this email. Please register first.");if(n.isLogin||n.validationService.validateRequired(n.fullName))if(n.isLogin||n.validationService.validateMaxLength(n.fullName,100)){try{if(n.isLogin){const c=`profile_${n.email}`,u=localStorage.getItem(c);if(u)try{const l=JSON.parse(u);if(l.password&&l.password!==n.password)return void n.validationService.showAlert("Invalid email or password.")}catch{}}else{const c=`profile_${n.email}`;localStorage.setItem(c,JSON.stringify({fullName:n.fullName,email:n.email,password:n.password}))}let i=n.fullName;if(!i)try{const c=localStorage.getItem(`profile_${n.email}`);c&&(i=JSON.parse(c)?.fullName||"")}catch{i=""}i||(i=(n.email||"").split("@")[0]||"User");const s=`hasLoggedIn_${n.email}`,o=!!localStorage.getItem(s);if(o)sessionStorage.setItem("welcomeMessage",`Welcome back, ${i}!`);else{sessionStorage.setItem("welcomeMessage",`Welcome to our website, ${i}!`);try{localStorage.setItem(s,"true")}catch{}}try{localStorage.setItem("currentUser",JSON.stringify({fullName:i,email:n.email}))}catch{}try{const c=encodeURIComponent(n.email||"unknown");yield n.firestoreService.createOrUpdateUser(c,{email:n.email,displayName:i,firstTime:!o})}catch{}}catch{}n.router.navigate(["/dashboard"])}else n.validationService.showAlert("Full name is too long (max 100 characters).");else n.validationService.showAlert("Please enter your full name.")}else n.validationService.showAlert("Password must be at least 6 characters long.");else n.validationService.showAlert("Please enter a valid email address.")})()}loginWithGoogle(){var t=this;return(0,y.A)(function*(){if(RI)try{const n=new yP,s=(yield function h0(r,e,t){return xd.apply(this,arguments)}(RI,n)).user,o=s.email||"",c=s.displayName||s.email?.split("@")[0]||"User";try{const u=`profile_${o}`;localStorage.getItem(u)||localStorage.setItem(u,JSON.stringify({fullName:c,email:o,googleAuth:!0}));const d=`hasLoggedIn_${o}`,p=!!localStorage.getItem(d);p?sessionStorage.setItem("welcomeMessage",`Welcome back, ${c}!`):(sessionStorage.setItem("welcomeMessage",`Welcome to our website, ${c}!`),localStorage.setItem(d,"true")),localStorage.setItem("currentUser",JSON.stringify({fullName:c,email:o}));try{const g=s.uid||encodeURIComponent(o);yield t.firestoreService.createOrUpdateUser(g,{email:o,displayName:c,firstTime:!p})}catch(g){console.warn("Firestore update failed",g)}t.router.navigate(["/dashboard"])}catch(u){console.error("Error storing user data",u),t.notificationService.error("Login successful but failed to save user data. Please try again.")}}catch(n){if(console.error("Google login error",n),"auth/popup-closed-by-user"===n.code)return;t.notificationService.error("Failed to login with Google. Please try again or use email and password.")}else t.validationService.showAlert("Google authentication is not available. Please use email and password.")})()}static \u0275fac=function(n){return new(n||r)(P.rXU(sS.Ix),P.rXU(oS.B),P.rXU(aS),P.rXU(cS.J))};static \u0275cmp=P.VBU({type:r,selectors:[["app-auth"]],decls:52,vars:16,consts:[["authForm","ngForm"],["emailRef","ngModel"],["passwordRef","ngModel"],["fullNameRef","ngModel"],[1,"container"],[1,"left"],[1,"title"],[1,"icon"],[1,"subtitle"],[1,"features"],[1,"right"],["role","tablist","aria-label","Authentication mode",1,"tabs"],["type","button","role","tab","id","login-tab",3,"click"],["type","button","role","tab","id","register-tab",3,"click"],[3,"ngSubmit"],[4,"ngIf"],["for","email",1,"sr-only"],["type","email","id","email","name","email","placeholder","Email","required","","email","","maxlength","254",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],["type","password","name","password","placeholder","Password","required","","minlength","6","maxlength","64",3,"ngModelChange","ngModel"],["type","submit",1,"main-btn",3,"disabled"],[1,"divider"],[1,"divider-line"],[1,"divider-text"],["type","button",1,"google-btn",3,"click"],["viewBox","0 0 24 24","width","20","height","20",1,"google-icon"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],["for","fullName",1,"sr-only"],["type","text","id","fullName","name","fullName","placeholder","Full Name","required","","minlength","2","maxlength","100","aria-required","true",3,"ngModelChange","ngModel"],["class","error","id","fullName-error","role","alert","aria-live","polite",4,"ngIf"],["id","fullName-error","role","alert","aria-live","polite",1,"error"],[1,"error"]],template:function(n,i){if(1&n){const s=P.RV6();P.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7),P.EFF(4,"\u{1f393}"),P.k0s(),P.j41(5,"h1"),P.EFF(6,"Career RoadMap"),P.k0s()(),P.j41(7,"p",8),P.EFF(8," AI-powered personalized career roadmaps for CSE students. Chart your path from skills to success. "),P.k0s(),P.j41(9,"ul",9)(10,"li"),P.EFF(11,"\u2728 AI-Generated Roadmaps"),P.k0s(),P.j41(12,"li"),P.EFF(13,"\u{1f31f} Personalized Learning"),P.k0s(),P.j41(14,"li"),P.EFF(15,"\u2b50 Progress Tracking"),P.k0s()()(),P.j41(16,"div",10)(17,"h2"),P.EFF(18,"Get Started"),P.k0s(),P.j41(19,"p"),P.EFF(20,"Sign in or create an account to begin your journey"),P.k0s(),P.j41(21,"div",11)(22,"button",12),P.bIt("click",function(){return Fe.eBV(s),Fe.Njj(i.toggleMode("login"))}),P.EFF(23,"Login"),P.k0s(),P.j41(24,"button",13),P.bIt("click",function(){return Fe.eBV(s),Fe.Njj(i.toggleMode("register"))}),P.EFF(25,"Register"),P.k0s()(),P.j41(26,"form",14,0),P.bIt("ngSubmit",function(){Fe.eBV(s);const c=P.sdS(27);return Fe.Njj(i.onSubmit(c))}),P.DNE(28,dS,6,4,"ng-container",15),P.j41(29,"label",16),P.EFF(30,"Email"),P.k0s(),P.j41(31,"input",17,1),P.mxI("ngModelChange",function(c){return Fe.eBV(s),P.DH7(i.email,c)||(i.email=c),Fe.Njj(c)}),P.k0s(),P.DNE(33,mS,3,2,"div",18),P.j41(34,"input",19,2),P.mxI("ngModelChange",function(c){return Fe.eBV(s),P.DH7(i.password,c)||(i.password=c),Fe.Njj(c)}),P.k0s(),P.DNE(36,yS,3,2,"div",18),P.j41(37,"button",20),P.EFF(38),P.k0s()(),P.j41(39,"div",21),P.nrm(40,"span",22),P.j41(41,"span",23),P.EFF(42,"OR"),P.k0s(),P.nrm(43,"span",22),P.k0s(),P.j41(44,"button",24),P.bIt("click",function(){return Fe.eBV(s),Fe.Njj(i.loginWithGoogle())}),Fe.qSk(),P.j41(45,"svg",25),P.nrm(46,"path",26)(47,"path",27)(48,"path",28)(49,"path",29),P.k0s(),Fe.joV(),P.j41(50,"span"),P.EFF(51,"Login with Google"),P.k0s()()()()}if(2&n){const s=P.sdS(27),o=P.sdS(32),c=P.sdS(35);P.R7$(22),P.AVh("active",i.isLogin),P.BMQ("aria-selected",i.isLogin)("aria-controls","login-panel"),P.R7$(2),P.AVh("active",!i.isLogin),P.BMQ("aria-selected",!i.isLogin)("aria-controls","register-panel"),P.R7$(2),P.BMQ("aria-label",i.isLogin?"Login form":"Registration form"),P.R7$(2),P.Y8G("ngIf",!i.isLogin),P.R7$(3),P.R50("ngModel",i.email),P.R7$(2),P.Y8G("ngIf",o.invalid&&(o.dirty||o.touched)),P.R7$(),P.R50("ngModel",i.password),P.R7$(2),P.Y8G("ngIf",c.invalid&&(c.dirty||c.touched)),P.R7$(),P.Y8G("disabled",s.invalid),P.R7$(),P.SpI(" ",i.isLogin?"Login":"Create Account"," ")}},dependencies:[xT.bT,ut.YN,ut.qT,ut.me,ut.BC,ut.cb,ut.YS,ut.xh,ut.tU,ut.Dg,ut.vS,ut.cV],styles:[".sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}button[_ngcontent-%COMP%]:focus-visible, input[_ngcontent-%COMP%]:focus-visible, select[_ngcontent-%COMP%]:focus-visible{outline:2px solid #2E6BFF;outline-offset:2px;border-radius:4px}button[_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%]{min-height:44px;min-width:44px}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;width:100%;margin:0;padding:0;overflow-x:hidden}app-root[_ngcontent-%COMP%]{display:block;height:100vh;width:100vw}[_nghost-%COMP%]{display:block;width:100vw;height:100vh;margin:0;padding:0;position:fixed;top:0;left:0}.container[_ngcontent-%COMP%]{display:flex;height:100vh;width:100vw;padding:56px 72px;margin:0;background:linear-gradient(135deg,#071b2e,#0e2a47);color:#fff;font-family:Poppins,sans-serif;box-sizing:border-box}.left[_ngcontent-%COMP%]{width:60%;padding-left:60px;display:flex;flex-direction:column;justify-content:center}.title[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:36px;margin-bottom:18px;font-weight:800;line-height:1.02}.icon[_ngcontent-%COMP%]{width:56px;height:56px;display:inline-flex;align-items:center;justify-content:center;background:#ffffff14;border-radius:12px;font-size:20px;margin-right:16px}.subtitle[_ngcontent-%COMP%]{font-size:16px;margin-bottom:28px;max-width:640px;line-height:1.6;color:#a9b7c9}.features[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.features[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 0;font-size:16px}.right[_ngcontent-%COMP%]{width:38%;max-width:520px;background:#0f2138;padding:36px 40px;border-radius:16px;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);display:flex;flex-direction:column;justify-content:center;margin-left:auto;box-shadow:0 12px 40px #0006;border:1px solid #162E4A;transition:all .3s cubic-bezier(.4,0,.2,1);will-change:transform,box-shadow}@media(hover:hover)and (pointer:fine){.right[_ngcontent-%COMP%]:hover{transform:translateY(-10px);box-shadow:0 20px 50px #2e6bff4d;border:3px solid rgba(46,107,255,.4)}}@media(max-width:900px){.right[_ngcontent-%COMP%]{transform:none!important;box-shadow:0 12px 30px #020c2b38}.right[_ngcontent-%COMP%]:hover{transform:none;box-shadow:0 12px 30px #020c2b38}}.right[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:30px;margin-bottom:5px;font-weight:600}.right[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:20px;color:#a9b7c9}.tabs[_ngcontent-%COMP%]{display:flex;margin:20px 0;gap:0;background:#ffffff1a;border-radius:8px;padding:4px}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:12px 0;background:transparent;border:none;font-size:18px;color:#fff;cursor:pointer;border-radius:6px;transition:all .3s cubic-bezier(.4,0,.2,1)}@media(hover:hover)and (pointer:fine){.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.active){background:#2e6bff1a;border:2px solid rgba(46,107,255,.3)}}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#2e6bff;color:#fff;font-weight:600}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:18px}input[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:1px solid #2A4B7C;border-radius:8px;margin-bottom:14px;font-size:15px;outline:none;background:#162b45;color:#dce6f2;box-sizing:border-box}input[_ngcontent-%COMP%]::placeholder{color:#a9b7c9}.main-btn[_ngcontent-%COMP%]{width:100%;padding:14px 28px;background:#2e6bff;color:#fff;border:none;border-radius:10px;font-size:16px;cursor:pointer;font-weight:600;margin-top:8px;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center;gap:10px;font-family:Poppins,sans-serif;box-shadow:0 4px 12px #2e6bff59;white-space:nowrap}.main-btn[_ngcontent-%COMP%]:hover{background:#2558d8;box-shadow:0 6px 18px #2e6bff73;transform:translateY(-2px)}.main-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #2e6bff4d}.main-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.main-btn[_ngcontent-%COMP%]:disabled:hover{transform:none;box-shadow:0 4px 12px #2e6bff59}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0;width:100%}.divider-line[_ngcontent-%COMP%]{flex:1;height:1px;background:#ffffff4d}.divider-text[_ngcontent-%COMP%]{padding:0 12px;color:#ffffffb3;font-size:14px;font-weight:500}.google-btn[_ngcontent-%COMP%]{width:100%;padding:12px 14px;background:#fff;color:#1f2937;border:1px solid rgba(255,255,255,.2);border-radius:10px;font-size:16px;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:10px;transition:transform .18s ease,box-shadow .18s ease,background .18s ease;box-shadow:0 2px 8px #0000001a}.google-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026;background:#f9fafb}.google-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #0000001a}.google-icon[_ngcontent-%COMP%]{flex-shrink:0}"]})}return r})()}}]);