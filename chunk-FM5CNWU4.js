import{I as a,h as o}from"./chunk-3A7RIER7.js";var r=class e{popstateHandler=null;visibilityHandler=null;blurHandler=null;pageHideHandler=null;violated=!1;active=!1;violationHandler=null;startProtection(i){this.stopProtection(),this.violated=!1,this.active=!0,this.violationHandler=i;try{console.log("[QuizProtection] startProtection: pushing history states and attaching listeners")}catch{}try{history.pushState(null,"",location.href)}catch{}try{history.pushState(null,"",location.href)}catch{}this.popstateHandler=t=>{try{console.warn("[QuizProtection] popstate detected (back/forward attempted)")}catch{}try{history.pushState(null,"",location.href)}catch{}this.triggerViolation("BACK_BUTTON")},window.addEventListener("popstate",this.popstateHandler),this.visibilityHandler=()=>{document.visibilityState==="hidden"&&this.triggerViolation("TAB_SWITCH")},document.addEventListener("visibilitychange",this.visibilityHandler),this.blurHandler=()=>{this.triggerViolation("TAB_SWITCH")},window.addEventListener("blur",this.blurHandler),this.pageHideHandler=()=>{this.triggerViolation("LEAVE_SCREEN")},window.addEventListener("pagehide",this.pageHideHandler)}triggerViolation(i){if(!this.violated){this.violated=!0;try{console.warn("[QuizProtection] violation detected, invoking handler with reason:",i)}catch{}try{this.violationHandler&&this.violationHandler(i)}catch(t){try{console.error("[QuizProtection] handler threw",t)}catch{}}}}forceViolation(i="LEAVE_SCREEN"){try{console.warn("[QuizProtection] forceViolation called")}catch{}try{this.triggerViolation(i)}catch{}}isActive(){return this.active}stopProtection(){this.violated=!1,this.active=!1,this.violationHandler=null,this.popstateHandler&&(window.removeEventListener("popstate",this.popstateHandler),this.popstateHandler=null),this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null),this.blurHandler&&(window.removeEventListener("blur",this.blurHandler),this.blurHandler=null),this.pageHideHandler&&(window.removeEventListener("pagehide",this.pageHideHandler),this.pageHideHandler=null);try{history.replaceState(null,"",location.href)}catch{}}static \u0275fac=function(t){return new(t||e)};static \u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})};var l=class e{loadingSubject=new o(!1);loadingMessageSubject=new o("Loading...");loadingCount=0;isLoading$=this.loadingSubject.asObservable();loadingMessage$=this.loadingMessageSubject.asObservable();show(i="Loading..."){this.loadingCount++,this.loadingMessageSubject.next(i),this.loadingSubject.next(!0)}hide(){this.loadingCount=Math.max(0,this.loadingCount-1),this.loadingCount===0&&this.loadingSubject.next(!1)}forceHide(){this.loadingCount=0,this.loadingSubject.next(!1)}isLoading(){return this.loadingSubject.value}static \u0275fac=function(t){return new(t||e)};static \u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})};export{r as a,l as b};
